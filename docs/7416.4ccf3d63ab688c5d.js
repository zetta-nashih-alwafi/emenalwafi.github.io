"use strict";(self.webpackChunkGene=self.webpackChunkGene||[]).push([[7416,4318],{75223:(V,I,s)=>{s.d(I,{r:()=>w});var e=s(94650),E=s(89383),v=s(36895),T=s(97392);function a(r,u){1&r&&(e.\u0275\u0275elementStart(0,"span",12),e.\u0275\u0275text(1," , "),e.\u0275\u0275elementEnd())}function o(r,u){if(1&r&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275template(3,a,2,0,"span",11),e.\u0275\u0275elementContainerEnd()),2&r){const n=u.$implicit,f=u.last;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,2,n)," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!f)}}function _(r,u){if(1&r){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-icon",13),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);const m=e.\u0275\u0275nextContext(3),d=m.$implicit,h=m.index,l=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(l.removeFilter(d,h))}),e.\u0275\u0275text(1,"close"),e.\u0275\u0275elementEnd()}}function i(r,u){if(1&r&&(e.\u0275\u0275elementStart(0,"span",9),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275template(3,o,4,4,"ng-container",7),e.\u0275\u0275template(4,_,2,0,"mat-icon",10),e.\u0275\u0275elementEnd()),2&r){const n=e.\u0275\u0275nextContext(2).$implicit,f=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(2,3,null==n?null:n.column)," : "),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",null==n?null:n.key),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!(f.isReadmission&&"scholar_season"===(null==n?null:n.name)))}}function t(r,u){if(1&r){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-icon",13),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);const m=e.\u0275\u0275nextContext(3),d=m.$implicit,h=m.index,l=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(l.removeFilter(d,h))}),e.\u0275\u0275text(1,"close"),e.\u0275\u0275elementEnd()}}function c(r,u){if(1&r&&(e.\u0275\u0275elementStart(0,"span",9),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275template(4,t,2,0,"mat-icon",10),e.\u0275\u0275elementEnd()),2&r){const n=e.\u0275\u0275nextContext(2).$implicit,f=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate2("",e.\u0275\u0275pipeBind1(2,3,null==n?null:n.column)," : ",e.\u0275\u0275pipeBind1(3,5,null==n?null:n.key)," "),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",!(f.isReadmission&&"scholar_season"===(null==n?null:n.name)))}}function x(r,u){if(1&r&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,i,5,5,"span",8),e.\u0275\u0275template(2,c,5,7,"span",8),e.\u0275\u0275elementContainerEnd()),2&r){const n=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==n?null:n.isMultiple),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!(null!=n&&n.isMultiple))}}function C(r,u){if(1&r&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,x,3,2,"ng-container",1),e.\u0275\u0275elementContainerEnd()),2&r){const n=u.$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","super_filter"===(null==n?null:n.type))}}function b(r,u){if(1&r&&(e.\u0275\u0275elementStart(0,"div",4)(1,"span",5),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"span"),e.\u0275\u0275text(5,":"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"span",6),e.\u0275\u0275template(7,C,2,1,"ng-container",7),e.\u0275\u0275elementEnd()()),2&r){const n=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngClass","en"===n.translate.currentLang?"filter-type":"filter-type-fr"),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(3,3,"Super Filter")," "),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngForOf",n.filterBreadcrumbData)}}function N(r,u){1&r&&(e.\u0275\u0275elementStart(0,"span",12),e.\u0275\u0275text(1," , "),e.\u0275\u0275elementEnd())}function R(r,u){if(1&r&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275template(3,N,2,0,"span",11),e.\u0275\u0275elementContainerEnd()),2&r){const n=u.$implicit,f=u.last,m=e.\u0275\u0275nextContext(3).$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",null!=m&&m.noTranslate?n:e.\u0275\u0275pipeBind1(2,2,n)," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!f)}}function A(r,u){if(1&r){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"span",9),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275template(4,R,4,4,"ng-container",7),e.\u0275\u0275elementStart(5,"mat-icon",13),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);const m=e.\u0275\u0275nextContext(2),d=m.$implicit,h=m.index,l=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(l.removeFilter(d,h))}),e.\u0275\u0275text(6,"close"),e.\u0275\u0275elementEnd()()}if(2&r){const n=e.\u0275\u0275nextContext(2).$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("",null!=n&&n.stepColumnName?e.\u0275\u0275pipeBind1(2,2,null==n?null:n.stepColumnName)+" "+(null==n?null:n.column):e.\u0275\u0275pipeBind1(3,4,null==n?null:n.column)," : "),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngForOf",null==n?null:n.key)}}function M(r,u){if(1&r){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"span",9),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementStart(5,"mat-icon",13),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);const m=e.\u0275\u0275nextContext(2),d=m.$implicit,h=m.index,l=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(l.removeFilter(d,h))}),e.\u0275\u0275text(6,"close"),e.\u0275\u0275elementEnd()()}if(2&r){const n=e.\u0275\u0275nextContext(2).$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate2("",null!=n&&n.stepColumnName?e.\u0275\u0275pipeBind1(2,2,null==n?null:n.stepColumnName)+" "+(null==n?null:n.column):e.\u0275\u0275pipeBind1(3,4,null==n?null:n.column)," : ",!0===(null==n?null:n.noTranslate)?null==n?null:n.key:e.\u0275\u0275pipeBind1(4,6,null==n?null:n.key)," ")}}function S(r,u){if(1&r&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,A,7,6,"span",8),e.\u0275\u0275template(2,M,7,8,"span",8),e.\u0275\u0275elementContainerEnd()),2&r){const n=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==n?null:n.isMultiple),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!(null!=n&&n.isMultiple))}}function L(r,u){if(1&r&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,S,3,2,"ng-container",1),e.\u0275\u0275elementContainerEnd()),2&r){const n=u.$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","table_filter"===(null==n?null:n.type))}}function W(r,u){if(1&r&&(e.\u0275\u0275elementStart(0,"div",14)(1,"span",5),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"span"),e.\u0275\u0275text(5,":"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"span",6),e.\u0275\u0275template(7,L,2,1,"ng-container",7),e.\u0275\u0275elementEnd()()),2&r){const n=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngClass","en"===n.translate.currentLang?"filter-type":"filter-type-fr"),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(3,3,"Table Filter")," "),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngForOf",n.filterBreadcrumbData)}}function U(r,u){if(1&r){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"span",9),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementStart(4,"mat-icon",13),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);const m=e.\u0275\u0275nextContext(),d=m.$implicit,h=m.index,l=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(l.removeFilter(d,h))}),e.\u0275\u0275text(5,"close"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementContainerEnd()}if(2&r){const n=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(3,1,null==n?null:n.key)," ")}}function k(r,u){if(1&r&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,U,6,3,"ng-container",1),e.\u0275\u0275elementContainerEnd()),2&r){const n=u.$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","action_filter"===(null==n?null:n.type))}}function K(r,u){if(1&r&&(e.\u0275\u0275elementStart(0,"div",14)(1,"span",5),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"span"),e.\u0275\u0275text(5,":"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"span",6),e.\u0275\u0275template(7,k,2,1,"ng-container",7),e.\u0275\u0275elementEnd()()),2&r){const n=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngClass","en"===n.translate.currentLang?"filter-type":"filter-type-fr"),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(3,3,"Action Filter")," "),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngForOf",n.filterBreadcrumbData)}}function P(r,u){if(1&r&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,b,8,5,"div",2),e.\u0275\u0275template(2,W,8,5,"div",3),e.\u0275\u0275template(3,K,8,5,"div",3),e.\u0275\u0275elementContainerEnd()),2&r){const n=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.filterDataExist("super_filter")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.filterDataExist("table_filter")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.filterDataExist("action_filter"))}}let w=(()=>{class r{constructor(n){this.translate=n,this.removeFilterTrigger=new e.EventEmitter}ngOnInit(){}filterDataExist(n){return!!this.filterBreadcrumbData.find(m=>m?.type===n)}removeFilter(n,f){this.filterBreadcrumbData.splice(f,1),this.removeFilterTrigger.emit(n)}}return r.\u0275fac=function(n){return new(n||r)(e.\u0275\u0275directiveInject(E.sK))},r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["ms-filter-breadcrumb"]],inputs:{filterBreadcrumbData:"filterBreadcrumbData",isReadmission:"isReadmission"},outputs:{removeFilterTrigger:"removeFilterTrigger"},decls:2,vars:1,consts:[[1,"filter-breadcrumb"],[4,"ngIf"],["class","filter-breadcrumb-container mt-10",4,"ngIf"],["class","filter-breadcrumb-container",4,"ngIf"],[1,"filter-breadcrumb-container","mt-10"],[3,"ngClass"],[1,"breadcrumb-value"],[4,"ngFor","ngForOf"],["class","breadcrumb-filter",4,"ngIf"],[1,"breadcrumb-filter"],["class","icon-remove",3,"click",4,"ngIf"],["class","comma",4,"ngIf"],[1,"comma"],[1,"icon-remove",3,"click"],[1,"filter-breadcrumb-container"]],template:function(n,f){1&n&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275template(1,P,4,3,"ng-container",1),e.\u0275\u0275elementEnd()),2&n&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==f.filterBreadcrumbData?null:f.filterBreadcrumbData.length))},dependencies:[v.mk,v.sg,v.O5,T.Hw,E.X$],styles:[".filter-breadcrumb[_ngcontent-%COMP%]{padding:1rem}.filter-breadcrumb-container[_ngcontent-%COMP%]{display:flex;align-items:baseline}.filter-breadcrumb-container[_ngcontent-%COMP%] ~ .filter-breadcrumb-container[_ngcontent-%COMP%]{margin-top:1rem}.breadcrumb-value[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;padding:0 1rem;gap:4px}.filter-type[_ngcontent-%COMP%]{width:100px}.filter-type-fr[_ngcontent-%COMP%]{width:150px}.breadcrumb-filter[_ngcontent-%COMP%]{background-color:#ffd740;color:#000;padding:.25rem .5rem;border-radius:.375rem;font-size:.75rem;display:flex;flex-wrap:wrap;align-items:center}.comma[_ngcontent-%COMP%]{margin-right:4px}.icon-remove[_ngcontent-%COMP%]{vertical-align:middle;margin-left:.25rem;font-size:inherit;cursor:pointer}"]}),r})()},22437:(V,I,s)=>{s.d(I,{q:()=>E});var e=s(94650);let E=(()=>{class v{constructor(){this.filterSingle=(a,o,_,i,t="")=>null==o?"":t+a?.find(c=>c[_]===o)?.[i],this.filterSingleBoolean=(a,o,_,i,t="")=>null==o?"":t+a?.find(c=>"boolean"==typeof c[_]?JSON.stringify(c[_])===o:"string"==typeof c[_]?c[_]===o:void 0)?.[i],this.filterMultiple=(a,o,_,i,t="")=>o?.length?null===_&&null===i?a.filter(c=>o?.includes(c)).map(c=>t+c):a.filter(c=>o?.includes(c[_]))?.map(c=>t+c[i]):[],this.isValueObject=a=>"object"==typeof a&&!Array.isArray(a)&&null!==a,this.getNestedObjectValue=(a,o)=>{for(const _ in a){if(_===o)return a[o];if(this.isValueObject(a[o]))return this.getNestedObjectValue(a[_],o)}},this.getKey=a=>{if(null===a?.filterValue)return null;const o=null===a?.name?a?.filterValue:"boolean"==typeof a?.filterValue?.[a?.name]?String(a?.filterValue?.[a.name]):a.filterValue?.[a.name],_=a.isMultiple,i=a.isSelectionInput,t=a?.fixedValues,c=a?.translationPrefix??"";if(null==o)return null;if(!i&&this.isValueObject(o)&&a?.nestedKey)return c+this.getNestedObjectValue(o,a.nestedKey);if(!i)return c+o;let x;if(t)if(Array.isArray(o))x=t?.filter(b=>o?.includes(b));else if("string"==typeof o||"boolean"==typeof o)return x=t?.find(b=>o===b),x;const C=_?this.filterMultiple(a.filterList,o,a.savedValue,a.displayKey,a.translationPrefix):"boolean"==typeof a?.filterValue?.[a?.name]||"false"===a?.filterValue?.[a?.name]||"true"===a?.filterValue?.[a?.name]?this.filterSingleBoolean(a.filterList,o,a.savedValue,a.displayKey,a.translationPrefix):this.filterSingle(a.filterList,o,a.savedValue,a.displayKey,a.translationPrefix);return _&&x?C.concat(...t):C}}filterBreadcrumb(a,o){const{type:_,column:i}=a,t=o.findIndex(c=>c?.type===_&&c?.column===i);-1!==t?(o[t]=a,!(Array.isArray(o[t]?.value)?o[t]?.value?.length:o[t]?.value)&&!(Array.isArray(o[t]?.key)?o[t]?.key?.length:o[t]?.key)&&o.splice(t,1)):(-1===t&&Array.isArray(a?.value)?a?.value?.length:a?.value)&&o.push(a)}removeFilterBreadcrumb(a,o,_,i,t=!1){"super_filter"===a.type&&o?o[a.name]=null:"table_filter"===a.type&&_?_[a.name]=null:"action_filter"===a.type&&i&&(i[a.name]=null),a?.filterRef?.patchValue(a?.resetValue??null,{emitEvent:t})}filterBreadcrumbFormat(a,o){const _=[...o];for(const i of a){const t=null===i.name?i?.filterValue:"boolean"==typeof i?.filterValue?.[i.name]?String(i?.filterValue?.[i.name]):i?.filterValue?.[i.name],c={type:i.type,name:i.name,column:i.column,filterList:i?.filterList,value:t||null,isMultiple:i.isMultiple,filterRef:i.filterRef,resetValue:i.resetValue,noTranslate:i?.noTranslate,stepColumnName:i?.stepColumnName,key:this.getKey(i)};this.filterBreadcrumb(c,_)}return _}}return v.\u0275fac=function(a){return new(a||v)},v.\u0275prov=e.\u0275\u0275defineInjectable({token:v,factory:v.\u0275fac,providedIn:"root"}),v})()},34318:(V,I,s)=>{function v(i){return i&&i.value&&"string"==typeof i.value&&!i.value.replace(/\s/g,"").length&&i.setValue(""),null}function _(i){const t=i&&i.value&&"string"==typeof i.value&&!i.value.replace(/\s/g,"").length;return t&&i.setValue(""),t?{whitespace:!0}:null}s.d(I,{I8:()=>v,Zx:()=>_})},26698:(V,I,s)=>{s.d(I,{V:()=>m});var e=s(35226),E=s.n(e),v=s(65938),T=s(68745),a=s(24006),o=s(92340),_=s(15439),t=s(94650),c=s(89383),x=s(84075),C=s(80484),b=s(36746),N=s(69725),R=s(80529),A=s(52688),M=s(36895),S=s(73555),L=s(4859),W=s(97392),U=s(59549),k=s(51572),K=s(10266),P=s(88796);const w=["fileUploadDoc"];function r(d,h){1&d&&(t.\u0275\u0275elementStart(0,"ng-option",14),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275elementEnd()),2&d&&(t.\u0275\u0275property("value","Invoice"),t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(2,2,"INVOICE")," "))}function u(d,h){if(1&d&&(t.\u0275\u0275elementStart(0,"ng-option",14),t.\u0275\u0275text(1),t.\u0275\u0275elementEnd()),2&d){const l=h.$implicit;t.\u0275\u0275property("value",null==l?null:l.document_builder_name),t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1(" ",null==l?null:l.document_builder_name," ")}}function n(d,h){1&d&&(t.\u0275\u0275elementStart(0,"mat-error"),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275elementEnd()),2&d&&(t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(2,1,"This field is required")))}function f(d,h){1&d&&(t.\u0275\u0275elementStart(0,"div",15),t.\u0275\u0275element(1,"mat-progress-spinner",16),t.\u0275\u0275elementEnd())}let m=(()=>{class d{constructor(l,g,D,p,O,B,$,F,y,j){this.dialogRef=l,this.parentData=g,this.fb=D,this.translate=p,this.utilService=O,this.fileUploadService=B,this.acadKitService=$,this.studentsService=F,this.httpClient=y,this.authService=j,this.isWaitingForResponse=!1,this.isInvoiceDisplay=!0,this.subs=new T.Y,this.fileTypesControl=new a.FormControl(""),this.fileTypes=[],this.selectedFileType="",this.selectedMaxSize=0,this.listDataDropdown=[]}ngOnInit(){console.log(this.parentData),this.initUploadDocForm(),this.getDataDropdown()}getDataDropdown(){this.listDataDropdown=[],this.isWaitingForResponse=!0,this.subs.sink=this.studentsService.getAllDocumentsPublished().subscribe(l=>{this.isWaitingForResponse=!1,this.listDataDropdown=l&&l.length?l:[]},l=>{this.authService.postErrorLog(l),this.isWaitingForResponse=!1,console.log("err",l),this.authService.postErrorLog(l),l&&l.message&&l.message.includes("Network error: Http failure response for")?E().fire({type:"warning",title:this.translate.instant("BAD_CONNECTION.Title"),html:this.translate.instant("BAD_CONNECTION.Text"),confirmButtonText:this.translate.instant("BAD_CONNECTION.Button"),allowOutsideClick:!1,allowEnterKey:!1,allowEscapeKey:!1}):E().fire({type:"info",title:this.translate.instant("SORRY"),text:l&&l.message?this.translate.instant(l.message.replaceAll("GraphQL error: ","")):l,confirmButtonText:this.translate.instant("DISCONNECT_SCHOOL.BUTTON3")})})}initUploadDocForm(){this.uploadDocForm=this.fb.group({document_id:["",a.Validators.required],document_builder_name:["",a.Validators.required],s3_file_name:[""]})}getDataDocument(l){const g=this.listDataDropdown?.findIndex(p=>p?.document_builder_name===l),D=this.listDataDropdown[g]?._id;D&&(this.uploadDocForm.get("document_id").setValue(D),this.parentData&&!this.parentData.is_multiple&&(this.isWaitingForResponse=!0,this.subs.sink=this.studentsService.GenerateDocumentBuilderPDFForStudent(this.parentData._id,D).subscribe(p=>{this.isWaitingForResponse=!1,p?(this.uploadDocForm.get("s3_file_name").setValue(p),this.selectedFile=p):(this.uploadDocForm.get("s3_file_name").setValue(null),this.selectedFile=null)},p=>{this.authService.postErrorLog(p),this.isWaitingForResponse=!1,console.log("err",p),this.authService.postErrorLog(p),p&&p.message&&p.message.includes("Network error: Http failure response for")?E().fire({type:"warning",title:this.translate.instant("BAD_CONNECTION.Title"),html:this.translate.instant("BAD_CONNECTION.Text"),confirmButtonText:this.translate.instant("BAD_CONNECTION.Button"),allowOutsideClick:!1,allowEnterKey:!1,allowEscapeKey:!1}):E().fire({type:"info",title:this.translate.instant("SORRY"),text:p&&p.message?this.translate.instant(p.message.replaceAll("GraphQL error: ","")):p,confirmButtonText:this.translate.instant("DISCONNECT_SCHOOL.BUTTON3")})})))}closeDialog(){this.dialogRef.close()}checkFormValidity(){return!!this.uploadDocForm.invalid&&(E().fire({type:"warning",title:this.translate.instant("FormSave_S1.TITLE"),html:this.translate.instant("FormSave_S1.TEXT"),confirmButtonText:this.translate.instant("FormSave_S1.BUTTON"),onOpen:l=>{l.setAttribute("data-cy","swal-formsave-s1")}}),this.uploadDocForm.markAllAsTouched(),!0)}submit(){if(this.checkFormValidity())return;let l;if(console.log("Data Payload",this.uploadDocForm.value),this.uploadDocForm.get("document_builder_name").value===this.translate.instant("INVOICE"))l=this.uploadDocForm.value,l.document_builder_name="Invoice",l.invoice_name=this.documentInvoiceName;else{const g=this.uploadDocForm.get("s3_file_name").value;l={path:`${o.N.apiUrl}/fileuploads/${g}`.replace("/graphql",""),file_name:this.uploadDocForm.get("document_builder_name").value},this.parentData&&this.parentData.is_multiple&&(l=this.uploadDocForm.value)}this.dialogRef.close(l)}selectDocument(l){l&&"Invoice"===l?this.getInvoiceData():l&&"Invoice"!==l&&this.getDataDocument(l)}getInvoiceData(){this.isWaitingForResponse=!0;const l=_(new Date,"DD/MM/YYYY").format("DDMMYYYY"),g=_(new Date).format("HH:mm");if(this.parentData.candidate_data&&this.parentData.candidate_data.length){const D=o.N.apiUrl.replace("/graphql","");this.httpClient.get(`${D}/downloadStudentInvoice/${this.parentData?.candidate_data[0]?.candidate?.candidate_id?._id||this.parentData?.candidate_data[0]?.candidate?._id||this.parentData?.candidate_data[0]?._id||null}/${this.translate.currentLang}/${this.parentData?.candidate_data[0]?.intake_channel?.scholar_season_id?._id||this.parentData?.candidate_data[0]?.candidate?.intake_channel?.scholar_season_id?._id||null}/${this.parentData?.candidate_data[0]?.intake_channel?._id||this.parentData?.candidate_data[0]?.candidate?.intake_channel?._id||null}?date=${l}&time=${g}`,{responseType:"text"}).subscribe(F=>{if(console.log("invoice",F),F){this.isWaitingForResponse=!1;const y=this.translate.instant("INVOICE");this.uploadDocForm.get("document_id").setValue(y),this.uploadDocForm.get("document_builder_name").setValue(this.translate.instant("INVOICE")),this.documentInvoiceName=F}else{const y=this.translate.instant("INVOICE");this.uploadDocForm.get("document_id").setValue(y),this.uploadDocForm.get("document_builder_name").setValue(this.translate.instant("INVOICE")),this.documentInvoiceName=y,this.isWaitingForResponse=!1}},F=>{const y=this.translate.instant("INVOICE");this.uploadDocForm.get("document_id").setValue(y),this.uploadDocForm.get("document_builder_name").setValue(this.translate.instant("INVOICE")),this.documentInvoiceName=y,this.isWaitingForResponse=!1})}else if(this.parentData&&this.parentData._id){const p=`${o.N.apiUrl.replace("/graphql","")}/downloadStudentInvoice/${this.parentData._id}/${this.translate.currentLang}`;this.httpClient.get(p,{responseType:"text"}).subscribe(O=>{if(O)this.isWaitingForResponse=!1,this.uploadDocForm.get("document_id").setValue(O),this.uploadDocForm.get("document_builder_name").setValue(this.translate.instant("INVOICE")),this.documentInvoiceName=O;else{const B=this.translate.instant("INVOICE");this.uploadDocForm.get("document_id").setValue(B),this.uploadDocForm.get("document_builder_name").setValue(this.translate.instant("INVOICE")),this.documentInvoiceName=B,this.isWaitingForResponse=!1}},O=>{const B=this.translate.instant("INVOICE");this.uploadDocForm.get("document_id").setValue(B),this.uploadDocForm.get("document_builder_name").setValue(this.translate.instant("INVOICE")),this.documentInvoiceName=B,this.isWaitingForResponse=!1})}else this.isWaitingForResponse=!1}ngOnDestroy(){this.subs.unsubscribe()}}return d.\u0275fac=function(l){return new(l||d)(t.\u0275\u0275directiveInject(v.so),t.\u0275\u0275directiveInject(v.WI),t.\u0275\u0275directiveInject(a.FormBuilder),t.\u0275\u0275directiveInject(c.sK),t.\u0275\u0275directiveInject(x.t),t.\u0275\u0275directiveInject(C.J),t.\u0275\u0275directiveInject(b.P),t.\u0275\u0275directiveInject(N.P),t.\u0275\u0275directiveInject(R.eN),t.\u0275\u0275directiveInject(A.e))},d.\u0275cmp=t.\u0275\u0275defineComponent({type:d,selectors:[["ms-add-document-builder-dialog"]],viewQuery:function(l,g){if(1&l&&t.\u0275\u0275viewQuery(w,5),2&l){let D;t.\u0275\u0275queryRefresh(D=t.\u0275\u0275loadQuery())&&(g.fileUploaderDoc=D.first)}},decls:27,vars:28,consts:[["mat-dialog-title","","cdkDrag","","cdkDragRootElement",".cdk-overlay-pane","cdkDragHandle","",2,"border-bottom","1px solid #000000"],["data-c","button-close-dialog",1,"icon-style",2,"vertical-align","middle","float","right",3,"matTooltip","click"],["mat-dialog-content","",1,"mat-dialog-content","dialog-body",3,"formGroup"],[1,"p-grid"],[1,"p-col-5","pt-16"],[1,"p-col-7"],["formControlName","document_builder_name",1,"custom-ngselect-content",3,"clearable","appendTo","placeholder","notFoundText","change"],[3,"value",4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["mat-dialog-actions","",1,"justify-content-end"],["mat-button","","mat-raised-button","","color","warn","data-cy","button-cancel",3,"click"],["mat-button","","mat-raised-button","","color","primary","data-cy","button-validate",1,"mr-0",3,"click"],["class","loading-indicator",4,"ngIf"],[3,"value"],[1,"loading-indicator"],["mode","indeterminate","color","accent","data-cy","dialog-spinner"]],template:function(l,g){1&l&&(t.\u0275\u0275elementStart(0,"h1",0),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275elementStart(3,"mat-icon",1),t.\u0275\u0275listener("click",function(){return g.closeDialog()}),t.\u0275\u0275pipe(4,"translate"),t.\u0275\u0275text(5,"close"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(6,"div",2)(7,"div",3)(8,"div",4)(9,"label"),t.\u0275\u0275text(10),t.\u0275\u0275pipe(11,"translate"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(12,"div",5)(13,"ng-select",6),t.\u0275\u0275listener("change",function(p){return g.selectDocument(p)}),t.\u0275\u0275pipe(14,"translate"),t.\u0275\u0275pipe(15,"translate"),t.\u0275\u0275template(16,r,3,4,"ng-option",7),t.\u0275\u0275template(17,u,2,2,"ng-option",8),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(18,n,3,3,"mat-error",9),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementStart(19,"div",10)(20,"button",11),t.\u0275\u0275listener("click",function(){return g.closeDialog()}),t.\u0275\u0275text(21),t.\u0275\u0275pipe(22,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(23,"button",12),t.\u0275\u0275listener("click",function(){return g.submit()}),t.\u0275\u0275text(24),t.\u0275\u0275pipe(25,"translate"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275template(26,f,2,0,"div",13)),2&l&&(t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(2,14,"Add document")," "),t.\u0275\u0275advance(2),t.\u0275\u0275propertyInterpolate("matTooltip",t.\u0275\u0275pipeBind1(4,16,"CLOSE")),t.\u0275\u0275advance(3),t.\u0275\u0275property("formGroup",g.uploadDocForm),t.\u0275\u0275advance(4),t.\u0275\u0275textInterpolate1("",t.\u0275\u0275pipeBind1(11,18,"Please select a document"),": *"),t.\u0275\u0275advance(3),t.\u0275\u0275propertyInterpolate("placeholder",t.\u0275\u0275pipeBind1(14,20,"Please select a document")),t.\u0275\u0275propertyInterpolate("notFoundText",t.\u0275\u0275pipeBind1(15,22,"NOT RECORD FOUND")),t.\u0275\u0275property("clearable",!0)("appendTo","body"),t.\u0275\u0275advance(3),t.\u0275\u0275property("ngIf",(null==g.parentData?null:g.parentData.is_multiple)&&g.isInvoiceDisplay),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngForOf",g.listDataDropdown),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",g.uploadDocForm.get("document_builder_name").errors),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(22,24,"CANCEL")," "),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(25,26,"Validate")," "),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",g.isWaitingForResponse))},dependencies:[M.sg,M.O5,S.Zt,S.Bh,L.lW,v.uh,v.xY,v.H8,W.Hw,U.TO,k.Ou,K.gM,a.NgControlStatus,a.NgControlStatusGroup,a.FormGroupDirective,a.FormControlName,P.w9,P.jq,c.X$],styles:[".pt-16[_ngcontent-%COMP%]{padding-top:16px!important}[_nghost-%COMP%]  .ng-select .ng-select-container{background-color:#fff0;color:#000;border:none;border-radius:0!important;border-bottom:1px solid #8c8c8c!important;min-height:36px;align-items:center}"]}),d})()}}]);