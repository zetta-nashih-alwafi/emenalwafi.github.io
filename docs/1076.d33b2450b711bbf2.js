"use strict";(self.webpackChunkGene=self.webpackChunkGene||[]).push([[1076],{41076:(Q,B,o)=>{o.d(B,{v:()=>v});var t=o(94650),f=o(65938),C=o(9749),p=o(24006),E=o(35226),u=o.n(E),Y=o(68745),n=o(17489),F=o(26698),N=o(92340),A=o(33296),D=o(89383),R=o(52688),w=o(91013),I=o(80484),y=o(69725),k=o(4859),L=o(97392),x=o(59549),U=o(284),W=o(51572),T=o(10266),K=o(24784),P=o(36895),V=o(37204);const j=["languagesInput"],G=["auto"],H=["myInput"];function _(r,m){if(1&r){const a=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"button",19),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(a);const e=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(e.addDoc())}),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275elementEnd()}2&r&&(t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(2,1,"Add document")," "))}function b(r,m){if(1&r){const a=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"mat-icon",20),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(a);const e=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(e.sendMail())}),t.\u0275\u0275pipe(1,"translate"),t.\u0275\u0275text(2,"send"),t.\u0275\u0275elementEnd()}2&r&&t.\u0275\u0275propertyInterpolate("matTooltip",t.\u0275\u0275pipeBind1(1,1,"MailBox.SEND"))}function l(r,m){1&r&&(t.\u0275\u0275elementStart(0,"mat-icon",21),t.\u0275\u0275pipe(1,"translate"),t.\u0275\u0275text(2,"send"),t.\u0275\u0275elementEnd()),2&r&&t.\u0275\u0275propertyInterpolate("matTooltip",t.\u0275\u0275pipeBind1(1,1,"MailBox.SEND"))}function c(r,m){1&r&&(t.\u0275\u0275elementStart(0,"mat-error"),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275elementEnd()),2&r&&(t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(2,1,"This field is required")))}const h=function(r,m){return{pointer:r,pointer:m}};function d(r,m){if(1&r){const a=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",22)(1,"button",23)(2,"mat-icon"),t.\u0275\u0275text(3,"insert_drive_file"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(4,"label",24),t.\u0275\u0275listener("click",function(){const s=t.\u0275\u0275restoreView(a).$implicit,M=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(M.openAttachment(s))}),t.\u0275\u0275text(5),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(6,"button",25),t.\u0275\u0275listener("click",function(){const s=t.\u0275\u0275restoreView(a).$implicit,M=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(M.removeAttachment(s))}),t.\u0275\u0275elementStart(7,"mat-icon",26),t.\u0275\u0275text(8," close "),t.\u0275\u0275elementEnd()()()}if(2&r){const a=m.$implicit;t.\u0275\u0275advance(4),t.\u0275\u0275property("ngClass",t.\u0275\u0275pureFunction2(2,h,null==a?null:a.is_from_builder,"Invoice"===(null==a?null:a.document_id))),t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate(a.file_name)}}function O(r,m){1&r&&(t.\u0275\u0275elementStart(0,"div",27),t.\u0275\u0275element(1,"mat-progress-spinner",28),t.\u0275\u0275elementEnd())}var g=(()=>{return(r=g||(g={})).LABEL="LABEL",r.VALUE="VALUE",r.OBJECT="OBJECT",g;var r})();let v=(()=>{class r{constructor(a,i,e,s,M,z,X,J,Z){this.data=a,this.translate=i,this.userService=e,this.mailboxService=s,this.fileUploadService=M,this.dialogref=z,this.fb=X,this.studentsService=J,this.dialog=Z,this.subs=new Y.Y,this.Editor=C,this.showCC=!1,this.showBCC=!1,this.config={},this.isInvoiceDisplay=!0,this.listIntakeChannel=[{value:"20-21 EFANEW 1",name:"20-21 EFANEW 1"},{value:"20-21 EFANEW 2",name:"20-21 EFANEW 2"},{value:"20-21 EFANEW 3",name:"20-21 EFANEW 3"},{value:"20-21 EFANEW 4",name:"20-21 EFANEW 4"},{value:"20-21 EFANEW 5",name:"20-21 EFANEW 5"}],this.allowOther=!1,this.returnType=g.LABEL,this.optionSelected=new t.EventEmitter,this.attachmnetsPaths=[],this.isGroupEmail=!1,this.isWaitingForResponse=!1,this.recipientList=[],this.listDocumentBuilder=[],this.triggeredFromStudent=!1,this.triggeredFromFinance=!1,this.isForInvoice=!1,this.sendEmailForm=this.fb.group({subject:["",p.Validators.required],message:["",p.Validators.required]})}ngOnInit(){console.log("parent data ",this.data),this.triggeredFromStudent=this.data&&this.data.length&&this.data[0].triggeredFromStudent?this.data[0].triggeredFromStudent:null,this.data&&this.data.length&&this.data[0].triggeredFromFinance&&(this.triggeredFromFinance=this.data[0].triggeredFromFinance),this.isPermission=this.userService.getPermission(),this.currentUser=this.userService.getLocalStorageUser(),this.handlePayloadData(),this.getEmailMessage()}handlePayloadData(){this.data&&this.data.length>0&&!this.data.fromCandidate&&this.data.map(i=>{i&&i.candidate&&this.recipientList.push({recipients:[i.candidate.emailDefault?i.candidate.emailDefault:i.candidate.email],rank:"a",is_read:!1,mail_type:"inbox",candidate_id:i?.candidate?._id||i?.candidate?.candidate_id?._id||null}),i&&i.financial_supp&&i.financial_supp.email&&i.financial_supp.email.length>0&&i.financial_supp.email.forEach(e=>{this.recipientList.push({recipients:[e],rank:"a",is_read:!1,mail_type:"inbox",candidate_id:i.candidate?._id||null})})})}removeAttachment(a){const i=this.listDocumentBuilder.indexOf(a?.document_id);if(i>=0&&this.listDocumentBuilder.splice(i,1),a?.is_from_builder){const e=this.attachmnetsPaths.findIndex(s=>s?.document_id===a?.document_id);e>=0&&this.attachmnetsPaths.splice(e,1)}else if("Invoice"===a?.document_id){const e=this.attachmnetsPaths.findIndex(s=>s?.document_id===a?.document_id);e>=0&&this.attachmnetsPaths.splice(e,1)}else{const e=this.attachmnetsPaths.findIndex(s=>s?.file_name===a?.file_name);e>=0&&this.attachmnetsPaths.splice(e,1)}}getEmailMessage(){let a="";this.data&&this.data.length&&(a+=this.translate.instant("Hello"));let i="";i+="<p></p><p></p><p></p><p></p>",i+=("neutral"!==this.currentUser.civility?this.translate.instant(this.currentUser.civility):"")+" "+this.currentUser.first_name+" "+this.currentUser.last_name;const e=this.currentUser.entities.filter(M=>M.type.name===this.isPermission[0]),s=n.uniqBy(e,"school.short_name");i+=this.currentUser?.position?",<br>"+this.currentUser?.position:"",i+=s&&s.length&&s[0].school&&s[0].school.short_name?",<br>"+s[0].school.short_name:"",this.sendEmailForm.get("message").setValue(a+i)}validateEmail(a){return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(a)}onReady(a){a.ui.getEditableElement().parentElement.insertBefore(a.ui.view.toolbar.element,a.ui.getEditableElement())}closeDialog(){u().fire({title:this.translate.instant("MailBox.composeMail.DRAFT.TITLE"),html:this.translate.instant("MailBox.composeMail.DRAFT.TEXT"),type:"warning",showCancelButton:!0,allowOutsideClick:!1,confirmButtonText:this.translate.instant("MailBox.composeMail.DRAFT.CONFIRMBTN"),cancelButtonText:this.translate.instant("MailBox.composeMail.DRAFT.DECBTN")}).then(a=>{a.value&&(this.saveDraft(),this.dialogref.close()),a.dismiss&&this.dialogref.close()})}createPayloadSendMail(){this.isForInvoice=!1;const a=this.sendEmailForm.value;let i={sender_property:{sender:this.currentUser.email,is_read:!1,mail_type:"sent"},recipient_properties:this.data&&this.data.fromCandidate?[]:this.recipientList,subject:a.subject?a.subject:"",message:a.message?a.message:"",is_sent:!0,status:"active",is_urgent_mail:!1,attachments:[],document_builder_ids:[],file_attachments:[],tags:["sent"],lang:this.translate.currentLang};return this.attachmnetsPaths&&this.attachmnetsPaths.length&&this.attachmnetsPaths.forEach(e=>{if(e&&e.path){const s={file_name:e.is_from_builder?e.path:e.file_name?e.file_name:e.name,path:e.path};i.attachments.push(e.is_from_builder?e.path:e.file_name),i.file_attachments.push(s)}e&&"Invoice"===e.document_id&&(this.isForInvoice=!0)}),this.listDocumentBuilder&&this.listDocumentBuilder.length&&(i.document_builder_ids=this.listDocumentBuilder),this.data&&this.data.length&&this.data.fromCandidate&&this.data.forEach(e=>{e&&i.recipient_properties.push({recipients:[e.emailDefault?e.emailDefault:e.email],rank:"a",is_read:!1,mail_type:"inbox",candidate_id:e?._id||e?.candidate?._id||null})}),i}sendMail(){this.isWaitingForResponse=!0;const a=this.createPayloadSendMail();console.log("send",a),this.subs.sink=this.mailboxService.CreateMailForMultipleRecipientsInvoice(a,this.isInvoiceDisplay,this.isForInvoice).subscribe(i=>{String(i).includes("recipient is more than 50, mail is still process sending")?u().fire({type:"info",title:this.translate.instant("SEND_EMAIL_S1.TITLE"),html:this.translate.instant("SEND_EMAIL_S1.TEXT"),confirmButtonText:this.translate.instant("SEND_EMAIL_S1.BUTTON"),allowOutsideClick:!1,allowEnterKey:!1,allowEscapeKey:!1}).then(()=>{this.isWaitingForResponse=!1,this.dialogref.close(!0)}):i&&u().fire({title:this.translate.instant("MailBox.composeMail.MESSAGES.TITLE"),text:this.translate.instant("MailBox.composeMail.MESSAGES.TEXT"),allowEscapeKey:!0,type:"success",confirmButtonText:this.translate.instant("MailBox.composeMail.MESSAGES.CONFIRMBTN")}).then(()=>{this.isWaitingForResponse=!1,this.dialogref.close(!0)})},i=>{this.userService.postErrorLog(i),i&&i.message&&i.message.includes("Network error: Http failure response for")?u().fire({type:"warning",title:this.translate.instant("BAD_CONNECTION.Title"),html:this.translate.instant("BAD_CONNECTION.Text"),confirmButtonText:this.translate.instant("BAD_CONNECTION.Button"),allowOutsideClick:!1,allowEnterKey:!1,allowEscapeKey:!1}):u().fire({type:"info",title:this.translate.instant("SORRY"),text:i&&i.message?this.translate.instant(i.message.replaceAll("GraphQL error: ","")):i,confirmButtonText:this.translate.instant("DISCONNECT_SCHOOL.BUTTON3")})})}handleInputChange(a){const i=a.target.files[0];i&&(this.subs.sink=this.fileUploadService.singleUpload(i).subscribe(e=>{e?this.attachmnetsPaths.push({path:e.file_url,file_name:e.file_name,is_from_builder:!1,document_id:null,invoice_name:""}):u().fire({type:"info",title:this.translate.instant("SORRY"),allowOutsideClick:!1,confirmButtonText:this.translate.instant("OK")})},e=>{this.userService.postErrorLog(e),e&&e.message&&e.message.includes("Network error: Http failure response for")?u().fire({type:"warning",title:this.translate.instant("BAD_CONNECTION.Title"),html:this.translate.instant("BAD_CONNECTION.Text"),confirmButtonText:this.translate.instant("BAD_CONNECTION.Button"),allowOutsideClick:!1,allowEnterKey:!1,allowEscapeKey:!1}):u().fire({type:"info",title:this.translate.instant("SORRY"),text:e&&e.message?this.translate.instant(e.message.replaceAll("GraphQL error: ","")):e,confirmButtonText:this.translate.instant("DISCONNECT_SCHOOL.BUTTON3")})})),this.resetFileState()}resetFileState(){this.currentFile.nativeElement.value=""}getCurrentUser(){this.currentUser=this.userService.getLocalStorageUser()}ngOnDestroy(){this.subs.unsubscribe()}saveDraft(){const a=this.createDraftPayload();this.subs.sink=this.mailboxService.CreateMailForMultipleRecipientsInvoice(a,this.isInvoiceDisplay,this.isForInvoice).subscribe(i=>{i&&u().fire({type:"info",title:this.translate.instant("MailBox.MESSAGES.DRAFTMSG"),text:"",confirmButtonText:this.translate.instant("MailBox.MESSAGES.THANK"),onOpen:e=>{e.setAttribute("data-cy","swal-mailbox")}})},i=>{this.userService.postErrorLog(i),i&&i.message&&i.message.includes("Network error: Http failure response for")?u().fire({type:"warning",title:this.translate.instant("BAD_CONNECTION.Title"),html:this.translate.instant("BAD_CONNECTION.Text"),confirmButtonText:this.translate.instant("BAD_CONNECTION.Button"),allowOutsideClick:!1,allowEnterKey:!1,allowEscapeKey:!1}):u().fire({type:"info",title:this.translate.instant("SORRY"),text:i&&i.message?this.translate.instant(i.message.replaceAll("GraphQL error: ","")):i,confirmButtonText:this.translate.instant("DISCONNECT_SCHOOL.BUTTON3")})})}createDraftPayload(){this.isForInvoice=!1;const a=this.sendEmailForm.value;let i={sender_property:{sender:this.currentUser.email,is_read:!1,mail_type:"draft"},recipient_properties:[],subject:a.subject?a.subject:"",message:a.message?a.message:"",is_sent:!1,status:"active",is_urgent_mail:!1,attachments:[],document_builder_ids:[],file_attachments:[],tags:["draft"],lang:this.translate.currentLang};if(this.attachmnetsPaths&&this.attachmnetsPaths.length&&this.attachmnetsPaths.forEach(e=>{if(e&&e.path){const s={file_name:e.is_from_builder?e.path:e.file_name?e.file_name:e.name,path:e.path};i.attachments.push(e.is_from_builder?e.path:e.file_name),i.file_attachments.push(s)}e&&"Invoice"===e.document_id&&(this.isForInvoice=!0)}),this.listDocumentBuilder&&this.listDocumentBuilder.length&&(i.document_builder_ids=this.listDocumentBuilder),this.data&&this.data.length&&this.data.fromCandidate)this.data.forEach(e=>{e&&i.recipient_properties.push({recipients:[e.emailDefault?e.emailDefault:e.email],rank:"a",is_read:!1,mail_type:"draft",candidate_id:e?.candidate?._id||null})});else{const e=n.cloneDeep(this.recipientList);e.forEach(s=>{s&&(s.mail_type="draft")}),i.recipient_properties=e}return i}addDoc(){console.log("data",this.data),this.addDocumentBuilderDialogComponent=this.dialog.open(F.V,{width:"600px",minHeight:"100px",disableClose:!0,data:{_id:this.data&&this.data.candidate?this.data.candidate._id:null,student:this.data&&this.data.candidate?this.data.candidate:null,is_multiple:!0,candidate_data:this.data,isFromFinance:this.triggeredFromFinance}}),this.subs.sink=this.addDocumentBuilderDialogComponent.afterClosed().subscribe(a=>{a&&("Invoice"===a.document_builder_name?this.attachmnetsPaths.push({path:null,file_name:a.document_id,is_from_builder:!1,document_id:"Invoice",invoice_name:a.invoice_name}):(this.listDocumentBuilder.push(a.document_id),this.attachmnetsPaths.push({path:null,file_name:a.document_builder_name,is_from_builder:!0,document_id:a.document_id,invoice_name:""})))})}openAttachment(a){if(a.is_from_builder&&this.data&&this.data.length)this.isWaitingForResponse=!0,this.subs.sink=this.studentsService.GenerateDocumentBuilderPDFForStudent(this.data[0]?.candidate?.candidate_id?._id||this.data[0]?._id||this.data[0]?.candidate?._id||null,a.document_id).subscribe(e=>{this.isWaitingForResponse=!1;const s=document.createElement("a");s.target="_blank",s.href=`${N.N.apiUrl}/fileuploads/${e}`.replace("/graphql",""),s.download=a.file_name,s.click(),s.remove()},e=>{this.userService.postErrorLog(e),this.isWaitingForResponse=!1,console.log("err",e),this.userService.postErrorLog(e),e&&e.message&&e.message.includes("Network error: Http failure response for")?u().fire({type:"warning",title:this.translate.instant("BAD_CONNECTION.Title"),html:this.translate.instant("BAD_CONNECTION.Text"),confirmButtonText:this.translate.instant("BAD_CONNECTION.Button"),allowOutsideClick:!1,allowEnterKey:!1,allowEscapeKey:!1}):u().fire({type:"info",title:this.translate.instant("SORRY"),text:e&&e.message?this.translate.instant(e.message.replaceAll("GraphQL error: ","")):e,confirmButtonText:this.translate.instant("DISCONNECT_SCHOOL.BUTTON3")})});else if(a.document_id&&"Invoice"===a.document_id){const i=`${A.a.baseApi}/fileuploads/${a.invoice_name}`.replace("/graphql",""),e=document.createElement("a");e.target="_blank",e.href=i,e.download=a.invoice_name,e.click(),e.remove()}}}return r.\u0275fac=function(a){return new(a||r)(t.\u0275\u0275directiveInject(f.WI),t.\u0275\u0275directiveInject(D.sK),t.\u0275\u0275directiveInject(R.e),t.\u0275\u0275directiveInject(w.e),t.\u0275\u0275directiveInject(I.J),t.\u0275\u0275directiveInject(f.so),t.\u0275\u0275directiveInject(p.UntypedFormBuilder),t.\u0275\u0275directiveInject(y.P),t.\u0275\u0275directiveInject(f.uw))},r.\u0275cmp=t.\u0275\u0275defineComponent({type:r,selectors:[["ms-send-multiple-email"]],viewQuery:function(a,i){if(1&a&&(t.\u0275\u0275viewQuery(j,5),t.\u0275\u0275viewQuery(G,5),t.\u0275\u0275viewQuery(H,5)),2&a){let e;t.\u0275\u0275queryRefresh(e=t.\u0275\u0275loadQuery())&&(i.languagesInput=e.first),t.\u0275\u0275queryRefresh(e=t.\u0275\u0275loadQuery())&&(i.matAutocomplete=e.first),t.\u0275\u0275queryRefresh(e=t.\u0275\u0275loadQuery())&&(i.currentFile=e.first)}},inputs:{allowOther:"allowOther",returnType:"returnType"},outputs:{optionSelected:"optionSelected"},decls:29,vars:21,consts:[[3,"formGroup"],[1,"fontColor"],["mat-dialog-title",""],["svgIcon","pencil","data-cy","dialog-icon",1,"icon-style"],["data-cy","dialog-title",1,"dialogTitle",2,"margin","0 !important","padding","0 !important"],[1,"alignment"],["mat-button","","mat-raised-button","","color","accent","data-cy","button-add-document",3,"click",4,"ngIf"],["data-cy","button-close-dialog",1,"icon-style","cursor-pointer",3,"matTooltip","click"],["data","","data-cy","button-attach-file",1,"icon-style","cursor-pointer",3,"matTooltip"],["type","file","name","file","multiple","","accept",".jpeg,.png,.rar,.zip,.doc,.docx,.ppt,.pdf,.xls","data-cy","input-file-document",2,"display","none",3,"change"],["myInput",""],["class","vertical-align-mid cursorStyle","data-cy","button-send",3,"matTooltip","click",4,"ngIf"],["style","color: rgb(170, 168, 168)","class","vertical-align-mid","data-cy","button-send",3,"matTooltip",4,"ngIf"],["matInput","","formControlName","subject","data-cy","input-subject",3,"placeholder"],[4,"ngIf"],[1,"file-section","p-col-12"],["class","fileInfo",4,"ngFor","ngForOf"],["formControlName","message","data-cy","input-cke-message-body",3,"editor","config","ready"],["class","loading-indicator",4,"ngIf"],["mat-button","","mat-raised-button","","color","accent","data-cy","button-add-document",3,"click"],["data-cy","button-send",1,"vertical-align-mid","cursorStyle",3,"matTooltip","click"],["data-cy","button-send",1,"vertical-align-mid",2,"color","rgb(170, 168, 168)",3,"matTooltip"],[1,"fileInfo"],["mat-icon-button","","type","button"],["data-cy","attached-document-name",3,"ngClass","click"],["mat-icon-button","","type","button",3,"click"],["data-cy","button-remove-document"],[1,"loading-indicator"],["mode","indeterminate","color","accent","data-cy","dialog-spinner"]],template:function(a,i){1&a&&(t.\u0275\u0275elementStart(0,"form",0)(1,"div",1)(2,"h1",2),t.\u0275\u0275element(3,"mat-icon",3),t.\u0275\u0275elementStart(4,"span",4),t.\u0275\u0275text(5),t.\u0275\u0275pipe(6,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(7,"div",5),t.\u0275\u0275template(8,_,3,3,"button",6),t.\u0275\u0275elementStart(9,"mat-icon",7),t.\u0275\u0275listener("click",function(){return i.closeDialog()}),t.\u0275\u0275pipe(10,"translate"),t.\u0275\u0275text(11,"close"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(12,"label")(13,"mat-icon",8),t.\u0275\u0275pipe(14,"translate"),t.\u0275\u0275text(15,"attachment"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(16,"input",9,10),t.\u0275\u0275listener("change",function(s){return i.handleInputChange(s)}),t.\u0275\u0275elementEnd()(),t.\u0275\u0275template(18,b,3,3,"mat-icon",11),t.\u0275\u0275template(19,l,3,3,"mat-icon",12),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(20,"mat-dialog-content")(21,"mat-form-field"),t.\u0275\u0275element(22,"input",13),t.\u0275\u0275pipe(23,"translate"),t.\u0275\u0275template(24,c,3,3,"mat-error",14),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(25,"div",15),t.\u0275\u0275template(26,d,9,5,"div",16),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(27,"ckeditor",17),t.\u0275\u0275listener("ready",function(s){return i.onReady(s)}),t.\u0275\u0275elementEnd()()()(),t.\u0275\u0275template(28,O,2,0,"div",18)),2&a&&(t.\u0275\u0275property("formGroup",i.sendEmailForm),t.\u0275\u0275advance(5),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(6,13,"MailBox.composeMail.title"),""),t.\u0275\u0275advance(3),t.\u0275\u0275property("ngIf",i.triggeredFromStudent||i.triggeredFromFinance),t.\u0275\u0275advance(1),t.\u0275\u0275propertyInterpolate("matTooltip",t.\u0275\u0275pipeBind1(10,15,"CLOSE")),t.\u0275\u0275advance(4),t.\u0275\u0275propertyInterpolate("matTooltip",t.\u0275\u0275pipeBind1(14,17,"MailBox.ATTACH_FILE")),t.\u0275\u0275advance(5),t.\u0275\u0275property("ngIf",i.sendEmailForm.get("subject").value&&!i.isWaitingForResponse),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",!(i.sendEmailForm.get("subject").value&&!i.isWaitingForResponse)),t.\u0275\u0275advance(3),t.\u0275\u0275propertyInterpolate("placeholder",t.\u0275\u0275pipeBind1(23,19,"MailBox.subject")),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",i.sendEmailForm.get("subject").hasError("required")&&(i.sendEmailForm.get("subject").dirty||i.sendEmailForm.get("subject").touched)),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngForOf",i.attachmnetsPaths),t.\u0275\u0275advance(1),t.\u0275\u0275property("editor",i.Editor)("config",i.config),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",i.isWaitingForResponse))},dependencies:[k.lW,f.uh,f.xY,L.Hw,x.TO,x.KE,U.Nt,W.Ou,T.gM,p.\u0275NgNoValidate,p.DefaultValueAccessor,p.NgControlStatus,p.NgControlStatusGroup,p.FormGroupDirective,p.FormControlName,K.oO,P.mk,P.sg,P.O5,V.u,D.X$],styles:[".top-space[_ngcontent-%COMP%]{margin-top:30px}table[_ngcontent-%COMP%]   .mat-select-trigger[_ngcontent-%COMP%]{display:inline-table}table[_ngcontent-%COMP%]   .mat-select-value[_ngcontent-%COMP%]{display:table-cell;max-width:0}table[_ngcontent-%COMP%]   .mat-select-arrow-wrapper[_ngcontent-%COMP%]{display:table-cell;vertical-align:middle}[_nghost-%COMP%]     table:not(.no-action-header):not(.notif-table) th{font-weight:400}[_nghost-%COMP%]     table:not(.no-action-header):not(.notif-table) thead>tr:first-child{height:40px}[_nghost-%COMP%]     table:not(.no-action-header):not(.notif-table) thead>tr:nth-child(2){border-top:4px solid #607d8b}[_nghost-%COMP%]     table:not(.no-action-header):not(.notif-table) thead>tr:not(:first-child){border-left:4px solid #607d8b;border-right:4px solid #607d8b}[_nghost-%COMP%]     table:not(.no-action-header):not(.notif-table) thead>tr:nth-last-child(2){border-bottom:4px solid #607d8b}[_nghost-%COMP%]     table:not(.no-action-header):not(.notif-table) thead>tr:last-child{border-bottom:4px solid #607d8b}[_nghost-%COMP%]     table:not(.no-action-header):not(.notif-table) tbody>tr{border-left:4px solid #607d8b;border-right:4px solid #607d8b}[_nghost-%COMP%]     table:not(.no-action-header):not(.notif-table) tbody>tr:last-child{border-bottom:4px solid #607d8b}[_nghost-%COMP%]     table:not(.no-action-header):not(.notif-table) tbody tr:nth-child(odd){background-color:#607d8b}[_nghost-%COMP%]     table:not(.no-action-header):not(.notif-table) tbody tr:nth-child(odd) .mat-icon-button .mat-icon{line-height:1!important}[_nghost-%COMP%]     table:not(.no-action-header):not(.notif-table) tbody tr:nth-child(odd) .mat-icon-button{background:#353535;line-height:0!important}[_nghost-%COMP%]     table:not(.no-action-header):not(.notif-table) tbody tr:nth-child(even){background-color:#353535}[_nghost-%COMP%]     table:not(.no-action-header):not(.notif-table) tbody tr:nth-child(even) .mat-icon-button .mat-icon{line-height:1!important}[_nghost-%COMP%]     table:not(.no-action-header):not(.notif-table) tbody tr:nth-child(even) .mat-icon-button{background:#607d8b;line-height:0!important}[_nghost-%COMP%]     table.no-action-header th{font-weight:400}[_nghost-%COMP%]     table.no-action-header thead>tr:nth-child(1){border-top:4px solid #607d8b;border-left:4px solid #607d8b;border-right:4px solid #607d8b}[_nghost-%COMP%]     table.no-action-header thead>tr:not(:first-child){border-left:4px solid #607d8b;border-right:4px solid #607d8b}[_nghost-%COMP%]     table.no-action-header thead>tr:nth-last-child(2){border-bottom:4px solid #607d8b}[_nghost-%COMP%]     table.no-action-header thead>tr:last-child{border-bottom:4px solid #607d8b}[_nghost-%COMP%]     table.no-action-header tbody>tr{border-left:4px solid #607d8b;border-right:4px solid #607d8b}[_nghost-%COMP%]     table.no-action-header tbody>tr:last-child{border-bottom:4px solid #607d8b}[_nghost-%COMP%]     table.no-action-header tbody tr:nth-child(odd){background-color:#607d8b}[_nghost-%COMP%]     table.no-action-header tbody tr:nth-child(odd) .mat-icon-button .mat-icon{line-height:1!important}[_nghost-%COMP%]     table.no-action-header tbody tr:nth-child(odd) .mat-icon-button{background:#353535;line-height:0!important}[_nghost-%COMP%]     table.no-action-header tbody tr:nth-child(even){background-color:#353535}[_nghost-%COMP%]     table.no-action-header tbody tr:nth-child(even) .mat-icon-button .mat-icon{line-height:1!important}[_nghost-%COMP%]     table.no-action-header tbody tr:nth-child(even) .mat-icon-button{background:#607d8b;line-height:0!important}.horizontal[_ngcontent-%COMP%]{overflow:auto}.child-tab-font[_ngcontent-%COMP%]{font-size:.8rem}.center-spinner[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.hide[_ngcontent-%COMP%], .hidden[_ngcontent-%COMP%]{display:none!important}.header-div[_ngcontent-%COMP%]{border-bottom:1px solid black;display:flex;padding:1rem}.header-text[_ngcontent-%COMP%]{color:#000;margin-left:1rem;margin-bottom:0!important}.header-icon[_ngcontent-%COMP%]{align-self:center;margin-left:auto!important;background-color:transparent!important}.baseline-align[_ngcontent-%COMP%]{align-items:baseline}.admtc-table-button[_ngcontent-%COMP%], button.yellow-button.mat-raised-button[_ngcontent-%COMP%], button.blue-patina-button.mat-raised-button[_ngcontent-%COMP%]{min-width:7em;height:2.8em;font-size:1.2em;font-family:Roboto,Helvetica Neue,sans-serif!important}.admtc-table-button[_ngcontent-%COMP%]   .mat-icon[svgicon][_ngcontent-%COMP%], button.yellow-button.mat-raised-button[_ngcontent-%COMP%]   .mat-icon[svgicon][_ngcontent-%COMP%], button.blue-patina-button.mat-raised-button[_ngcontent-%COMP%]   .mat-icon[svgicon][_ngcontent-%COMP%]{margin-top:.5em;margin-right:.3em}.admtc-normal-button[_ngcontent-%COMP%], button.yellow-button-normal.mat-raised-button[_ngcontent-%COMP%]{min-width:7em;height:2em;font-size:1em;font-family:Roboto,Helvetica Neue,sans-serif!important}.admtc-normal-button[_ngcontent-%COMP%]   .mat-icon[svgicon][_ngcontent-%COMP%], button.yellow-button-normal.mat-raised-button[_ngcontent-%COMP%]   .mat-icon[svgicon][_ngcontent-%COMP%]{margin-top:.3em;margin-right:.2em}.background-accent[_ngcontent-%COMP%], button.yellow-button-normal.mat-raised-button[_ngcontent-%COMP%], button.yellow-button.mat-raised-button[_ngcontent-%COMP%]{background-color:#fdd835!important;color:#000000de}.background-warn[_ngcontent-%COMP%]{background-color:red!important;color:#fff}.background-success[_ngcontent-%COMP%]{background-color:#4caf50!important;color:#fff}.background-primary[_ngcontent-%COMP%]{background-color:#607d8b!important;color:#fff}.background-medium-grey[_ngcontent-%COMP%]{background-color:#424242!important;color:#fff}.background-black[_ngcontent-%COMP%]{background-color:#212121!important;color:#fff}button.blue-patina-button.mat-raised-button[_ngcontent-%COMP%]{background-color:#607d8b!important}[_nghost-%COMP%]     .mat-slide-toggle.mat-checked .mat-slide-toggle-bar .mat-slide-toggle-thumb{background-color:#fdd835}[_nghost-%COMP%]     .mat-slide-toggle.mat-checked .mat-slide-toggle-bar{background-color:#ffc10780}[_nghost-%COMP%]     .mat-form-field-appearance-outline .mat-form-field-infix{padding:.15rem}[_nghost-%COMP%]     mat-form-field.mat-form-field-should-float label{font-size:18px;font-weight:600;color:#000}.status-icon[_ngcontent-%COMP%], .red-icon[_ngcontent-%COMP%], .purple-icon[_ngcontent-%COMP%], .black-icon[_ngcontent-%COMP%], .greenyellow-icon[_ngcontent-%COMP%], .yellow-icon[_ngcontent-%COMP%], .green-icon[_ngcontent-%COMP%]{font-size:25px;width:30px}.is-loading[_ngcontent-%COMP%]   .mat-option-text[_ngcontent-%COMP%]{display:flex;justify-content:center}.display-flex[_ngcontent-%COMP%]{display:flex}.green-icon[_ngcontent-%COMP%]{color:#4caf50}.yellow-icon[_ngcontent-%COMP%]{color:#ff0}.greenyellow-icon[_ngcontent-%COMP%]{color:#adff2f}.black-icon[_ngcontent-%COMP%]{color:#000}.purple-icon[_ngcontent-%COMP%]{color:purple}.red-icon[_ngcontent-%COMP%], .red-text[_ngcontent-%COMP%]{color:red}.text-white[_ngcontent-%COMP%]{color:#fff}.greenyellow-text[_ngcontent-%COMP%]{color:#adff2f!important}.mat-sort-header-container[_ngcontent-%COMP%]{justify-content:center}.tags[_ngcontent-%COMP%]{background-color:#fdd835;color:#000;padding:3px 5px;border-radius:3px;margin-right:5px}.p-grid[_ngcontent-%COMP%]{margin-right:unset!important;margin-left:unset!important;margin-top:unset!important}.add-btn[_ngcontent-%COMP%]{background:#fdd835;width:10rem}.color[_ngcontent-%COMP%]{background:#607d8b;width:10rem}.alignment[_ngcontent-%COMP%]{text-align:right;padding-right:0}mat-form-field[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]     .ck-editor__editable_inline{min-height:50px;border:1px solid #b8b8b8;background:white;color:#000}.fontColor[_ngcontent-%COMP%]{color:#000}.yellow-border[_ngcontent-%COMP%]{border:2px solid #fdd835}.silver-border[_ngcontent-%COMP%]{border:2px solid whitesmoke}.red-border[_ngcontent-%COMP%]{border:2px solid red}.certification-rule-pop-up[_ngcontent-%COMP%]   .mat-dialog-container[_ngcontent-%COMP%]{padding:0}.one-time-pop-up[_ngcontent-%COMP%]   .mat-dialog-container[_ngcontent-%COMP%]{width:800px!important}.dark-mode-pop-up[_ngcontent-%COMP%]   .mat-dialog-container[_ngcontent-%COMP%]{color:#fff;background:#303030}.grey-mode-pop-up[_ngcontent-%COMP%]   .mat-dialog-container[_ngcontent-%COMP%]{color:#fff;background:#7c7c7c}.view-step-validation-pop-up[_ngcontent-%COMP%]   .mat-dialog-container[_ngcontent-%COMP%]{max-height:590px}.image-preview-pop-up[_ngcontent-%COMP%]   .mat-dialog-container[_ngcontent-%COMP%]{background:rgba(0,0,0,.231372549);box-shadow:none;padding:0;overflow:hidden}.pass-fail-pop-up[_ngcontent-%COMP%]   .mat-dialog-container[_ngcontent-%COMP%]{padding:0 24px 18px}.expected-doc-task[_ngcontent-%COMP%]   .mat-dialog-container[_ngcontent-%COMP%]{padding:16px!important;overflow:visible}.no-padding-pop-up[_ngcontent-%COMP%]   .mat-dialog-container[_ngcontent-%COMP%]{padding:0;overflow:visible}.questionnaire-simulation-pop-up[_ngcontent-%COMP%]   .mat-dialog-container[_ngcontent-%COMP%]{overflow:scroll;width:60vw;max-height:90vh;background-color:#607d8b;color:#fff}.reply-message-pop-up[_ngcontent-%COMP%]   .mat-dialog-container[_ngcontent-%COMP%]{padding:0;min-height:430px}.send-pro-evaluation-pop-up[_ngcontent-%COMP%]   .mat-dialog-container[_ngcontent-%COMP%]{padding:0;min-height:430px;visibility:hidden}.banner-connect-snackbar[_ngcontent-%COMP%]{padding:0!important;min-height:0!important;max-height:0!important}.editor-background-white[_ngcontent-%COMP%]{background-color:#fafafa;color:#000}.editor-background-white[_ngcontent-%COMP%]   .ck-editor__editable[_ngcontent-%COMP%]{min-height:140px!important}.small-text-fieldset[_ngcontent-%COMP%]{font-size:12px}.small-icon[_ngcontent-%COMP%]{transform:scale(.6)}.padding-0[_ngcontent-%COMP%]{padding:0!important}.mt-1rem[_ngcontent-%COMP%]{margin-top:1rem}.mr-1rem[_ngcontent-%COMP%]{margin-right:1rem}.mb-1rem[_ngcontent-%COMP%]{margin-bottom:1rem}.ellipsis-one-line[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.span-block[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content;display:block;max-width:-webkit-fill-available;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.dialog-title[_ngcontent-%COMP%]{color:#000}.icon-self-right[_ngcontent-%COMP%]{position:absolute;right:0;top:0;cursor:pointer}.dialog-body[_ngcontent-%COMP%]{color:#000}.no-padding[_ngcontent-%COMP%]{padding:0!important}.no-padding-x[_ngcontent-%COMP%]{padding-right:0!important;padding-left:0!important}.no-padding-y[_ngcontent-%COMP%]{padding-top:0!important;padding-bottom:0!important}.no-padding-r[_ngcontent-%COMP%]{padding-right:0!important}.no-padding-l[_ngcontent-%COMP%]{padding-left:0!important}.no-padding-t[_ngcontent-%COMP%]{padding-top:0!important}.no-padding-b[_ngcontent-%COMP%]{padding-bottom:0!important}.no-margin[_ngcontent-%COMP%]{margin:0}.align-center[_ngcontent-%COMP%]{text-align:center}.align-end[_ngcontent-%COMP%]{text-align:end}.one-line-text[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}[_ngcontent-%COMP%]::-webkit-scrollbar{-webkit-appearance:none;width:7px;height:8px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:4px;background-color:#00000080;box-shadow:0 0 1px #ffffff80;-webkit-box-shadow:0 0 1px rgba(255,255,255,.5)}.ckeditor-small[_ngcontent-%COMP%]   .ck-editor__editable[_ngcontent-%COMP%]{min-height:140px!important;max-height:140px!important;border:1px solid rgba(0,0,0,.5)!important}.ckeditor-medium[_ngcontent-%COMP%]   .ck-editor__editable[_ngcontent-%COMP%]{min-height:300px!important;max-height:300px!important;border:1px solid rgba(0,0,0,.5)!important}.ckeditor-big[_ngcontent-%COMP%]   .ck-editor__editable[_ngcontent-%COMP%]{min-height:500px!important;max-height:500px!important}.ckeditor-white-background[_ngcontent-%COMP%]{background-color:#fff!important;color:#000!important}.custom-dialog-container-publishable-doc[_ngcontent-%COMP%]   .mat-dialog-container[_ngcontent-%COMP%]{overflow:unset;padding:15px}.align-input-field[_ngcontent-%COMP%]{margin-bottom:9px}.hide-pagination-buttons[_ngcontent-%COMP%]   .mat-paginator-navigation-first[_ngcontent-%COMP%], .hide-pagination-buttons[_ngcontent-%COMP%]   .mat-paginator-navigation-previous[_ngcontent-%COMP%], .hide-pagination-buttons[_ngcontent-%COMP%]   .mat-paginator-navigation-next[_ngcontent-%COMP%], .hide-pagination-buttons[_ngcontent-%COMP%]   .mat-paginator-navigation-last[_ngcontent-%COMP%]{display:none!important}.clickable[_ngcontent-%COMP%]{cursor:pointer}input[type=number][_ngcontent-%COMP%]::-webkit-inner-spin-button, input[type=number][_ngcontent-%COMP%]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.flex-layout-row-wrap[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;box-sizing:border-box}.icon-style[_ngcontent-%COMP%]{vertical-align:middle;margin-right:1rem}.cursor-pointer[_ngcontent-%COMP%]{cursor:pointer}[_nghost-%COMP%]     .mat-dialog-content{max-height:520px;height:auto}[_nghost-%COMP%]     .ck-editor__editable_inline{height:45vh}.alignment[_ngcontent-%COMP%]{float:right}.cursorStyle[_ngcontent-%COMP%], .pointer[_ngcontent-%COMP%]{cursor:pointer}.fileInfo[_ngcontent-%COMP%]{width:-moz-fit-content!important;width:fit-content!important;margin:5px!important;display:inline-block!important;border:1px solid rgba(0,0,0,.1);z-index:10;box-shadow:inset 1px 1px #0000001a,inset 0 -1px #00000012}.chip-list[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]  .mat-radio-outer-circle{border-color:#0000008a!important}[_nghost-%COMP%]  .mat-form-field-underline{background-color:#0000001f!important}"]}),r})()},26698:(Q,B,o)=>{o.d(B,{V:()=>H});var t=o(35226),f=o.n(t),C=o(65938),$=o(68745),p=o(24006),E=o(92340),u=o(15439),n=o(94650),S=o(89383),F=o(84075),N=o(80484),A=o(36746),D=o(69725),R=o(80529),w=o(52688),I=o(36895),y=o(73555),k=o(4859),L=o(97392),x=o(59549),U=o(51572),W=o(10266),T=o(88796);const K=["fileUploadDoc"];function P(_,b){1&_&&(n.\u0275\u0275elementStart(0,"ng-option",14),n.\u0275\u0275text(1),n.\u0275\u0275pipe(2,"translate"),n.\u0275\u0275elementEnd()),2&_&&(n.\u0275\u0275property("value","Invoice"),n.\u0275\u0275advance(1),n.\u0275\u0275textInterpolate1(" ",n.\u0275\u0275pipeBind1(2,2,"INVOICE")," "))}function V(_,b){if(1&_&&(n.\u0275\u0275elementStart(0,"ng-option",14),n.\u0275\u0275text(1),n.\u0275\u0275elementEnd()),2&_){const l=b.$implicit;n.\u0275\u0275property("value",null==l?null:l.document_builder_name),n.\u0275\u0275advance(1),n.\u0275\u0275textInterpolate1(" ",null==l?null:l.document_builder_name," ")}}function j(_,b){1&_&&(n.\u0275\u0275elementStart(0,"mat-error"),n.\u0275\u0275text(1),n.\u0275\u0275pipe(2,"translate"),n.\u0275\u0275elementEnd()),2&_&&(n.\u0275\u0275advance(1),n.\u0275\u0275textInterpolate(n.\u0275\u0275pipeBind1(2,1,"This field is required")))}function G(_,b){1&_&&(n.\u0275\u0275elementStart(0,"div",15),n.\u0275\u0275element(1,"mat-progress-spinner",16),n.\u0275\u0275elementEnd())}let H=(()=>{class _{constructor(l,c,h,d,O,g,v,r,m,a){this.dialogRef=l,this.parentData=c,this.fb=h,this.translate=d,this.utilService=O,this.fileUploadService=g,this.acadKitService=v,this.studentsService=r,this.httpClient=m,this.authService=a,this.isWaitingForResponse=!1,this.isInvoiceDisplay=!0,this.subs=new $.Y,this.fileTypesControl=new p.FormControl(""),this.fileTypes=[],this.selectedFileType="",this.selectedMaxSize=0,this.listDataDropdown=[]}ngOnInit(){console.log(this.parentData),this.initUploadDocForm(),this.getDataDropdown()}getDataDropdown(){this.listDataDropdown=[],this.isWaitingForResponse=!0,this.subs.sink=this.studentsService.getAllDocumentsPublished().subscribe(l=>{this.isWaitingForResponse=!1,this.listDataDropdown=l&&l.length?l:[]},l=>{this.authService.postErrorLog(l),this.isWaitingForResponse=!1,console.log("err",l),this.authService.postErrorLog(l),l&&l.message&&l.message.includes("Network error: Http failure response for")?f().fire({type:"warning",title:this.translate.instant("BAD_CONNECTION.Title"),html:this.translate.instant("BAD_CONNECTION.Text"),confirmButtonText:this.translate.instant("BAD_CONNECTION.Button"),allowOutsideClick:!1,allowEnterKey:!1,allowEscapeKey:!1}):f().fire({type:"info",title:this.translate.instant("SORRY"),text:l&&l.message?this.translate.instant(l.message.replaceAll("GraphQL error: ","")):l,confirmButtonText:this.translate.instant("DISCONNECT_SCHOOL.BUTTON3")})})}initUploadDocForm(){this.uploadDocForm=this.fb.group({document_id:["",p.Validators.required],document_builder_name:["",p.Validators.required],s3_file_name:[""]})}getDataDocument(l){const c=this.listDataDropdown?.findIndex(d=>d?.document_builder_name===l),h=this.listDataDropdown[c]?._id;h&&(this.uploadDocForm.get("document_id").setValue(h),this.parentData&&!this.parentData.is_multiple&&(this.isWaitingForResponse=!0,this.subs.sink=this.studentsService.GenerateDocumentBuilderPDFForStudent(this.parentData._id,h).subscribe(d=>{this.isWaitingForResponse=!1,d?(this.uploadDocForm.get("s3_file_name").setValue(d),this.selectedFile=d):(this.uploadDocForm.get("s3_file_name").setValue(null),this.selectedFile=null)},d=>{this.authService.postErrorLog(d),this.isWaitingForResponse=!1,console.log("err",d),this.authService.postErrorLog(d),d&&d.message&&d.message.includes("Network error: Http failure response for")?f().fire({type:"warning",title:this.translate.instant("BAD_CONNECTION.Title"),html:this.translate.instant("BAD_CONNECTION.Text"),confirmButtonText:this.translate.instant("BAD_CONNECTION.Button"),allowOutsideClick:!1,allowEnterKey:!1,allowEscapeKey:!1}):f().fire({type:"info",title:this.translate.instant("SORRY"),text:d&&d.message?this.translate.instant(d.message.replaceAll("GraphQL error: ","")):d,confirmButtonText:this.translate.instant("DISCONNECT_SCHOOL.BUTTON3")})})))}closeDialog(){this.dialogRef.close()}checkFormValidity(){return!!this.uploadDocForm.invalid&&(f().fire({type:"warning",title:this.translate.instant("FormSave_S1.TITLE"),html:this.translate.instant("FormSave_S1.TEXT"),confirmButtonText:this.translate.instant("FormSave_S1.BUTTON"),onOpen:l=>{l.setAttribute("data-cy","swal-formsave-s1")}}),this.uploadDocForm.markAllAsTouched(),!0)}submit(){if(this.checkFormValidity())return;let l;if(console.log("Data Payload",this.uploadDocForm.value),this.uploadDocForm.get("document_builder_name").value===this.translate.instant("INVOICE"))l=this.uploadDocForm.value,l.document_builder_name="Invoice",l.invoice_name=this.documentInvoiceName;else{const c=this.uploadDocForm.get("s3_file_name").value;l={path:`${E.N.apiUrl}/fileuploads/${c}`.replace("/graphql",""),file_name:this.uploadDocForm.get("document_builder_name").value},this.parentData&&this.parentData.is_multiple&&(l=this.uploadDocForm.value)}this.dialogRef.close(l)}selectDocument(l){l&&"Invoice"===l?this.getInvoiceData():l&&"Invoice"!==l&&this.getDataDocument(l)}getInvoiceData(){this.isWaitingForResponse=!0;const l=u(new Date,"DD/MM/YYYY").format("DDMMYYYY"),c=u(new Date).format("HH:mm");if(this.parentData.candidate_data&&this.parentData.candidate_data.length){const h=E.N.apiUrl.replace("/graphql","");this.httpClient.get(`${h}/downloadStudentInvoice/${this.parentData?.candidate_data[0]?.candidate?.candidate_id?._id||this.parentData?.candidate_data[0]?.candidate?._id||this.parentData?.candidate_data[0]?._id||null}/${this.translate.currentLang}/${this.parentData?.candidate_data[0]?.intake_channel?.scholar_season_id?._id||this.parentData?.candidate_data[0]?.candidate?.intake_channel?.scholar_season_id?._id||null}/${this.parentData?.candidate_data[0]?.intake_channel?._id||this.parentData?.candidate_data[0]?.candidate?.intake_channel?._id||null}?date=${l}&time=${c}`,{responseType:"text"}).subscribe(r=>{if(console.log("invoice",r),r){this.isWaitingForResponse=!1;const m=this.translate.instant("INVOICE");this.uploadDocForm.get("document_id").setValue(m),this.uploadDocForm.get("document_builder_name").setValue(this.translate.instant("INVOICE")),this.documentInvoiceName=r}else{const m=this.translate.instant("INVOICE");this.uploadDocForm.get("document_id").setValue(m),this.uploadDocForm.get("document_builder_name").setValue(this.translate.instant("INVOICE")),this.documentInvoiceName=m,this.isWaitingForResponse=!1}},r=>{const m=this.translate.instant("INVOICE");this.uploadDocForm.get("document_id").setValue(m),this.uploadDocForm.get("document_builder_name").setValue(this.translate.instant("INVOICE")),this.documentInvoiceName=m,this.isWaitingForResponse=!1})}else if(this.parentData&&this.parentData._id){const d=`${E.N.apiUrl.replace("/graphql","")}/downloadStudentInvoice/${this.parentData._id}/${this.translate.currentLang}`;this.httpClient.get(d,{responseType:"text"}).subscribe(O=>{if(O)this.isWaitingForResponse=!1,this.uploadDocForm.get("document_id").setValue(O),this.uploadDocForm.get("document_builder_name").setValue(this.translate.instant("INVOICE")),this.documentInvoiceName=O;else{const g=this.translate.instant("INVOICE");this.uploadDocForm.get("document_id").setValue(g),this.uploadDocForm.get("document_builder_name").setValue(this.translate.instant("INVOICE")),this.documentInvoiceName=g,this.isWaitingForResponse=!1}},O=>{const g=this.translate.instant("INVOICE");this.uploadDocForm.get("document_id").setValue(g),this.uploadDocForm.get("document_builder_name").setValue(this.translate.instant("INVOICE")),this.documentInvoiceName=g,this.isWaitingForResponse=!1})}else this.isWaitingForResponse=!1}ngOnDestroy(){this.subs.unsubscribe()}}return _.\u0275fac=function(l){return new(l||_)(n.\u0275\u0275directiveInject(C.so),n.\u0275\u0275directiveInject(C.WI),n.\u0275\u0275directiveInject(p.FormBuilder),n.\u0275\u0275directiveInject(S.sK),n.\u0275\u0275directiveInject(F.t),n.\u0275\u0275directiveInject(N.J),n.\u0275\u0275directiveInject(A.P),n.\u0275\u0275directiveInject(D.P),n.\u0275\u0275directiveInject(R.eN),n.\u0275\u0275directiveInject(w.e))},_.\u0275cmp=n.\u0275\u0275defineComponent({type:_,selectors:[["ms-add-document-builder-dialog"]],viewQuery:function(l,c){if(1&l&&n.\u0275\u0275viewQuery(K,5),2&l){let h;n.\u0275\u0275queryRefresh(h=n.\u0275\u0275loadQuery())&&(c.fileUploaderDoc=h.first)}},decls:27,vars:28,consts:[["mat-dialog-title","","cdkDrag","","cdkDragRootElement",".cdk-overlay-pane","cdkDragHandle","",2,"border-bottom","1px solid #000000"],["data-c","button-close-dialog",1,"icon-style",2,"vertical-align","middle","float","right",3,"matTooltip","click"],["mat-dialog-content","",1,"mat-dialog-content","dialog-body",3,"formGroup"],[1,"p-grid"],[1,"p-col-5","pt-16"],[1,"p-col-7"],["formControlName","document_builder_name",1,"custom-ngselect-content",3,"clearable","appendTo","placeholder","notFoundText","change"],[3,"value",4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["mat-dialog-actions","",1,"justify-content-end"],["mat-button","","mat-raised-button","","color","warn","data-cy","button-cancel",3,"click"],["mat-button","","mat-raised-button","","color","primary","data-cy","button-validate",1,"mr-0",3,"click"],["class","loading-indicator",4,"ngIf"],[3,"value"],[1,"loading-indicator"],["mode","indeterminate","color","accent","data-cy","dialog-spinner"]],template:function(l,c){1&l&&(n.\u0275\u0275elementStart(0,"h1",0),n.\u0275\u0275text(1),n.\u0275\u0275pipe(2,"translate"),n.\u0275\u0275elementStart(3,"mat-icon",1),n.\u0275\u0275listener("click",function(){return c.closeDialog()}),n.\u0275\u0275pipe(4,"translate"),n.\u0275\u0275text(5,"close"),n.\u0275\u0275elementEnd()(),n.\u0275\u0275elementStart(6,"div",2)(7,"div",3)(8,"div",4)(9,"label"),n.\u0275\u0275text(10),n.\u0275\u0275pipe(11,"translate"),n.\u0275\u0275elementEnd()(),n.\u0275\u0275elementStart(12,"div",5)(13,"ng-select",6),n.\u0275\u0275listener("change",function(d){return c.selectDocument(d)}),n.\u0275\u0275pipe(14,"translate"),n.\u0275\u0275pipe(15,"translate"),n.\u0275\u0275template(16,P,3,4,"ng-option",7),n.\u0275\u0275template(17,V,2,2,"ng-option",8),n.\u0275\u0275elementEnd(),n.\u0275\u0275template(18,j,3,3,"mat-error",9),n.\u0275\u0275elementEnd()()(),n.\u0275\u0275elementStart(19,"div",10)(20,"button",11),n.\u0275\u0275listener("click",function(){return c.closeDialog()}),n.\u0275\u0275text(21),n.\u0275\u0275pipe(22,"translate"),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(23,"button",12),n.\u0275\u0275listener("click",function(){return c.submit()}),n.\u0275\u0275text(24),n.\u0275\u0275pipe(25,"translate"),n.\u0275\u0275elementEnd()(),n.\u0275\u0275template(26,G,2,0,"div",13)),2&l&&(n.\u0275\u0275advance(1),n.\u0275\u0275textInterpolate1(" ",n.\u0275\u0275pipeBind1(2,14,"Add document")," "),n.\u0275\u0275advance(2),n.\u0275\u0275propertyInterpolate("matTooltip",n.\u0275\u0275pipeBind1(4,16,"CLOSE")),n.\u0275\u0275advance(3),n.\u0275\u0275property("formGroup",c.uploadDocForm),n.\u0275\u0275advance(4),n.\u0275\u0275textInterpolate1("",n.\u0275\u0275pipeBind1(11,18,"Please select a document"),": *"),n.\u0275\u0275advance(3),n.\u0275\u0275propertyInterpolate("placeholder",n.\u0275\u0275pipeBind1(14,20,"Please select a document")),n.\u0275\u0275propertyInterpolate("notFoundText",n.\u0275\u0275pipeBind1(15,22,"NOT RECORD FOUND")),n.\u0275\u0275property("clearable",!0)("appendTo","body"),n.\u0275\u0275advance(3),n.\u0275\u0275property("ngIf",(null==c.parentData?null:c.parentData.is_multiple)&&c.isInvoiceDisplay),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngForOf",c.listDataDropdown),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",c.uploadDocForm.get("document_builder_name").errors),n.\u0275\u0275advance(3),n.\u0275\u0275textInterpolate1(" ",n.\u0275\u0275pipeBind1(22,24,"CANCEL")," "),n.\u0275\u0275advance(3),n.\u0275\u0275textInterpolate1(" ",n.\u0275\u0275pipeBind1(25,26,"Validate")," "),n.\u0275\u0275advance(2),n.\u0275\u0275property("ngIf",c.isWaitingForResponse))},dependencies:[I.sg,I.O5,y.Zt,y.Bh,k.lW,C.uh,C.xY,C.H8,L.Hw,x.TO,U.Ou,W.gM,p.NgControlStatus,p.NgControlStatusGroup,p.FormGroupDirective,p.FormControlName,T.w9,T.jq,S.X$],styles:[".pt-16[_ngcontent-%COMP%]{padding-top:16px!important}[_nghost-%COMP%]  .ng-select .ng-select-container{background-color:#fff0;color:#000;border:none;border-radius:0!important;border-bottom:1px solid #8c8c8c!important;min-height:36px;align-items:center}"]}),_})()}}]);