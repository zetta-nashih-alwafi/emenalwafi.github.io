"use strict";(self.webpackChunkGene=self.webpackChunkGene||[]).push([[8092,4318],{68310:(L,y,r)=>{r.d(y,{j:()=>S});var s=r(24006),u=r(65938),h=r(68745),f=r(35226),p=r.n(f),o=r(17489),e=r(94650),t=r(89383),i=r(84075),l=r(80484),_=r(94442),g=r(52688),P=r(73555),v=r(4859),E=r(73546),I=r(97392),A=r(59549),U=r(284),O=r(51572),T=r(36895);const M=["fileUploadDoc"];function B(c,C){if(1&c){const a=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",20)(1,"button",21),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(a);const m=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(m.uploadSubmitFlyer())}),e.\u0275\u0275elementStart(2,"mat-icon"),e.\u0275\u0275text(3,"file_upload"),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"button",12),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(a);const m=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(m.removeFile())}),e.\u0275\u0275elementStart(7,"mat-icon"),e.\u0275\u0275text(8,"delete"),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(9),e.\u0275\u0275pipe(10,"translate"),e.\u0275\u0275elementEnd()()}2&c&&(e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(5,2,"ACAD_KIT.DOC.Add this File")," "),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(10,4,"ACAD_KIT.DOC.Remove")," "))}function x(c,C){if(1&c&&(e.\u0275\u0275elementStart(0,"div",16)(1,"div",6)(2,"mat-card")(3,"div",17)(4,"mat-icon",18),e.\u0275\u0275text(5,"insert_drive_file"),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(6),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(7,B,11,6,"div",19),e.\u0275\u0275elementEnd()()()),2&c){const a=e.\u0275\u0275nextContext();let d;e.\u0275\u0275advance(6),e.\u0275\u0275textInterpolate1(" ",null==a.uploadDocForm||null==(d=a.uploadDocForm.get("s3_file_name"))?null:d.value," "),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",a.selectedFile)}}function F(c,C){1&c&&(e.\u0275\u0275elementStart(0,"div",22),e.\u0275\u0275element(1,"mat-spinner",23),e.\u0275\u0275elementEnd()),2&c&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("diameter",100))}function D(c,C){if(1&c){const a=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",24),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(a);const m=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(m.openUploadWindow())}),e.\u0275\u0275elementStart(1,"mat-icon"),e.\u0275\u0275text(2,"add"),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementEnd()}if(2&c){const a=e.\u0275\u0275nextContext();e.\u0275\u0275property("disabled",!(null!=a.uploadDocForm&&a.uploadDocForm.valid)),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(4,2,"ACAD_KIT.DOC.File")," ")}}let S=(()=>{class c{constructor(a,d,m,b,R,Y,w,K){this.dialogRef=a,this.parentData=d,this.fb=m,this.translate=b,this.utilService=R,this.fileUploadService=Y,this.financeService=w,this.authService=K,this.isWaitingForResponse=!1,this.subs=new h.Y,this.fileTypesControl=new s.UntypedFormControl(""),this.fileTypes=[],this.selectedFileType="",this.selectedMaxSize=0}ngOnInit(){console.log(this.parentData),this.initUploadDocForm(),this.parentData&&this.parentData.admission_flyer&&this.parentData.admission_flyer.document_name&&this.parentData.admission_flyer.s3_file_name&&this.uploadDocForm.patchValue(this.parentData.admission_flyer),this.firstForm=o.cloneDeep(this.uploadDocForm.value)}initUploadDocForm(){this.uploadDocForm=this.fb.group({document_name:["",s.Validators.required],s3_file_name:[""]})}closeDialog(){console.log(this.uploadDocForm.value),this.dialogRef.close()}openUploadWindow(){this.fileUploaderDoc.nativeElement.click(),this.selectedMaxSize=0}addFile(a){const b=this.utilService.getFileExtension(a.target.files[0].name).toLocaleLowerCase();["pdf"].includes(b)?this.utilService.countFileSize(a.target.files[0],this.selectedMaxSize)?(this.selectedFile=a.target.files[0],this.uploadDocForm.get("s3_file_name").setValue(this.selectedFile.name)):p().fire({type:"warning",title:this.translate.instant("UPLOAD_RESTRICT_TO_FILESIZE_File.TITLE"),html:this.translate.instant("UPLOAD_RESTRICT_TO_FILESIZE_File.TEXT",{size:this.selectedMaxSize}),confirmButtonText:this.translate.instant("UPLOAD_RESTRICT_TO_FILESIZE_File.BUTTON"),allowOutsideClick:!1}):p().fire({type:"info",title:this.translate.instant("UPLOAD_ERROR.WRONG_TYPE_TITLE"),text:this.translate.instant("UPLOAD_ERROR.WRONG_TYPE_TEXT",{file_exts:".pdf"}),allowEscapeKey:!1,allowOutsideClick:!1,allowEnterKey:!1})}removeFile(){this.selectedFile=null,this.fileUploaderDoc.nativeElement.value=null,this.uploadDocForm.get("s3_file_name").setValue(""),this.parentData&&this.parentData.isUpdate&&this.parentData.document&&this.parentData.document.s3_file_name&&this.uploadDocForm.get("s3_file_name").setValue(this.parentData.document.s3_file_name)}uploadSubmitFlyer(){this.isWaitingForResponse=!0,this.subs.sink=this.fileUploadService.singleUpload(this.selectedFile).subscribe(a=>{this.isWaitingForResponse=!1,a?(this.uploadDocForm.get("s3_file_name").setValue(a.s3_file_name),this.submitFlyer()):p().fire({type:"info",title:this.translate.instant("SORRY"),allowOutsideClick:!1,confirmButtonText:this.translate.instant("ok")})},a=>{this.isWaitingForResponse=!1,this.authService.postErrorLog(a),a&&a.message&&a.message.includes("Network error: Http failure response for")?p().fire({type:"warning",title:this.translate.instant("BAD_CONNECTION.Title"),html:this.translate.instant("BAD_CONNECTION.Text"),confirmButtonText:this.translate.instant("BAD_CONNECTION.Button"),allowOutsideClick:!1,allowEnterKey:!1,allowEscapeKey:!1}):p().fire({type:"info",title:this.translate.instant("SORRY"),text:a&&a.message?this.translate.instant(a.message.replaceAll("GraphQL error: ","")):a,confirmButtonText:this.translate.instant("OK")})})}submitFlyer(){this.isWaitingForResponse=!0,this.financeService.updateProgramAdmissionFlyer(this.parentData._id,this.uploadDocForm.value).subscribe(a=>{this.isWaitingForResponse=!1,a&&p().fire({type:"success",title:this.translate.instant("Bravo!"),confirmButtonText:this.translate.instant("OK"),allowEnterKey:!1,allowEscapeKey:!1,allowOutsideClick:!1}).then(()=>{this.dialogRef.close(this.uploadDocForm.value)})},a=>{this.isWaitingForResponse=!1,this.authService.postErrorLog(a),a&&a.message&&a.message.includes("Network error: Http failure response for")?p().fire({type:"warning",title:this.translate.instant("BAD_CONNECTION.Title"),html:this.translate.instant("BAD_CONNECTION.Text"),confirmButtonText:this.translate.instant("BAD_CONNECTION.Button"),allowOutsideClick:!1,allowEnterKey:!1,allowEscapeKey:!1}):p().fire({type:"info",title:this.translate.instant("SORRY"),text:a&&a.message?this.translate.instant(a.message.replaceAll("GraphQL error: ","")):a,confirmButtonText:this.translate.instant("OK")})})}isUploadedFileExist(){let a=!1;return(this.selectedFile||this.uploadDocForm.get("s3_file_name").value)&&(a=!0),a}isUploadedNewFile(){return this.selectedFile||!this.uploadDocForm.get("s3_file_name").value}comparison(){return JSON.stringify(this.firstForm)===JSON.stringify(this.uploadDocForm.value)||!!this.isUploadedNewFile()}ngOnDestroy(){this.subs.unsubscribe()}}return c.\u0275fac=function(a){return new(a||c)(e.\u0275\u0275directiveInject(u.so),e.\u0275\u0275directiveInject(u.WI),e.\u0275\u0275directiveInject(s.UntypedFormBuilder),e.\u0275\u0275directiveInject(t.sK),e.\u0275\u0275directiveInject(i.t),e.\u0275\u0275directiveInject(l.J),e.\u0275\u0275directiveInject(_.N),e.\u0275\u0275directiveInject(g.e))},c.\u0275cmp=e.\u0275\u0275defineComponent({type:c,selectors:[["ms-flyer-dialog"]],viewQuery:function(a,d){if(1&a&&e.\u0275\u0275viewQuery(M,5),2&a){let m;e.\u0275\u0275queryRefresh(m=e.\u0275\u0275loadQuery())&&(d.fileUploaderDoc=m.first)}},decls:27,vars:15,consts:[["cdkDrag","","cdkDragRootElement",".cdk-overlay-pane","cdkDragHandle","",1,"p-grid","p-0","dialog-border"],[1,"p-col"],["mat-dialog-title","",2,"margin-bottom","0 !important"],["mat-icon-button","","mat-dialog-close","","tabindex","-1",1,"close-icon","float-right"],["mat-dialog-content","",1,"mat-dialog-content","dialog-body",3,"formGroup"],[1,"p-grid"],[1,"p-col-12"],[1,"full-width"],["matInput","","formControlName","document_name",2,"font-size","14px !important"],["class","p-gird",4,"ngIf"],["class","loading-indicator",4,"ngIf"],["mat-dialog-actions","",1,"justify-content-end"],["mat-button","","mat-raised-button","","color","warn",3,"click"],["mat-button","","mat-raised-button","","color","primary",3,"disabled","click",4,"ngIf"],["type","file","accept",".pdf",1,"hidden",3,"change"],["fileUploadDoc",""],[1,"p-gird"],[1,"uploaded-file-wrapper"],[1,"icon"],["class","uploaded-file-wrapper mt-1rem",4,"ngIf"],[1,"uploaded-file-wrapper","mt-1rem"],["mat-button","","mat-raised-button","","color","primary",3,"click"],[1,"loading-indicator"],["color","accent",3,"diameter"],["mat-button","","mat-raised-button","","color","primary",3,"disabled","click"]],template:function(a,d){if(1&a&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1)(2,"h1",2),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275pipe(5,"translate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(6,"div",1)(7,"button",3)(8,"mat-icon"),e.\u0275\u0275text(9,"close"),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(10,"div",4)(11,"div",5)(12,"div",6)(13,"mat-form-field",7)(14,"mat-label"),e.\u0275\u0275text(15),e.\u0275\u0275pipe(16,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(17,"input",8),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(18,x,8,2,"div",9),e.\u0275\u0275template(19,F,2,1,"div",10),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(20,"div",11)(21,"button",12),e.\u0275\u0275listener("click",function(){return d.closeDialog()}),e.\u0275\u0275text(22),e.\u0275\u0275pipe(23,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(24,D,5,4,"button",13),e.\u0275\u0275elementStart(25,"input",14,15),e.\u0275\u0275listener("change",function(b){return d.addFile(b)}),e.\u0275\u0275elementEnd()()),2&a){let m;e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",null!=d.parentData&&null!=d.parentData.admission_flyer&&d.parentData.admission_flyer.s3_file_name?e.\u0275\u0275pipeBind1(4,7,"ADMISSION.TABLE_ADMISSION_CHANNEL.Edit Flyer"):e.\u0275\u0275pipeBind1(5,9,"ADMISSION.TABLE_ADMISSION_CHANNEL.Add Flyer")," "),e.\u0275\u0275advance(7),e.\u0275\u0275property("formGroup",d.uploadDocForm),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(16,11,"ACAD_KIT.DOC.Name of File")),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",null==d.uploadDocForm||null==(m=d.uploadDocForm.get("s3_file_name"))?null:m.value),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",d.isWaitingForResponse),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(23,13,"CANCEL")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!d.selectedFile)}},dependencies:[P.Zt,P.Bh,v.lW,E.a8,u.ZT,u.uh,u.xY,u.H8,I.Hw,A.KE,A.hX,U.Nt,O.Ou,s.DefaultValueAccessor,s.NgControlStatus,s.NgControlStatusGroup,s.FormGroupDirective,s.FormControlName,T.O5,t.X$],styles:["[_nghost-%COMP%]  .mat-dialog-content{overflow:unset!important}.doctype-input[_ngcontent-%COMP%]{width:90%}.uploaded-file-wrapper[_ngcontent-%COMP%]{display:block}.icon[_ngcontent-%COMP%]{vertical-align:middle}.no-padding[_ngcontent-%COMP%]{padding-top:0!important}h1[_ngcontent-%COMP%]{color:#000;margin-left:6px;margin-bottom:10px!important}.dialog-body[_ngcontent-%COMP%]{font-size:14px!important}.mat-select[_ngcontent-%COMP%]{margin-bottom:-7px}.disabled-text[_ngcontent-%COMP%]{color:#9e9e9ecf;font-weight:100}.dialog-border[_ngcontent-%COMP%]{border-bottom:1px solid black;margin-bottom:20px}"]}),c})()},97679:(L,y,r)=>{r.d(y,{l:()=>o});var s=r(13125),u=r(24850),h=r(94650),f=r(80529),p=r(18497);let o=(()=>{class n{constructor(t,i){this.httpClient=t,this.apollo=i}getAdmissionChannels(){return this.httpClient.get("assets/data/admission-channels.json")}getScholarPeriod(){return this.httpClient.get("assets/data/scholar-period.json")}getSchools(){return this.httpClient.get("assets/data/schools.json")}getCampus(){return this.httpClient.get("assets/data/campus-tab.json")}getSpeciality(){return this.httpClient.get("assets/data/speciality.json")}getLegalEntities(){return this.httpClient.get("assets/data/legal-entities.json")}getPaymentModes(){return this.httpClient.get("assets/data/payment-modes.json")}getScholarshipFees(){return this.httpClient.get("assets/data/scholarship-fees.json")}getAffectedTermsBillingForAskingPayment(t,i,l,_){return this.apollo.mutate({mutation:s.ZP`
          mutation GetAffectedTermsBillingForAskingPayment($amount: Float, $billing_id: ID, $payment_method: EnumPaymentMethod, $is_from_asking_payment_sepa: Boolean) {
            GetAffectedTermsBilling(amount: $amount, billing_id: $billing_id, payment_method: $payment_method, is_from_asking_payment_sepa: $is_from_asking_payment_sepa) {
              _id
              term_id
              term_index
              term_payment {
                date
                time
              }
              term_payment_deferment {
                date
                time
              }
              is_term_pending
              is_term_paid
              term_amount
              term_pay_amount
              term_pay_date {
                date
                time
              }
              is_partial
              term_status
              term_amount_not_authorised
              term_amount_pending
              term_amount_chargeback
              payment_source
              term_source
              payment_type
              amount
              pay_amount
              status
              is_regulation
            }
          }
        `,variables:{amount:t,billing_id:i,payment_method:l||null,is_from_asking_payment_sepa:_},context:{useMultipart:!0}}).pipe((0,u.U)(g=>g.data.GetAffectedTermsBilling))}getPaymentMethodAdyen(t){return this.apollo.watchQuery({query:s.ZP`
          query GetAllAvailPaymentMethods($filter: FilterPaymentMethodInput!) {
            GetAllAvailPaymentMethods(filter: $filter) {
              brands
              details {
                key
                type
              }
              name
              type
            }
          }
        `,fetchPolicy:"network-only",variables:{filter:t}}).valueChanges.pipe((0,u.U)(i=>i.data.GetAllAvailPaymentMethods))}getAllCountryCodes(){return this.apollo.watchQuery({query:s.ZP`
          query GetAllCountryCodes {
            GetAllCountryCodes {
              _id
              country
              country_code
              currency
              currency_code
            }
          }
        `,fetchPolicy:"network-only"}).valueChanges.pipe((0,u.U)(t=>t.data.GetAllCountryCodes))}getAllTypeOfInformation(t,i){return this.apollo.watchQuery({query:s.ZP`
          query GetAllTypeOfInformation($pagination: PaginationInput, $filter: TypeOfInformationFilterInput) {
            GetAllTypeOfInformation(pagination: $pagination, filter: $filter) {
              _id
              type_of_information
              type_of_formation
              description
              count_document
              sigle
              admission_form_id {
                _id
                form_builder_name
              }
              document_builder_id {
                _id
                document_builder_name
              }
              form_builder_id {
                _id
                form_builder_name
              }
            }
          }
        `,fetchPolicy:"network-only",variables:{pagination:t,filter:i}}).valueChanges.pipe((0,u.U)(l=>l.data.GetAllTypeOfInformation))}getAllTypeOfInformationDropdown(){return this.apollo.watchQuery({query:s.ZP`
          query GetAllTypeOfInformation {
            GetAllTypeOfInformation {
              _id
              type_of_information
              type_of_formation
              description
              sigle
            }
          }
        `,fetchPolicy:"network-only"}).valueChanges.pipe((0,u.U)(t=>t.data.GetAllTypeOfInformation))}getAllTypeOfInformationByScholar(t){return this.apollo.watchQuery({query:s.ZP`
          query GetAllTypeOfInformation {
            GetAllTypeOfInformation {
              _id
              type_of_information
              type_of_formation
              description
            }
          }
        `,fetchPolicy:"network-only"}).valueChanges.pipe((0,u.U)(i=>i.data.GetAllTypeOfInformation))}createTypeOfInformation(t){return this.apollo.mutate({mutation:s.ZP`
          mutation CreateTypeOfInformation($type_of_information_input: TypeOfInformationInput) {
            CreateTypeOfInformation(type_of_information_input: $type_of_information_input) {
              _id
            }
          }
        `,variables:{type_of_information_input:t}}).pipe((0,u.U)(i=>i.data.CreateTypeOfInformation))}updateTypeOfInformation(t,i){return this.apollo.mutate({mutation:s.ZP`
          mutation UpdateTypeOfInformation($_id: ID!, $type_of_information_input: TypeOfInformationInput) {
            UpdateTypeOfInformation(_id: $_id, type_of_information_input: $type_of_information_input) {
              _id
            }
          }
        `,variables:{_id:t,type_of_information_input:i}}).pipe((0,u.U)(l=>l.data.UpdateTypeOfInformation))}deleteTypeOfInformation(t){return this.apollo.mutate({mutation:s.ZP`
          mutation DeleteTypeOfInformation($_id: ID!) {
            DeleteTypeOfInformation(_id: $_id) {
              _id
            }
          }
        `,variables:{_id:t}}).pipe((0,u.U)(i=>i.data.DeleteTypeOfInformation))}addInducedHoursCoefficient(t,i){return this.apollo.mutate({mutation:s.ZP`
        mutation UpdatePrograms($_id: [ID], $induced_hours: Float) {
          UpdatePrograms(program_ids: $_id, program_input: { induced_hours_coefficient: $induced_hours })
        }
      `,variables:{_id:t,induced_hours:i}})}addPaidLeaveAllowance(t,i){return this.apollo.mutate({mutation:s.ZP`
        mutation UpdatePrograms($_id: [ID], $paid_leave_allowance_rate: Float) {
          UpdatePrograms(program_ids: $_id, program_input: { paid_leave_allowance_rate: $paid_leave_allowance_rate })
        }
      `,variables:{_id:t,paid_leave_allowance_rate:i}})}}return n.\u0275fac=function(t){return new(t||n)(h.\u0275\u0275inject(f.eN),h.\u0275\u0275inject(p._M))},n.\u0275prov=h.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac,providedIn:"root"}),n})()},34318:(L,y,r)=>{function h(e){return e&&e.value&&"string"==typeof e.value&&!e.value.replace(/\s/g,"").length&&e.setValue(""),null}function n(e){const t=e&&e.value&&"string"==typeof e.value&&!e.value.replace(/\s/g,"").length;return t&&e.setValue(""),t?{whitespace:!0}:null}r.d(y,{I8:()=>h,Zx:()=>n})},9962:(L,y,r)=>{r.d(y,{J:()=>h});var s=r(94650),u=r(89383);let h=(()=>{class f{constructor(o){this.translate=o}createAndUpdateSpreadsheet(o,n,e){const t={spreadsheetId:"",range:"",valueInputOption:"USER_ENTERED"};gapi.auth2.getAuthInstance().signIn(),gapi.client.sheets.spreadsheets.create({properties:{title:n},fields:"spreadsheetId"}).then(i=>{t.spreadsheetId=i.result.spreadsheetId;const l={spreadsheetId:e.spreadsheetId,sheetId:e.sheetId},_={destinationSpreadsheetId:i.result.spreadsheetId};console.log("dest & origin sheet : ",_,l),gapi.client.sheets.spreadsheets.sheets.copyTo(l,_).then(function(g){t.range=g.result.title+"!"+e.range,gapi.client.sheets.spreadsheets.values.update(t,o).then(function(){gapi.client.sheets.spreadsheets.batchUpdate({spreadsheetId:t.spreadsheetId},{requests:[{deleteSheet:{sheetId:0}}]}).then(function(){window.open("https://docs.google.com/spreadsheets/d/"+t.spreadsheetId)},function(I){console.error("error: "+I.result.error.message)})},function(v){console.error("error: "+v.result.error.message)})},function(g){console.error("error: "+g.result.error.message)})})}executeSurveySheetOneTimes(o,n,e){const t={spreadsheetId:"",range:"",valueInputOption:"RAW"};gapi.auth2.getAuthInstance().signIn(),gapi.client.sheets.spreadsheets.create({properties:{title:n},fields:"spreadsheetId"}).then(i=>{t.spreadsheetId=i.result.spreadsheetId,gapi.client.sheets.spreadsheets.sheets.copyTo({spreadsheetId:e.spreadsheetId,sheetId:e.sheetId},{destinationSpreadsheetId:i.result.spreadsheetId}).then(function(g){t.range=g.result.title+"!"+e.range,gapi.client.sheets.spreadsheets.values.update(t,o).then(function(v){gapi.client.sheets.spreadsheets.batchUpdate({spreadsheetId:t.spreadsheetId},{requests:[{deleteSheet:{sheetId:0}}]}).then(function(A){window.open("https://docs.google.com/spreadsheets/d/"+t.spreadsheetId)},function(A){console.error("error: "+A.result.error.message)})},function(v){console.error("error: "+v.result.error.message)})},function(g){console.error("error: "+g.result.error.message)})})}executeSurveySheetContinues(o,n,e,t){const l={spreadsheetId:"",range:"",valueInputOption:"RAW"};gapi.auth2.getAuthInstance().signIn(),gapi.client.sheets.spreadsheets.create({properties:{title:n},fields:"spreadsheetId"}).then(_=>{console.log("create",_),l.spreadsheetId=_.result.spreadsheetId;const v={spreadsheetId:l.spreadsheetId},E={spreadsheetId:l.spreadsheetId};gapi.client.sheets.spreadsheets.sheets.copyTo({spreadsheetId:e.spreadsheetId,sheetId:e.sheetId},{destinationSpreadsheetId:_.result.spreadsheetId}).then(function(I){gapi.client.sheets.spreadsheets.batchUpdate(E,{requests:[{deleteSheet:{sheetId:0}}]}).then(function(U){gapi.client.sheets.spreadsheets.get(v).then(function(O){console.log(O);let T=I.result.title;l.range=T+"!"+e.range;let M={values:o.values[0]};O&&O.result&&O.result.sheets&&O.result.sheets.length&&gapi.client.sheets.spreadsheets.batchUpdate(E,{requests:[{updateSheetProperties:{properties:{title:t+""+o.values.length+0,sheetId:O.result.sheets[0].properties.sheetId},fields:"title"}}]}).then(function(x){o.values&&o.values.length>1?o.values.forEach((F,D)=>{0!==D?gapi.client.sheets.spreadsheets.batchUpdate(E,{requests:[{addSheet:{properties:{title:t+""+o.values.length+D,sheetId:1e7+D}}}]}).then(function(c){gapi.client.sheets.spreadsheets.batchUpdate(E,{requests:[{copyPaste:{destination:{sheetId:1e7+D},source:{sheetId:O.result.sheets[0].properties.sheetId}}}]}).then(function(a){M={values:F},T=t+""+o.values.length+D,l.range=T+"!"+e.range,gapi.client.sheets.spreadsheets.values.update(l,M).then(function(d){D===o.values.length-1&&window.open("https://docs.google.com/spreadsheets/d/"+l.spreadsheetId)},function(d){console.error("error: "+d.result.error.message)})},function(a){console.error("error: "+a.result.error.message)})},function(c){console.error("error: "+c.result.error.message)}):(M={values:F},T=t+""+o.values.length+D,l.range=T+"!"+e.range,gapi.client.sheets.spreadsheets.values.update(l,M).then(function(S){1===o.values.length&&window.open("https://docs.google.com/spreadsheets/d/"+l.spreadsheetId)},function(S){console.error("error: "+S.result.error.message)}))}):(M={values:o.values[0]},T=t+""+o.values.length+0,l.range=T+"!"+e.range,gapi.client.sheets.spreadsheets.values.update(l,M).then(function(F){window.open("https://docs.google.com/spreadsheets/d/"+l.spreadsheetId)},function(F){console.error("error: "+F.result.error.message)}))},function(x){console.error("error: "+x.result.error.message)})})},function(U){console.error("error: "+U.result.error.message)})},function(I){console.error("error: "+I.result.error.message)})})}}return f.\u0275fac=function(o){return new(o||f)(s.\u0275\u0275inject(u.sK))},f.\u0275prov=s.\u0275\u0275defineInjectable({token:f,factory:f.\u0275fac,providedIn:"root"}),f})()},83515:(L,y,r)=>{r.d(y,{w:()=>f});var s=r(15439),h=r(94650);let f=(()=>{class p{transform(n,e){return n?s(n,"HH:mm").add(-s().utcOffset(),"m").format("HH:mm"):""}transformDate(n,e){return n?s(n+e,"DD/MM/YYYYHH:mm").add(-s().utcOffset(),"m").format("DD/MM/YYYY"):""}transformDateTime(n,e){return n?s(n+e,"DD/MM/YYYYHH:mm").add(-s().utcOffset(),"m").format("DD/MM/YYYYHH:mm"):""}transformJavascriptDate(n){if(n){const e=s(n).format("DD/MM/YYYY"),t=s(n).format("HH:mm"),i=s(e+t,"DD/MM/YYYYHH:mm").add(-s().utcOffset(),"m");return{date:i.format("DD/MM/YYYY"),time:i.format("HH:mm")}}return""}}return p.\u0275fac=function(n){return new(n||p)},p.\u0275pipe=h.\u0275\u0275definePipe({name:"parseLocalToUtc",type:p,pure:!0}),p})()},62416:(L,y,r)=>{r.d(y,{t:()=>f});var s=r(15439),h=r(94650);let f=(()=>{class p{transform(n,e){return n?s(n,"HH:mm").subtract(-s().utcOffset(),"m").format("HH:mm"):""}transformAMPM(n,e){return n?s(n,"HH:mm").subtract(-s().utcOffset(),"m").format("HH:mm"):""}transformDate(n,e){if(n&&e)return s(n+e,"DD/MM/YYYYHH:mm").subtract(-s().utcOffset(),"m").format("DD/MM/YYYY")}transformDateInDateFormat(n,e){if(n&&e)return s(n+e,"DD/MM/YYYYHH:mm").subtract(-s().utcOffset(),"m")}fixDateFormat(n){if(n&&n.includes("-")){const e=n.split("-");n=`${e[2]}/${e[1]}/${e[0]}`}return n}fixDateFormatUtc(n){if(n&&n.includes("-")){const e=n.split("-");n=`${e[2].split("T")[0]}/${e[1]}/${e[0]}`}return n}fixTimeFormat(n){return n&&!n.includes(":")&&(n="00:00"),n}transformDateToJavascriptDate(n,e){if(n=this.fixDateFormat(n),e=this.fixTimeFormat(e),n&&e)return s(n+e,"DD/MM/YYYYHH:mm").subtract(-s().utcOffset(),"m").toDate()}transformDateToStringFormat(n,e){if(n&&e)return s(n+e,"DD/MM/YYYYHH:mm").subtract(-s().utcOffset(),"m").format("MMM DD, YYYY")}}return p.\u0275fac=function(n){return new(n||p)},p.\u0275pipe=h.\u0275\u0275definePipe({name:"parseUtcToLocal",type:p,pure:!0}),p})()}}]);