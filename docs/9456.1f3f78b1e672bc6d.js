"use strict";(self.webpackChunkGene=self.webpackChunkGene||[]).push([[9456],{49456:(ut,B,c)=>{c.d(B,{y:()=>gt});var t=c(94650),b=c(65938),M=c(9749),g=c(24006),I=c(35226),_=c.n(I),E=c(29521),y=c(80013),A=c(68745),O=c(34318),C=c(17489),P=c(89383),w=c(52688),U=c(87746),L=c(91013),k=c(80484),R=c(84075),T=c(73555),x=c(47957),F=c(3238),N=c(4859),v=c(77331),V=c(97392),D=c(59549),K=c(284),W=c(51572),j=c(10266),S=c(36895),G=c(37204);const H=["languagesInput"],Q=["recipientCc"],$=["recipientBcc"],z=["auto"],J=["myInput"];function Y(l,p){if(1&l){const e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"mat-icon",27),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(e);const n=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(n.sendMail())}),t.\u0275\u0275pipe(1,"translate"),t.\u0275\u0275text(2,"send"),t.\u0275\u0275elementEnd()}2&l&&t.\u0275\u0275propertyInterpolate("matTooltip",t.\u0275\u0275pipeBind1(1,1,"MailBox.SEND"))}function X(l,p){1&l&&(t.\u0275\u0275elementStart(0,"mat-icon",28),t.\u0275\u0275pipe(1,"translate"),t.\u0275\u0275text(2,"send"),t.\u0275\u0275elementEnd()),2&l&&t.\u0275\u0275propertyInterpolate("matTooltip",t.\u0275\u0275pipeBind1(1,1,"MailBox.SEND"))}function Z(l,p){1&l&&(t.\u0275\u0275elementStart(0,"mat-icon",31),t.\u0275\u0275text(1,"cancel"),t.\u0275\u0275elementEnd())}function q(l,p){if(1&l){const e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"mat-chip",29),t.\u0275\u0275listener("removed",function(){const a=t.\u0275\u0275restoreView(e).$implicit,r=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(r.removeTo(a))}),t.\u0275\u0275text(1),t.\u0275\u0275template(2,Z,2,0,"mat-icon",30),t.\u0275\u0275elementEnd()}if(2&l){const e=p.$implicit,i=t.\u0275\u0275nextContext();t.\u0275\u0275property("selectable",i.selectable)("removable",i.removable),t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1(" ",e," "),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",i.removable)}}function tt(l,p){if(1&l&&(t.\u0275\u0275elementStart(0,"mat-option",32),t.\u0275\u0275text(1),t.\u0275\u0275elementEnd()),2&l){const e=p.$implicit;t.\u0275\u0275property("matTooltip",e)("value",e),t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1(" ",e," ")}}function et(l,p){1&l&&(t.\u0275\u0275elementStart(0,"mat-error"),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275elementEnd()),2&l&&(t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(2,1,"This field is required")))}function it(l,p){1&l&&(t.\u0275\u0275elementStart(0,"mat-icon",31),t.\u0275\u0275text(1,"cancel"),t.\u0275\u0275elementEnd())}function nt(l,p){if(1&l){const e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"mat-chip",29),t.\u0275\u0275listener("removed",function(){const a=t.\u0275\u0275restoreView(e).$implicit,r=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(r.removeCc(a))}),t.\u0275\u0275text(1),t.\u0275\u0275template(2,it,2,0,"mat-icon",30),t.\u0275\u0275elementEnd()}if(2&l){const e=p.$implicit,i=t.\u0275\u0275nextContext(2);t.\u0275\u0275property("selectable",i.selectable)("removable",i.removable),t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1(" ",e," "),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",i.removable)}}function at(l,p){if(1&l&&(t.\u0275\u0275elementStart(0,"mat-option",32),t.\u0275\u0275text(1),t.\u0275\u0275elementEnd()),2&l){const e=p.$implicit;t.\u0275\u0275property("matTooltip",e)("value",e),t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1(" ",e," ")}}function st(l,p){1&l&&(t.\u0275\u0275elementStart(0,"mat-error"),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275elementEnd()),2&l&&(t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(2,1,"This field is required")))}function ot(l,p){if(1&l){const e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"mat-form-field",12)(1,"mat-chip-list",null,33),t.\u0275\u0275template(3,nt,3,4,"mat-chip",14),t.\u0275\u0275elementStart(4,"input",34,35),t.\u0275\u0275listener("matChipInputTokenEnd",function(n){t.\u0275\u0275restoreView(e);const a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.addCc(n))}),t.\u0275\u0275pipe(6,"translate"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(7,"mat-autocomplete",17,18),t.\u0275\u0275listener("optionSelected",function(n){t.\u0275\u0275restoreView(e);const a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.setSelectedEmailCc(n))}),t.\u0275\u0275template(9,at,2,3,"mat-option",19),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(10,st,3,3,"mat-error",20),t.\u0275\u0275elementEnd()}if(2&l){const e=t.\u0275\u0275reference(2),i=t.\u0275\u0275reference(8),n=t.\u0275\u0275nextContext();t.\u0275\u0275advance(3),t.\u0275\u0275property("ngForOf",n.selectedEmailCc),t.\u0275\u0275advance(1),t.\u0275\u0275propertyInterpolate1("placeholder"," ",t.\u0275\u0275pipeBind1(6,8,"MailBox.composeMail.cc"),""),t.\u0275\u0275property("matAutocomplete",i)("matChipInputFor",e)("matChipInputSeparatorKeyCodes",n.separatorKeysCodesCc)("matChipInputAddOnBlur",n.addOnBlurCc),t.\u0275\u0275advance(5),t.\u0275\u0275property("ngForOf",n.emailAddressesListCc),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",n.sendEmailForm.get("cc").hasError("required")&&(n.sendEmailForm.get("cc").dirty||n.sendEmailForm.get("cc").touched))}}function lt(l,p){1&l&&(t.\u0275\u0275elementStart(0,"mat-icon",31),t.\u0275\u0275text(1,"cancel"),t.\u0275\u0275elementEnd())}function rt(l,p){if(1&l){const e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"mat-chip",29),t.\u0275\u0275listener("removed",function(){const a=t.\u0275\u0275restoreView(e).$implicit,r=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(r.removeBcc(a))}),t.\u0275\u0275text(1),t.\u0275\u0275template(2,lt,2,0,"mat-icon",30),t.\u0275\u0275elementEnd()}if(2&l){const e=p.$implicit,i=t.\u0275\u0275nextContext(2);t.\u0275\u0275property("selectable",i.selectable)("removable",i.removable),t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1(" ",e," "),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",i.removable)}}function ct(l,p){if(1&l&&(t.\u0275\u0275elementStart(0,"mat-option",32),t.\u0275\u0275text(1),t.\u0275\u0275elementEnd()),2&l){const e=p.$implicit;t.\u0275\u0275property("matTooltip",e)("value",e),t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1(" ",e," ")}}function mt(l,p){1&l&&(t.\u0275\u0275elementStart(0,"mat-error"),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275elementEnd()),2&l&&(t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(2,1,"This field is required")))}function pt(l,p){if(1&l){const e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"mat-form-field",12)(1,"mat-chip-list",null,36),t.\u0275\u0275template(3,rt,3,4,"mat-chip",14),t.\u0275\u0275elementStart(4,"input",37,38),t.\u0275\u0275listener("matChipInputTokenEnd",function(n){t.\u0275\u0275restoreView(e);const a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.addBcc(n))}),t.\u0275\u0275pipe(6,"translate"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(7,"mat-autocomplete",17,18),t.\u0275\u0275listener("optionSelected",function(n){t.\u0275\u0275restoreView(e);const a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.setSelectedEmailBcc(n))}),t.\u0275\u0275template(9,ct,2,3,"mat-option",19),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(10,mt,3,3,"mat-error",20),t.\u0275\u0275elementEnd()}if(2&l){const e=t.\u0275\u0275reference(2),i=t.\u0275\u0275reference(8),n=t.\u0275\u0275nextContext();t.\u0275\u0275advance(3),t.\u0275\u0275property("ngForOf",n.selectedEmailBcc),t.\u0275\u0275advance(1),t.\u0275\u0275propertyInterpolate1("placeholder"," ",t.\u0275\u0275pipeBind1(6,8,"MailBox.composeMail.bcc"),""),t.\u0275\u0275property("matAutocomplete",i)("matChipInputFor",e)("matChipInputSeparatorKeyCodes",n.separatorKeysCodesBcc)("matChipInputAddOnBlur",n.addOnBlurBcc),t.\u0275\u0275advance(5),t.\u0275\u0275property("ngForOf",n.emailAddressesListBcc),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",n.sendEmailForm.get("bcc").hasError("required")&&(n.sendEmailForm.get("bcc").dirty||n.sendEmailForm.get("bcc").touched))}}function dt(l,p){1&l&&(t.\u0275\u0275elementStart(0,"mat-error"),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275elementEnd()),2&l&&(t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(2,1,"This field is required")))}function ht(l,p){if(1&l){const e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",39)(1,"button",40)(2,"mat-icon"),t.\u0275\u0275text(3,"insert_drive_file"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(4,"label"),t.\u0275\u0275text(5),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(6,"button",41),t.\u0275\u0275listener("click",function(){const a=t.\u0275\u0275restoreView(e).$implicit,r=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(r.removeAttachment(a))}),t.\u0275\u0275elementStart(7,"mat-icon"),t.\u0275\u0275text(8," close "),t.\u0275\u0275elementEnd()()()}if(2&l){const e=p.$implicit;t.\u0275\u0275advance(5),t.\u0275\u0275textInterpolate(e.name)}}function _t(l,p){1&l&&(t.\u0275\u0275elementStart(0,"div",42),t.\u0275\u0275element(1,"mat-spinner",43),t.\u0275\u0275elementEnd()),2&l&&(t.\u0275\u0275advance(1),t.\u0275\u0275property("diameter",100))}var f=(()=>{return(l=f||(f={})).LABEL="LABEL",l.VALUE="VALUE",l.OBJECT="OBJECT",f;var l})();let gt=(()=>{class l{constructor(e,i,n,a,r,h,d,m,s){this.data=e,this.translate=i,this.userService=n,this.usersService=a,this.mailboxService=r,this.fileUploadService=h,this.dialogref=d,this.fb=m,this.utilService=s,this.subs=new A.Y,this.Editor=M,this.showCC=!1,this.showBCC=!1,this.config={},this.selectedEmailTo=[],this.selectedEmailCc=[],this.selectedEmailBcc=[],this.selectedRecepientsList=[],this.ccselectedRecepientsList=[],this.bccselectedRecepientsList=[],this.recpList=[],this.recpListCc=[],this.recpListBcc=[],this.emailAddressesListTo=[],this.emailAddressesListCc=[],this.emailAddressesListBcc=[],this.visible=!0,this.selectable=!0,this.removable=!0,this.addOnBlur=!0,this.addOnBlurCc=!0,this.addOnBlurBcc=!0,this.showCCInput=!1,this.showBCCInput=!1,this.allowOther=!1,this.returnType=f.LABEL,this.optionSelected=new t.EventEmitter,this.separatorKeysCodes=[E.K5,E.OC],this.separatorKeysCodesCc=[E.K5,E.OC],this.separatorKeysCodesBcc=[E.K5,E.OC],this.attachmnetsPaths=[],this.isGroupEmail=!1,this.isUserOperator=!1,this.isUserAcadir=!1,this.schoolId=[],this.titleId=[],this.isWaitingForResponse=!1,this.sendEmailForm=this.fb.group({to:["",[g.Validators.required,O.I8]],cc:["",[g.Validators.required,O.I8]],bcc:["",[g.Validators.required,O.I8]],subject:["",[g.Validators.required,O.I8]],message:["",g.Validators.required]})}ngOnInit(){if(this.isPermission=this.userService.getPermission(),this.currentUser=this.userService.getLocalStorageUser(),this.getRecipientsData(),this.data&&this.data.sendToAcadir){const e=this.data.civility&&"neutral"!==this.data.civility?this.data.civility:"",i=["5a2e1ecd53b95d22c82f9554"];this.schoolId.push(this.data.school._id),this.titleId.push(this.data.rncp_title._id),this.subs.sink=this.usersService.getAllUserAcadirFromSchool(this.schoolId,this.titleId,this.classId,i).subscribe(n=>{this.responseToAcadir=n,this.getAcadirDataEmail()},n=>{this.userService.postErrorLog(n),n&&n.message&&n.message.includes("Network error: Http failure response for")?_().fire({type:"warning",title:this.translate.instant("BAD_CONNECTION.Title"),html:this.translate.instant("BAD_CONNECTION.Text"),confirmButtonText:this.translate.instant("BAD_CONNECTION.Button"),allowOutsideClick:!1,allowEnterKey:!1,allowEscapeKey:!1}):_().fire({type:"info",title:this.translate.instant("SORRY"),text:n&&n.message?this.translate.instant(n.message.replaceAll("GraphQL error: ","")):n,confirmButtonText:this.translate.instant("DISCONNECT_SCHOOL.BUTTON3")})}),this.sendEmailForm.controls.subject.patchValue([this.translate.instant("MailBox.About"),this.translate.instant(e),this.data.last_name,this.data.first_name].join(" "))}else this.getSchoolAcadirData()}getAcadirDataEmail(){if(Array.isArray(this.responseToAcadir))for(const e of this.responseToAcadir)this.preSelectedEmail=("neutral"!==e.civility?this.translate.instant(e.civility)+" ":"")+e.first_name+" "+e.last_name+" <"+e.email+">",this.selectedEmailTo.push(("neutral"!==e.civility?this.translate.instant(e.civility)+" ":"")+e.first_name+" "+e.last_name+" <"+e.email+">"),this.emailAddressesListTo.push(this.preSelectedEmail),this.validateEmail(e.email)&&this.selectedRecepientsList.push(e.email),this.recpList.push(e.email),this.sendEmailForm.get("to").setValue(null),this.getEmailMessageToAcadir();else this.preSelectedEmail=("neutral"!==this.responseToAcadir.civility?this.translate.instant(this.responseToAcadir.civility)+" ":"")+this.responseToAcadir.first_name+" "+this.responseToAcadir.last_name+" <"+this.responseToAcadir.email+">",this.selectedEmailTo.push(("neutral"!==this.responseToAcadir.civility?this.translate.instant(this.responseToAcadir.civility)+" ":"")+this.responseToAcadir.first_name+" "+this.responseToAcadir.last_name+" <"+this.responseToAcadir.email+">"),this.emailAddressesListTo.push(this.preSelectedEmail),this.validateEmail(this.responseToAcadir.email)&&this.selectedRecepientsList.push(this.responseToAcadir.email),this.recpList.push(this.responseToAcadir.email),this.sendEmailForm.get("to").setValue(null),this.getEmailMessageToAcadir()}getSchoolAcadirData(){if(Array.isArray(this.data))for(const e of this.data)this.preSelectedEmail=("neutral"!==e.civility?this.translate.instant(e.civility)+" ":"")+e.first_name+" "+e.last_name+" <"+e.email+">",this.selectedEmailTo.push(("neutral"!==e.civility?this.translate.instant(e.civility)+" ":"")+e.first_name+" "+e.last_name+" <"+e.email+">"),this.emailAddressesListTo.push(this.preSelectedEmail),this.validateEmail(e.email)&&this.selectedRecepientsList.push(e.email),this.recpList.push(e.email),this.sendEmailForm.get("to").setValue(null),this.getEmailMessage();else this.preSelectedEmail=("neutral"!==this.data.civility?this.translate.instant(this.data.civility)+" ":"")+this.data.first_name+" "+this.data.last_name+" <"+this.data.email+">",this.selectedEmailTo.push(("neutral"!==this.data.civility?this.translate.instant(this.data.civility)+" ":"")+this.data.first_name+" "+this.data.last_name+" <"+this.data.email+">"),this.emailAddressesListTo.push(this.preSelectedEmail),this.validateEmail(this.data.email)&&this.selectedRecepientsList.push(this.data.email),this.recpList.push(this.data.email),this.sendEmailForm.get("to").setValue(null),this.getEmailMessage()}getEmailMessageToAcadir(){if(Array.isArray(this.responseToAcadir)){let e="";for(const r of this.responseToAcadir)e=e+this.translate.instant("Dear")+" "+("neutral"!==r.civility?this.translate.instant(r.civility)+" ":"")+r.first_name+" "+r.last_name+", ";e+="<p></p><p></p><p></p><p></p>"+(this.currentUser.civility&&"neutral"!==this.currentUser.civility?this.translate.instant(this.currentUser.civility):"")+" "+this.currentUser.first_name+" "+this.currentUser.last_name;const i=this.currentUser.entities.filter(r=>r.type.name===this.isPermission[0]),n=C.uniqBy(i,"school.short_name");console.log("signature Data ",n,i),e+=this.currentUser?.position?",<br>"+this.currentUser?.position:"",e+=n&&n.length&&n[0].school&&n[0].school.short_name?",<br>"+n[0].school.short_name:"";const a=e;this.sendEmailForm.get("message").setValue(a)}else{let e="";e=e+this.translate.instant("Dear")+" "+("neutral"!==this.responseToAcadir.civility?this.translate.instant(this.responseToAcadir.civility)+" ":"")+this.responseToAcadir.first_name+" "+this.responseToAcadir.last_name+", ",e+="<p></p><p></p><p></p><p></p>"+("neutral"!==this.currentUser.civility?this.translate.instant(this.currentUser.civility)+" ":"")+this.currentUser.first_name+" "+this.currentUser.last_name;const i=this.currentUser.entities.filter(r=>r.type.name===this.isPermission[0]),n=C.uniqBy(i,"school.short_name");console.log("signature Data ",n,i),e+=this.currentUser?.position?",<br>"+this.currentUser?.position:"",e+=n&&n.length&&n[0].school&&n[0].school.short_name?",<br>"+n[0].school.short_name:"";const a=e;this.sendEmailForm.get("message").setValue(a)}}getEmailMessage(){if(Array.isArray(this.data)){let e="";for(const r of this.data)e=e+("neutral"!==r.civility?this.translate.instant(r.civility)+" ":"")+r.first_name+" "+r.last_name+", ";e+="<p></p><p></p><p></p><p></p>"+("neutral"!==this.currentUser.civility?this.translate.instant(this.currentUser.civility)+" ":"")+this.currentUser.first_name+" "+this.currentUser.last_name;const i=this.currentUser.entities.filter(r=>r.type.name===this.isPermission[0]),n=C.uniqBy(i,"school.short_name");console.log("signature Data ",n,i),e+=this.currentUser?.position?",<br>"+this.currentUser?.position:"",e+=n&&n.length&&n[0].school&&n[0].school.short_name?",<br>"+n[0].school.short_name:"";const a=e;this.sendEmailForm.get("message").setValue(a)}else{let e="";e=e+("neutral"!==this.data.civility?this.translate.instant(this.data.civility)+" ":"")+this.data.first_name+" "+this.data.last_name+", ",e+="<p></p><p></p><p></p><p></p>"+("neutral"!==this.currentUser.civility?this.translate.instant(this.currentUser.civility)+" ":"")+this.currentUser.first_name+" "+this.currentUser.last_name;const i=this.currentUser.entities.filter(r=>r.type.name===this.isPermission[0]),n=C.uniqBy(i,"school.short_name");console.log("signature Data ",n,i),e+=this.currentUser?.position?",<br>"+this.currentUser?.position:"",e+=n&&n.length&&n[0].school&&n[0].school.short_name?",<br>"+n[0].school.short_name:"";const a=e;this.sendEmailForm.get("message").setValue(a)}}validateEmail(e){return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)}onReady(e){e.ui.getEditableElement().parentElement.insertBefore(e.ui.view.toolbar.element,e.ui.getEditableElement())}setSelectedEmail(e,i){i.setValue(e)}closeDialog(){_().fire({title:this.translate.instant("MailBox.composeMail.DRAFT.TITLE"),html:this.translate.instant("MailBox.composeMail.DRAFT.TEXT"),type:"warning",showCancelButton:!0,confirmButtonText:this.translate.instant("MailBox.composeMail.DRAFT.CONFIRMBTN"),cancelButtonText:this.translate.instant("MailBox.composeMail.DRAFT.DECBTN")}).then(e=>{e.value?(this.saveDraft(),this.dialogref.close()):this.dialogref.close()})}saveDraft(){const e=this.sendEmailForm.value;if(""!==e.subject||""!==e.message&&void 0!==e.message){const i=[];this.mailData={};const n=this.recpList,a=this.recpListCc,r=this.recpListBcc;this.currentUser=this.userService.getLocalStorageUser();const h={sender:this.currentUser.email,is_read:!1,mail_type:"draft"};if(n){const s=n.toString().split(",");for(let o=0;o<s.length;o++)s[o]=s[o].replace(/^\s*/,"").replace(/\s*$/,""),this.validateEmail(s[o])&&i.push({recipients:[s[o]],rank:"a",is_read:!1,mail_type:"draft"})}if(a){const s=a.toString().split(",");for(let o=0;o<s.length;o++)s[o]=s[o].replace(/^\s*/,"").replace(/\s*$/,""),this.validateEmail(s[o])&&i.push({recipients:[s[o]],rank:"cc",is_read:!1,mail_type:"draft"})}if(r){const s=r.toString().split(",");for(let o=0;o<s.length;o++)s[o]=s[o].replace(/^\s*/,"").replace(/\s*$/,""),this.validateEmail(s[o])&&i.push({recipients:[s[o]],rank:"c",is_read:!1,mail_type:"draft"})}const d=[],m=[];this.attachmnetsPaths.forEach(s=>{const o={file_name:s&&s.file_name?s.file_name:s.name,path:s.path};m.push(s.name),d.push(o)}),this.mailData.sender_property=h,this.mailData.recipient_properties=i,this.mailData.subject=e.subject,this.mailData.message=e.message,this.mailData.is_sent=!1,this.mailData.status="active",this.mailData.is_urgent_mail=!1,this.mailData.attachments=m,this.mailData.file_attachments=d,this.mailData.tags=["draft"],this.isGroupEmail&&(this.mailData.is_group_parent=this.isGroupEmail,this.mailData.user_type_selection=e.user_type_selection,this.mailData.group_detail=this.computeGroupDetails()),this.mailboxService.createMail(this.mailData).subscribe(s=>{_().fire({type:"info",title:this.translate.instant("MailBox.MESSAGES.DRAFTMSG"),text:"",confirmButtonText:this.translate.instant("MailBox.MESSAGES.THANK")})},s=>{this.isWaitingForResponse=!1,this.userService.postErrorLog(s),_().fire({type:"warning",title:this.translate.instant("Sorry"),text:s&&s.message?this.translate.instant(s.message.replaceAll("GraphQL error: ","")):s,confirmButtonText:this.translate.instant("DISCONNECT_SCHOOL.BUTTON3")})})}}sendMail(){this.isWaitingForResponse=!0;const e=this.sendEmailForm.value;if(""!==e.subject||""!==e.message&&void 0!==e.message){const i=[];this.mailData={};const n=this.recpList,a=this.recpListCc,r=this.recpListBcc;this.currentUser=this.userService.getLocalStorageUser();const h={sender:this.currentUser.email,is_read:!1,mail_type:"sent"};if(n){const s=n.toString().split(",");for(let o=0;o<s.length;o++)s[o]=s[o].replace(/^\s*/,"").replace(/\s*$/,""),this.validateEmail(s[o])&&i.push({recipients:[s[o]],rank:"a",is_read:!1,mail_type:"inbox"})}if(a){const s=a.toString().split(",");for(let o=0;o<s.length;o++)s[o]=s[o].replace(/^\s*/,"").replace(/\s*$/,""),this.validateEmail(s[o])&&i.push({recipients:[s[o]],rank:"cc",is_read:!1,mail_type:"inbox"})}if(r){const s=r.toString().split(",");for(let o=0;o<s.length;o++)s[o]=s[o].replace(/^\s*/,"").replace(/\s*$/,""),this.validateEmail(s[o])&&i.push({recipients:[s[o]],rank:"c",is_read:!1,mail_type:"inbox"})}const d=[],m=[];this.attachmnetsPaths.forEach(s=>{const o={file_name:s&&s.file_name?s.file_name:s.name,path:s.path};m.push(s.name),d.push(o)}),this.mailData.sender_property=h,this.mailData.recipient_properties=i,this.mailData.subject=e.subject,this.mailData.message=e.message,this.mailData.is_sent=!0,this.mailData.status="active",this.mailData.attachments=m,this.mailData.file_attachments=d,this.mailData.tags=["sent"],this.isGroupEmail&&(this.mailData.is_group_parent=this.isGroupEmail,this.mailData.user_type_selection=e.user_type_selection,this.mailData.group_detail=this.computeGroupDetails()),this.mailboxService.createMail(this.mailData).subscribe(s=>{this.isWaitingForResponse=!1,this.dialogref.close(),_().fire({title:this.translate.instant("MailBox.composeMail.MESSAGES.TITLE"),text:this.translate.instant("MailBox.composeMail.MESSAGES.TEXT"),allowEscapeKey:!0,type:"success",confirmButtonText:this.translate.instant("MailBox.composeMail.MESSAGES.CONFIRMBTN")})},s=>{this.isWaitingForResponse=!1,this.userService.postErrorLog(s),_().fire({type:"warning",title:this.translate.instant("Sorry"),text:s&&s.message?this.translate.instant(s.message.replaceAll("GraphQL error: ","")):s,confirmButtonText:this.translate.instant("DISCONNECT_SCHOOL.BUTTON3")})})}}setSelectedEmailTo(e){const i=e.option.value,n=i.split(" ");let a="";n.forEach(u=>{a=u});const h=a.replace("<","").replace(">","");this.validateEmail(h)&&(this.selectedEmailTo.push(i),this.selectedRecepientsList.push(i));const d=i.split(" ");let m="";d.forEach(u=>{m=u});const o=m.replace("<","").replace(">","");this.recpList.push(o),this.languagesInput.nativeElement.value="",this.sendEmailForm.get("to").setValue(null),this.emitSelectedLanguagesTo()}setSelectedEmailCc(e){const i=e.option.value,n=i.split(" ");let a="";n.forEach(u=>{a=u});const h=a.replace("<","").replace(">","");this.validateEmail(h)&&(this.selectedEmailCc.push(i),this.selectedRecepientsList.push(i));const d=i.split(" ");let m="";d.forEach(u=>{m=u});const o=m.replace("<","").replace(">","");this.recpListCc.push(o),this.recipientCc.nativeElement.value="",this.sendEmailForm.get("cc").patchValue("",{emitEvent:!0}),this.emitSelectedLanguagesCc()}setSelectedEmailBcc(e){const i=e.option.value,n=i.split(" ");let a="";n.forEach(u=>{a=u});const h=a.replace("<","").replace(">","");this.validateEmail(h)&&(this.selectedEmailBcc.push(i),this.selectedRecepientsList.push(i));const d=i.split(" ");let m="";d.forEach(u=>{m=u});const o=m.replace("<","").replace(">","");this.recpListBcc.push(o),this.sendEmailForm.get("bcc").setValue(null),this.recipientBcc.nativeElement.value="",this.emitSelectedLanguagesBcc()}emitSelectedLanguagesTo(){this.optionSelected.emit(this.returnType===f.OBJECT?this.selectedEmailTo:this.selectedEmailTo.map(this.returnType===f.VALUE?e=>e.value:e=>e.label))}emitSelectedLanguagesCc(){this.optionSelected.emit(this.returnType===f.OBJECT?this.selectedEmailCc:this.selectedEmailCc.map(this.returnType===f.VALUE?e=>e.value:e=>e.label))}emitSelectedLanguagesBcc(){this.optionSelected.emit(this.returnType===f.OBJECT?this.selectedEmailBcc:this.selectedEmailBcc.map(this.returnType===f.VALUE?e=>e.value:e=>e.label))}removeTo(e){const n=C.cloneDeep(e).split(" ");let a="";n.forEach(o=>{a=o});const h=a.replace("<","").replace(">",""),d=this.selectedEmailTo.findIndex(o=>o===e),m=this.recpList.findIndex(o=>o===h),s=this.selectedRecepientsList.findIndex(o=>o===e);d>=0&&this.selectedEmailTo.splice(d,1),m>=0&&this.recpList.splice(m,1),s>=0&&this.selectedRecepientsList.splice(s,1),this.emitSelectedLanguagesTo()}removeCc(e){const n=C.cloneDeep(e).split(" ");let a="";n.forEach(o=>{a=o});const h=a.replace("<","").replace(">",""),d=this.selectedEmailCc.findIndex(o=>o===e),m=this.recpListCc.findIndex(o=>o===h),s=this.selectedRecepientsList.findIndex(o=>o===e);console.log(m,this.recpListCc,this.selectedEmailCc,e),d>=0&&this.selectedEmailCc.splice(d,1),m>=0&&this.recpListCc.splice(m,1),s>=0&&this.selectedRecepientsList.splice(s,1),this.emitSelectedLanguagesCc()}removeBcc(e){const n=C.cloneDeep(e).split(" ");let a="";n.forEach(o=>{a=o});const h=a.replace("<","").replace(">",""),d=this.selectedEmailBcc.findIndex(o=>o===e),m=this.recpListBcc.findIndex(o=>o===h),s=this.selectedRecepientsList.findIndex(o=>o===e);d>=0&&this.selectedEmailBcc.splice(d,1),m>=0&&this.recpListBcc.splice(m,1),s>=0&&this.selectedRecepientsList.splice(s,1),this.emitSelectedLanguagesBcc()}addTo(e){if(!this.matAutocomplete.isOpen){const i=e.chipInput.inputElement,n=e.value,a=n.split(" ");let r="";a.forEach(m=>{r=m});const d=r.replace("<","").replace(">","");this.validateEmail(d)&&(n||"").trim()&&this.allowOther&&this.selectedEmailTo.push({label:n.trim(),value:n.trim()}),i&&(i.value=""),this.sendEmailForm.get("to").setValue(null),this.sendEmailForm.get("to").setValue("")}this.emitSelectedLanguagesTo()}addCc(e){if(!this.matAutocomplete.isOpen){const i=e.chipInput.inputElement,n=e.value,a=n.split(" ");let r="";a.forEach(m=>{r=m});const d=r.replace("<","").replace(">","");this.validateEmail(d)&&(n||"").trim()&&this.allowOther&&this.selectedEmailCc.push({label:n.trim(),value:n.trim()}),i&&(i.value=""),this.sendEmailForm.get("cc").setValue(null),this.sendEmailForm.get("cc").setValue("")}this.emitSelectedLanguagesCc()}addBcc(e){if(!this.matAutocomplete.isOpen){const i=e.chipInput.inputElement,n=e.value,a=n.split(" ");let r="";a.forEach(m=>{r=m});const d=r.replace("<","").replace(">","");this.validateEmail(d)&&(n||"").trim()&&this.allowOther&&this.selectedEmailBcc.push({label:n.trim(),value:n.trim()}),i&&(i.value=""),this.sendEmailForm.get("bcc").setValue(null),this.sendEmailForm.get("bcc").setValue("")}this.emitSelectedLanguagesBcc()}resetValueTo(){this.sendEmailForm.get("to").patchValue("",{emitEvent:!0})}resetValueCc(){this.sendEmailForm.get("cc").patchValue("",{emitEvent:!0})}resetValueBcc(){this.sendEmailForm.get("bcc").patchValue("",{emitEvent:!0})}computeGroupDetails(){const e=this.sendEmailForm.get("rncp_titles").value.map(n=>n.id);let i=[];return this.sendEmailForm.get("user_type_selection").value&&(i=this.sendEmailForm.get("user_types").value.map(n=>n.id)),{rncp_titles:e,user_types:i}}handleInputChange(e){const i=e.target.files[0];i&&this.fileUploadService.singleUpload(i).subscribe(n=>{n&&this.attachmnetsPaths.push({path:n.file_url,name:n.file_name})},n=>{this.userService.postErrorLog(n),n&&n.message&&n.message.includes("Network error: Http failure response for")?_().fire({type:"warning",title:this.translate.instant("BAD_CONNECTION.Title"),html:this.translate.instant("BAD_CONNECTION.Text"),confirmButtonText:this.translate.instant("BAD_CONNECTION.Button"),allowOutsideClick:!1,allowEnterKey:!1,allowEscapeKey:!1}):_().fire({type:"info",title:"Error !",text:n&&n.message?this.translate.instant(n.message.replaceAll("GraphQL error: ","")):n,confirmButtonText:this.translate.instant("DISCONNECT_SCHOOL.BUTTON3")}).then(a=>{console.log("[BE Message] Error is : ",n)})}),this.resetFileState()}resetFileState(){this.currentFile.nativeElement.value=""}getRecipientsData(){this.subs.sink=this.sendEmailForm.get("to").valueChanges.pipe((0,y.b)(400)).subscribe(e=>{this.emailAddressesListTo=[],e&&e.length&&(this.isWaitingForResponse=!0,this.subs.sink=this.mailboxService.getRecipientDataUsingName(e.toString()).subscribe(i=>{this.isWaitingForResponse=!1,i&&i.length&&i.filter(a=>!this.selectedRecepientsList.includes(("neutral"!==a.civility?this.translate.instant(a.civility)+" ":"")+a.first_name+" "+a.last_name+" <"+a.email+">")).concat(this.selectedRecepientsList.filter(a=>!this.selectedRecepientsList.includes(("neutral"!==a.civility?a.civility+" ":"")+a.first_name+" "+a.last_name+" <"+a.email+">"))).forEach(a=>{void 0!==a.email&&this.emailAddressesListTo.push(("neutral"!==a.civility?this.translate.instant(a.civility):"")+" "+a.first_name+" "+a.last_name+" <"+a.email+">")})},i=>{this.isWaitingForResponse=!1,this.userService.postErrorLog(i),i&&i.message&&i.message.includes("Network error: Http failure response for")?_().fire({type:"warning",title:this.translate.instant("BAD_CONNECTION.Title"),html:this.translate.instant("BAD_CONNECTION.Text"),confirmButtonText:this.translate.instant("BAD_CONNECTION.Button"),allowOutsideClick:!1,allowEnterKey:!1,allowEscapeKey:!1}):_().fire({type:"info",title:this.translate.instant("SORRY"),text:i&&i.message?this.translate.instant(i.message.replaceAll("GraphQL error: ","")):i,confirmButtonText:this.translate.instant("DISCONNECT_SCHOOL.BUTTON3")})}))}),this.subs.sink=this.sendEmailForm.get("cc").valueChanges.pipe((0,y.b)(400)).subscribe(e=>{this.emailAddressesListCc=[],e&&e.length&&(this.isWaitingForResponse=!0,this.subs.sink=this.mailboxService.getRecipientDataUsingName(e.toString()).subscribe(i=>{this.isWaitingForResponse=!1,i&&i.length&&i.filter(a=>!this.selectedRecepientsList.includes(("neutral"!==a.civility?this.translate.instant(a.civility)+" ":"")+a.first_name+" "+a.last_name+" <"+a.email+">")).concat(this.selectedRecepientsList.filter(a=>!this.selectedRecepientsList.includes(("neutral"!==a.civility?a.civility+" ":"")+a.first_name+" "+a.last_name+" <"+a.email+">"))).forEach(a=>{void 0!==a.email&&this.emailAddressesListCc.push((""!==a.civility?this.translate.instant(a.civility):"")+" "+a.first_name+" "+a.last_name+" <"+a.email+">")})},i=>{this.isWaitingForResponse=!1,this.userService.postErrorLog(i),i&&i.message&&i.message.includes("Network error: Http failure response for")?_().fire({type:"warning",title:this.translate.instant("BAD_CONNECTION.Title"),html:this.translate.instant("BAD_CONNECTION.Text"),confirmButtonText:this.translate.instant("BAD_CONNECTION.Button"),allowOutsideClick:!1,allowEnterKey:!1,allowEscapeKey:!1}):_().fire({type:"info",title:this.translate.instant("SORRY"),text:i&&i.message?this.translate.instant(i.message.replaceAll("GraphQL error: ","")):i,confirmButtonText:this.translate.instant("DISCONNECT_SCHOOL.BUTTON3")})}))}),this.subs.sink=this.sendEmailForm.get("bcc").valueChanges.pipe((0,y.b)(400)).subscribe(e=>{this.emailAddressesListBcc=[],e&&e.length&&(this.isWaitingForResponse=!0,this.subs.sink=this.mailboxService.getRecipientDataUsingName(e.toString()).subscribe(i=>{this.isWaitingForResponse=!1,i&&i.length&&i.filter(a=>!this.selectedRecepientsList.includes(("neutral"!==a.civility?this.translate.instant(a.civility)+" ":"")+a.first_name+" "+a.last_name+" <"+a.email+">")).concat(this.selectedRecepientsList.filter(a=>!this.selectedRecepientsList.includes(("neutral"!==a.civility?a.civility+" ":"")+a.first_name+" "+a.last_name+" <"+a.email+">"))).forEach(a=>{void 0!==a.email&&this.emailAddressesListBcc.push(("neutral"!==a.civility?this.translate.instant(a.civility):"")+" "+a.first_name+" "+a.last_name+" <"+a.email+">")})},i=>{this.isWaitingForResponse=!1,this.userService.postErrorLog(i),i&&i.message&&i.message.includes("Network error: Http failure response for")?_().fire({type:"warning",title:this.translate.instant("BAD_CONNECTION.Title"),html:this.translate.instant("BAD_CONNECTION.Text"),confirmButtonText:this.translate.instant("BAD_CONNECTION.Button"),allowOutsideClick:!1,allowEnterKey:!1,allowEscapeKey:!1}):_().fire({type:"info",title:this.translate.instant("SORRY"),text:i&&i.message?this.translate.instant(i.message.replaceAll("GraphQL error: ","")):i,confirmButtonText:this.translate.instant("DISCONNECT_SCHOOL.BUTTON3")})}))})}getCurrentUser(){this.currentUser=this.userService.getLocalStorageUser(),this.isUserOperator=this.utilService.isUserEntityOPERATOR(),this.isUserAcadir=this.utilService.isUserAcadir(),this.isUserOperator?this.entityData=this.currentUser.entities.find(e=>"operator"===e.entity_name):this.isUserAcadir&&(this.entityData=this.currentUser.entities.find(e=>"Academic Director"===e.type.name))}removeAttachment(e){this.attachmnetsPaths.splice(this.attachmnetsPaths.indexOf(e),1)}validateTo(e){}ngOnDestroy(){this.subs.unsubscribe()}}return l.\u0275fac=function(e){return new(e||l)(t.\u0275\u0275directiveInject(b.WI),t.\u0275\u0275directiveInject(P.sK),t.\u0275\u0275directiveInject(w.e),t.\u0275\u0275directiveInject(U.K),t.\u0275\u0275directiveInject(L.e),t.\u0275\u0275directiveInject(k.J),t.\u0275\u0275directiveInject(b.so),t.\u0275\u0275directiveInject(g.UntypedFormBuilder),t.\u0275\u0275directiveInject(R.t))},l.\u0275cmp=t.\u0275\u0275defineComponent({type:l,selectors:[["ms-user-email-dialog"]],viewQuery:function(e,i){if(1&e&&(t.\u0275\u0275viewQuery(H,5),t.\u0275\u0275viewQuery(Q,5),t.\u0275\u0275viewQuery($,5),t.\u0275\u0275viewQuery(z,5),t.\u0275\u0275viewQuery(J,5)),2&e){let n;t.\u0275\u0275queryRefresh(n=t.\u0275\u0275loadQuery())&&(i.languagesInput=n.first),t.\u0275\u0275queryRefresh(n=t.\u0275\u0275loadQuery())&&(i.recipientCc=n.first),t.\u0275\u0275queryRefresh(n=t.\u0275\u0275loadQuery())&&(i.recipientBcc=n.first),t.\u0275\u0275queryRefresh(n=t.\u0275\u0275loadQuery())&&(i.matAutocomplete=n.first),t.\u0275\u0275queryRefresh(n=t.\u0275\u0275loadQuery())&&(i.currentFile=n.first)}},inputs:{allowOther:"allowOther",returnType:"returnType"},outputs:{optionSelected:"optionSelected"},decls:47,vars:35,consts:[[3,"formGroup"],[2,"color","black"],["mat-dialog-title","","cdkDrag","","cdkDragRootElement",".cdk-overlay-pane","cdkDragHandle",""],["svgIcon","pencil",1,"icon-style"],[2,"float","right"],[1,"icon-style",3,"matTooltip","click"],[1,"icon-style",3,"click"],[1,"icon-style",3,"matTooltip"],["type","file","name","file","multiple","","accept",".jpeg,.png,.rar,.zip,.doc,.docx,.ppt,.pdf,.xls",2,"display","none",3,"change"],["myInput",""],["class","vertical-align-mid cursorStyle",3,"matTooltip","click",4,"ngIf"],["style","color: rgb(170, 168, 168)","class","vertical-align-mid cursorStyle",3,"matTooltip",4,"ngIf"],[1,"chip-list"],["chipList",""],[3,"selectable","removable","removed",4,"ngFor","ngForOf"],["type","email","matInput","","required","","formControlName","to",3,"placeholder","matAutocomplete","matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur","matChipInputTokenEnd","change"],["languagesInput",""],[3,"optionSelected"],["auto","matAutocomplete"],[3,"matTooltip","value",4,"ngFor","ngForOf"],[4,"ngIf"],["class","chip-list",4,"ngIf"],["matInput","","formControlName","subject",3,"placeholder"],[1,"file-section","p-col-12"],["class","fileInfo",4,"ngFor","ngForOf"],["formControlName","message",3,"editor","config","ready"],["class","loading-indicator",4,"ngIf"],[1,"vertical-align-mid","cursorStyle",3,"matTooltip","click"],[1,"vertical-align-mid","cursorStyle",2,"color","rgb(170, 168, 168)",3,"matTooltip"],[3,"selectable","removable","removed"],["matChipRemove","",4,"ngIf"],["matChipRemove",""],[3,"matTooltip","value"],["chipListCc",""],["type","email","matInput","","formControlName","cc",3,"placeholder","matAutocomplete","matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur","matChipInputTokenEnd"],["recipientCc",""],["chipListBcc",""],["type","email","matInput","","formControlName","bcc",3,"placeholder","matAutocomplete","matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur","matChipInputTokenEnd"],["recipientBcc",""],[1,"fileInfo"],["mat-icon-button","","type","button"],["mat-icon-button","","type","button",3,"click"],[1,"loading-indicator"],["color","accent",3,"diameter"]],template:function(e,i){if(1&e&&(t.\u0275\u0275elementStart(0,"form",0)(1,"div",1)(2,"h1",2),t.\u0275\u0275element(3,"mat-icon",3),t.\u0275\u0275text(4),t.\u0275\u0275pipe(5,"translate"),t.\u0275\u0275elementStart(6,"div",4)(7,"mat-icon",5),t.\u0275\u0275listener("click",function(){return i.closeDialog()}),t.\u0275\u0275pipe(8,"translate"),t.\u0275\u0275text(9,"close"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(10,"label")(11,"a",6),t.\u0275\u0275listener("click",function(){return i.showCC=!i.showCC}),t.\u0275\u0275text(12,"CC"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(13,"label")(14,"a",6),t.\u0275\u0275listener("click",function(){return i.showBCC=!i.showBCC}),t.\u0275\u0275text(15),t.\u0275\u0275pipe(16,"translate"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(17,"label")(18,"mat-icon",7),t.\u0275\u0275pipe(19,"translate"),t.\u0275\u0275text(20,"attachment"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(21,"input",8,9),t.\u0275\u0275listener("change",function(a){return i.handleInputChange(a)}),t.\u0275\u0275elementEnd()(),t.\u0275\u0275template(23,Y,3,3,"mat-icon",10),t.\u0275\u0275template(24,X,3,3,"mat-icon",11),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(25,"mat-dialog-content")(26,"mat-form-field",12)(27,"mat-chip-list",null,13),t.\u0275\u0275template(29,q,3,4,"mat-chip",14),t.\u0275\u0275elementStart(30,"input",15,16),t.\u0275\u0275listener("matChipInputTokenEnd",function(a){return i.addTo(a)})("change",function(a){return i.validateTo(a)}),t.\u0275\u0275pipe(32,"translate"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(33,"mat-autocomplete",17,18),t.\u0275\u0275listener("optionSelected",function(a){return i.setSelectedEmailTo(a)}),t.\u0275\u0275template(35,tt,2,3,"mat-option",19),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(36,et,3,3,"mat-error",20),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(37,ot,11,10,"mat-form-field",21),t.\u0275\u0275template(38,pt,11,10,"mat-form-field",21),t.\u0275\u0275elementStart(39,"mat-form-field"),t.\u0275\u0275element(40,"input",22),t.\u0275\u0275pipe(41,"translate"),t.\u0275\u0275template(42,dt,3,3,"mat-error",20),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(43,"div",23),t.\u0275\u0275template(44,ht,9,1,"div",24),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(45,"ckeditor",25),t.\u0275\u0275listener("ready",function(a){return i.onReady(a)}),t.\u0275\u0275elementEnd()()()(),t.\u0275\u0275template(46,_t,2,1,"div",26)),2&e){const n=t.\u0275\u0275reference(28),a=t.\u0275\u0275reference(34);t.\u0275\u0275property("formGroup",i.sendEmailForm),t.\u0275\u0275advance(4),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(5,23,"MailBox.composeMail.title")," "),t.\u0275\u0275advance(3),t.\u0275\u0275propertyInterpolate("matTooltip",t.\u0275\u0275pipeBind1(8,25,"CLOSE")),t.\u0275\u0275advance(8),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(16,27,"MailBox.composeMail.bcc")),t.\u0275\u0275advance(3),t.\u0275\u0275propertyInterpolate("matTooltip",t.\u0275\u0275pipeBind1(19,29,"MailBox.ATTACH_FILE")),t.\u0275\u0275advance(5),t.\u0275\u0275property("ngIf",i.sendEmailForm.get("subject").value&&(i.selectedEmailTo.length||i.showBCC&&i.selectedEmailBcc.length||i.showCC&&i.selectedEmailCc.length)),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",!(i.sendEmailForm.get("subject").value&&(i.selectedEmailTo.length||i.showBCC&&i.selectedEmailBcc.length||i.showCC&&i.selectedEmailCc.length))),t.\u0275\u0275advance(5),t.\u0275\u0275property("ngForOf",i.selectedEmailTo),t.\u0275\u0275advance(1),t.\u0275\u0275propertyInterpolate1("placeholder"," ",t.\u0275\u0275pipeBind1(32,31,"MailBox.composeMail.to"),""),t.\u0275\u0275property("matAutocomplete",a)("matChipInputFor",n)("matChipInputSeparatorKeyCodes",i.separatorKeysCodes)("matChipInputAddOnBlur",i.addOnBlur),t.\u0275\u0275advance(5),t.\u0275\u0275property("ngForOf",i.emailAddressesListTo),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",i.sendEmailForm.get("to").hasError("required")&&(i.sendEmailForm.get("to").dirty||i.sendEmailForm.get("to").touched)),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",i.showCC||i.showCCInput),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",i.showBCC||i.showBCCInput),t.\u0275\u0275advance(2),t.\u0275\u0275propertyInterpolate("placeholder",t.\u0275\u0275pipeBind1(41,33,"Subject")),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",i.sendEmailForm.get("subject").hasError("required")&&(i.sendEmailForm.get("subject").dirty||i.sendEmailForm.get("subject").touched)),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngForOf",i.attachmnetsPaths),t.\u0275\u0275advance(1),t.\u0275\u0275property("editor",i.Editor)("config",i.config),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",i.isWaitingForResponse)}},dependencies:[T.Zt,T.Bh,x.XC,x.ZL,F.ey,N.lW,v.qn,v.HS,v.oH,v.qH,b.uh,b.xY,V.Hw,D.TO,D.KE,K.Nt,W.Ou,j.gM,g.\u0275NgNoValidate,g.DefaultValueAccessor,g.NgControlStatus,g.NgControlStatusGroup,g.RequiredValidator,g.FormGroupDirective,g.FormControlName,S.sg,S.O5,G.u,P.X$],styles:[".top-space[_ngcontent-%COMP%]{margin-top:30px}table[_ngcontent-%COMP%]   .mat-select-trigger[_ngcontent-%COMP%]{display:inline-table}table[_ngcontent-%COMP%]   .mat-select-value[_ngcontent-%COMP%]{display:table-cell;max-width:0}table[_ngcontent-%COMP%]   .mat-select-arrow-wrapper[_ngcontent-%COMP%]{display:table-cell;vertical-align:middle}[_nghost-%COMP%]     table:not(.no-action-header):not(.notif-table) th{font-weight:400}[_nghost-%COMP%]     table:not(.no-action-header):not(.notif-table) thead>tr:first-child{height:40px}[_nghost-%COMP%]     table:not(.no-action-header):not(.notif-table) thead>tr:nth-child(2){border-top:4px solid #607d8b}[_nghost-%COMP%]     table:not(.no-action-header):not(.notif-table) thead>tr:not(:first-child){border-left:4px solid #607d8b;border-right:4px solid #607d8b}[_nghost-%COMP%]     table:not(.no-action-header):not(.notif-table) thead>tr:nth-last-child(2){border-bottom:4px solid #607d8b}[_nghost-%COMP%]     table:not(.no-action-header):not(.notif-table) thead>tr:last-child{border-bottom:4px solid #607d8b}[_nghost-%COMP%]     table:not(.no-action-header):not(.notif-table) tbody>tr{border-left:4px solid #607d8b;border-right:4px solid #607d8b}[_nghost-%COMP%]     table:not(.no-action-header):not(.notif-table) tbody>tr:last-child{border-bottom:4px solid #607d8b}[_nghost-%COMP%]     table:not(.no-action-header):not(.notif-table) tbody tr:nth-child(odd){background-color:#607d8b}[_nghost-%COMP%]     table:not(.no-action-header):not(.notif-table) tbody tr:nth-child(odd) .mat-icon-button .mat-icon{line-height:1!important}[_nghost-%COMP%]     table:not(.no-action-header):not(.notif-table) tbody tr:nth-child(odd) .mat-icon-button{background:#353535;line-height:0!important}[_nghost-%COMP%]     table:not(.no-action-header):not(.notif-table) tbody tr:nth-child(even){background-color:#353535}[_nghost-%COMP%]     table:not(.no-action-header):not(.notif-table) tbody tr:nth-child(even) .mat-icon-button .mat-icon{line-height:1!important}[_nghost-%COMP%]     table:not(.no-action-header):not(.notif-table) tbody tr:nth-child(even) .mat-icon-button{background:#607d8b;line-height:0!important}[_nghost-%COMP%]     table.no-action-header th{font-weight:400}[_nghost-%COMP%]     table.no-action-header thead>tr:nth-child(1){border-top:4px solid #607d8b;border-left:4px solid #607d8b;border-right:4px solid #607d8b}[_nghost-%COMP%]     table.no-action-header thead>tr:not(:first-child){border-left:4px solid #607d8b;border-right:4px solid #607d8b}[_nghost-%COMP%]     table.no-action-header thead>tr:nth-last-child(2){border-bottom:4px solid #607d8b}[_nghost-%COMP%]     table.no-action-header thead>tr:last-child{border-bottom:4px solid #607d8b}[_nghost-%COMP%]     table.no-action-header tbody>tr{border-left:4px solid #607d8b;border-right:4px solid #607d8b}[_nghost-%COMP%]     table.no-action-header tbody>tr:last-child{border-bottom:4px solid #607d8b}[_nghost-%COMP%]     table.no-action-header tbody tr:nth-child(odd){background-color:#607d8b}[_nghost-%COMP%]     table.no-action-header tbody tr:nth-child(odd) .mat-icon-button .mat-icon{line-height:1!important}[_nghost-%COMP%]     table.no-action-header tbody tr:nth-child(odd) .mat-icon-button{background:#353535;line-height:0!important}[_nghost-%COMP%]     table.no-action-header tbody tr:nth-child(even){background-color:#353535}[_nghost-%COMP%]     table.no-action-header tbody tr:nth-child(even) .mat-icon-button .mat-icon{line-height:1!important}[_nghost-%COMP%]     table.no-action-header tbody tr:nth-child(even) .mat-icon-button{background:#607d8b;line-height:0!important}.horizontal[_ngcontent-%COMP%]{overflow:auto}.child-tab-font[_ngcontent-%COMP%]{font-size:.8rem}.center-spinner[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.hide[_ngcontent-%COMP%], .hidden[_ngcontent-%COMP%]{display:none!important}.header-div[_ngcontent-%COMP%]{border-bottom:1px solid black;display:flex;padding:1rem}.header-text[_ngcontent-%COMP%]{color:#000;margin-left:1rem;margin-bottom:0!important}.header-icon[_ngcontent-%COMP%]{align-self:center;margin-left:auto!important;background-color:transparent!important}.baseline-align[_ngcontent-%COMP%]{align-items:baseline}.admtc-table-button[_ngcontent-%COMP%], button.yellow-button.mat-raised-button[_ngcontent-%COMP%], button.blue-patina-button.mat-raised-button[_ngcontent-%COMP%]{min-width:7em;height:2.8em;font-size:1.2em;font-family:Roboto,Helvetica Neue,sans-serif!important}.admtc-table-button[_ngcontent-%COMP%]   .mat-icon[svgicon][_ngcontent-%COMP%], button.yellow-button.mat-raised-button[_ngcontent-%COMP%]   .mat-icon[svgicon][_ngcontent-%COMP%], button.blue-patina-button.mat-raised-button[_ngcontent-%COMP%]   .mat-icon[svgicon][_ngcontent-%COMP%]{margin-top:.5em;margin-right:.3em}.admtc-normal-button[_ngcontent-%COMP%], button.yellow-button-normal.mat-raised-button[_ngcontent-%COMP%]{min-width:7em;height:2em;font-size:1em;font-family:Roboto,Helvetica Neue,sans-serif!important}.admtc-normal-button[_ngcontent-%COMP%]   .mat-icon[svgicon][_ngcontent-%COMP%], button.yellow-button-normal.mat-raised-button[_ngcontent-%COMP%]   .mat-icon[svgicon][_ngcontent-%COMP%]{margin-top:.3em;margin-right:.2em}.background-accent[_ngcontent-%COMP%], button.yellow-button-normal.mat-raised-button[_ngcontent-%COMP%], button.yellow-button.mat-raised-button[_ngcontent-%COMP%]{background-color:#fdd835!important;color:#000000de}.background-warn[_ngcontent-%COMP%]{background-color:red!important;color:#fff}.background-success[_ngcontent-%COMP%]{background-color:#4caf50!important;color:#fff}.background-primary[_ngcontent-%COMP%]{background-color:#607d8b!important;color:#fff}.background-medium-grey[_ngcontent-%COMP%]{background-color:#424242!important;color:#fff}.background-black[_ngcontent-%COMP%]{background-color:#212121!important;color:#fff}button.blue-patina-button.mat-raised-button[_ngcontent-%COMP%]{background-color:#607d8b!important}[_nghost-%COMP%]     .mat-slide-toggle.mat-checked .mat-slide-toggle-bar .mat-slide-toggle-thumb{background-color:#fdd835}[_nghost-%COMP%]     .mat-slide-toggle.mat-checked .mat-slide-toggle-bar{background-color:#ffc10780}[_nghost-%COMP%]     .mat-form-field-appearance-outline .mat-form-field-infix{padding:.15rem}[_nghost-%COMP%]     mat-form-field.mat-form-field-should-float label{font-size:18px;font-weight:600;color:#000}.status-icon[_ngcontent-%COMP%], .red-icon[_ngcontent-%COMP%], .purple-icon[_ngcontent-%COMP%], .black-icon[_ngcontent-%COMP%], .greenyellow-icon[_ngcontent-%COMP%], .yellow-icon[_ngcontent-%COMP%], .green-icon[_ngcontent-%COMP%]{font-size:25px;width:30px}.is-loading[_ngcontent-%COMP%]   .mat-option-text[_ngcontent-%COMP%]{display:flex;justify-content:center}.display-flex[_ngcontent-%COMP%]{display:flex}.green-icon[_ngcontent-%COMP%]{color:#4caf50}.yellow-icon[_ngcontent-%COMP%]{color:#ff0}.greenyellow-icon[_ngcontent-%COMP%]{color:#adff2f}.black-icon[_ngcontent-%COMP%]{color:#000}.purple-icon[_ngcontent-%COMP%]{color:purple}.red-icon[_ngcontent-%COMP%], .red-text[_ngcontent-%COMP%]{color:red}.text-white[_ngcontent-%COMP%]{color:#fff}.greenyellow-text[_ngcontent-%COMP%]{color:#adff2f!important}.mat-sort-header-container[_ngcontent-%COMP%]{justify-content:center}.tags[_ngcontent-%COMP%]{background-color:#fdd835;color:#000;padding:3px 5px;border-radius:3px;margin-right:5px}.p-grid[_ngcontent-%COMP%]{margin-right:unset!important;margin-left:unset!important;margin-top:unset!important}.add-btn[_ngcontent-%COMP%]{background:#fdd835;width:10rem}.color[_ngcontent-%COMP%]{background:#607d8b;width:10rem}.alignment[_ngcontent-%COMP%]{text-align:right;padding-right:0}mat-form-field[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]     .ck-editor__editable_inline{min-height:50px;border:1px solid #b8b8b8;background:white;color:#000}.fontColor[_ngcontent-%COMP%]{color:#000}.yellow-border[_ngcontent-%COMP%]{border:2px solid #fdd835}.silver-border[_ngcontent-%COMP%]{border:2px solid whitesmoke}.red-border[_ngcontent-%COMP%]{border:2px solid red}.certification-rule-pop-up[_ngcontent-%COMP%]   .mat-dialog-container[_ngcontent-%COMP%]{padding:0}.one-time-pop-up[_ngcontent-%COMP%]   .mat-dialog-container[_ngcontent-%COMP%]{width:800px!important}.dark-mode-pop-up[_ngcontent-%COMP%]   .mat-dialog-container[_ngcontent-%COMP%]{color:#fff;background:#303030}.grey-mode-pop-up[_ngcontent-%COMP%]   .mat-dialog-container[_ngcontent-%COMP%]{color:#fff;background:#7c7c7c}.view-step-validation-pop-up[_ngcontent-%COMP%]   .mat-dialog-container[_ngcontent-%COMP%]{max-height:590px}.image-preview-pop-up[_ngcontent-%COMP%]   .mat-dialog-container[_ngcontent-%COMP%]{background:rgba(0,0,0,.231372549);box-shadow:none;padding:0;overflow:hidden}.pass-fail-pop-up[_ngcontent-%COMP%]   .mat-dialog-container[_ngcontent-%COMP%]{padding:0 24px 18px}.expected-doc-task[_ngcontent-%COMP%]   .mat-dialog-container[_ngcontent-%COMP%]{padding:16px!important;overflow:visible}.no-padding-pop-up[_ngcontent-%COMP%]   .mat-dialog-container[_ngcontent-%COMP%]{padding:0;overflow:visible}.questionnaire-simulation-pop-up[_ngcontent-%COMP%]   .mat-dialog-container[_ngcontent-%COMP%]{overflow:scroll;width:60vw;max-height:90vh;background-color:#607d8b;color:#fff}.reply-message-pop-up[_ngcontent-%COMP%]   .mat-dialog-container[_ngcontent-%COMP%]{padding:0;min-height:430px}.send-pro-evaluation-pop-up[_ngcontent-%COMP%]   .mat-dialog-container[_ngcontent-%COMP%]{padding:0;min-height:430px;visibility:hidden}.banner-connect-snackbar[_ngcontent-%COMP%]{padding:0!important;min-height:0!important;max-height:0!important}.editor-background-white[_ngcontent-%COMP%]{background-color:#fafafa;color:#000}.editor-background-white[_ngcontent-%COMP%]   .ck-editor__editable[_ngcontent-%COMP%]{min-height:140px!important}.small-text-fieldset[_ngcontent-%COMP%]{font-size:12px}.small-icon[_ngcontent-%COMP%]{transform:scale(.6)}.padding-0[_ngcontent-%COMP%]{padding:0!important}.mt-1rem[_ngcontent-%COMP%]{margin-top:1rem}.mr-1rem[_ngcontent-%COMP%]{margin-right:1rem}.mb-1rem[_ngcontent-%COMP%]{margin-bottom:1rem}.ellipsis-one-line[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.span-block[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content;display:block;max-width:-webkit-fill-available;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.dialog-title[_ngcontent-%COMP%]{color:#000}.icon-self-right[_ngcontent-%COMP%]{position:absolute;right:0;top:0;cursor:pointer}.dialog-body[_ngcontent-%COMP%]{color:#000}.no-padding[_ngcontent-%COMP%]{padding:0!important}.no-padding-x[_ngcontent-%COMP%]{padding-right:0!important;padding-left:0!important}.no-padding-y[_ngcontent-%COMP%]{padding-top:0!important;padding-bottom:0!important}.no-padding-r[_ngcontent-%COMP%]{padding-right:0!important}.no-padding-l[_ngcontent-%COMP%]{padding-left:0!important}.no-padding-t[_ngcontent-%COMP%]{padding-top:0!important}.no-padding-b[_ngcontent-%COMP%]{padding-bottom:0!important}.no-margin[_ngcontent-%COMP%]{margin:0}.align-center[_ngcontent-%COMP%]{text-align:center}.align-end[_ngcontent-%COMP%]{text-align:end}.one-line-text[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}[_ngcontent-%COMP%]::-webkit-scrollbar{-webkit-appearance:none;width:7px;height:8px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:4px;background-color:#00000080;box-shadow:0 0 1px #ffffff80;-webkit-box-shadow:0 0 1px rgba(255,255,255,.5)}.ckeditor-small[_ngcontent-%COMP%]   .ck-editor__editable[_ngcontent-%COMP%]{min-height:140px!important;max-height:140px!important;border:1px solid rgba(0,0,0,.5)!important}.ckeditor-medium[_ngcontent-%COMP%]   .ck-editor__editable[_ngcontent-%COMP%]{min-height:300px!important;max-height:300px!important;border:1px solid rgba(0,0,0,.5)!important}.ckeditor-big[_ngcontent-%COMP%]   .ck-editor__editable[_ngcontent-%COMP%]{min-height:500px!important;max-height:500px!important}.ckeditor-white-background[_ngcontent-%COMP%]{background-color:#fff!important;color:#000!important}.custom-dialog-container-publishable-doc[_ngcontent-%COMP%]   .mat-dialog-container[_ngcontent-%COMP%]{overflow:unset;padding:15px}.align-input-field[_ngcontent-%COMP%]{margin-bottom:9px}.hide-pagination-buttons[_ngcontent-%COMP%]   .mat-paginator-navigation-first[_ngcontent-%COMP%], .hide-pagination-buttons[_ngcontent-%COMP%]   .mat-paginator-navigation-previous[_ngcontent-%COMP%], .hide-pagination-buttons[_ngcontent-%COMP%]   .mat-paginator-navigation-next[_ngcontent-%COMP%], .hide-pagination-buttons[_ngcontent-%COMP%]   .mat-paginator-navigation-last[_ngcontent-%COMP%]{display:none!important}.clickable[_ngcontent-%COMP%]{cursor:pointer}input[type=number][_ngcontent-%COMP%]::-webkit-inner-spin-button, input[type=number][_ngcontent-%COMP%]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.flex-layout-row-wrap[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;box-sizing:border-box}.icon-style[_ngcontent-%COMP%]{vertical-align:middle;margin-right:1rem;cursor:pointer}[_nghost-%COMP%]     .mat-dialog-content{max-height:520px;height:auto}[_nghost-%COMP%]     .ck-editor__editable_inline{height:auto;color:#000}.cursorStyle[_ngcontent-%COMP%]{cursor:pointer}.fileInfo[_ngcontent-%COMP%]{width:-moz-fit-content!important;width:fit-content!important;margin:5px!important;display:inline-block!important;border:1px solid rgba(0,0,0,.1);z-index:10;box-shadow:inset 1px 1px #0000001a,inset 0 -1px #00000012}.chip-list[_ngcontent-%COMP%]{width:100%}.color-gray[_ngcontent-%COMP%]{color:#aaa8a8}.float-right[_ngcontent-%COMP%]{float:right}.hidden-input[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]  .mat-radio-outer-circle{border-color:#0000008a!important}[_nghost-%COMP%]  .mat-form-field-underline{background-color:#0000001f!important}"]}),l})()}}]);