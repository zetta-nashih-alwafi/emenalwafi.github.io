<ms-filter-breadcrumb  [filterBreadcrumbData]="filterBreadcrumbData" (removeFilterTrigger)="removeFilterBreadcrumb($event)"></ms-filter-breadcrumb>

<div class="p-grid" style="margin-bottom: 10px; font-family: firaSans !important; position: relative">
  <div class="p-col-fixed no-padding" style="width: 140px; float: left; padding-right: 15px !important">
    <div class="p-col-12 no-padding filter-input">
      <label class="float-label" *ngIf="scholarFilter?.value && scholarFilter?.value?.length !== 0">
        {{ 'CARDDETAIL.Scholar Season' | translate }}
      </label>
      <ng-select
        [items]="scholars"
        bindValue="_id"
        bindLabel="scholar_season"
        class="custom-dropdownpanel"
        [appendTo]="'body'"
        [multiple]="false"
        notFoundText="{{ 'NOT RECORD FOUND' | translate }}"
        placeholder="{{ 'CARDDETAIL.Scholar Season' | translate }}"
        [formControl]="scholarFilter"
        [clearable]="false"
        [closeOnSelect]="false"
        (close)="scholarSelect()"
      >
        <ng-template ng-option-tmp let-item="item" let-item$="item$" let-index="index">
          <input id="item-{{ index }}" type="checkbox" [ngModel]="item$.selected" />
          {{ item.scholar_season }}
        </ng-template>
      </ng-select>
    </div>
  </div>
  <div class="p-col-fixed no-padding" style="width: 140px; float: left; padding-right: 15px !important">
    <label class="float-label" *ngIf="schoolsFilter?.value && schoolsFilter?.value?.length !== 0">
      {{ 'ADMISSION.TABLE_ADMISSION_CHANNEL.School' | translate }}
    </label>
    <ng-select
      [items]="school"
      bindValue="_id"
      bindLabel="short_name"
      class="custom-dropdownpanel"
      [appendTo]="'body'"
      [multiple]="true"
      notFoundText="{{ 'NOT RECORD FOUND' | translate }}"
      placeholder="{{ 'ADMISSION.TABLE_ADMISSION_CHANNEL.School' | translate }}"
      [formControl]="schoolsFilter"
      [clearable]="false"
      [closeOnSelect]="false"
      (close)="checkSuperFilterSchool()"
    >
      <ng-template ng-option-tmp let-item="item" let-item$="item$" let-index="index">
        <input id="item-{{ index }}" type="checkbox" [ngModel]="item$.selected" /> {{ item.short_name | translate }}
      </ng-template>
      <ng-template ng-header-tmp *ngIf="school?.length">
        <mat-checkbox
          class="all-input"
          style="cursor: pointer"
          [checked]="isAllDropdownSelected('school')"
          [indeterminate]="isSomeDropdownSelected('school')"
          (change)="selectAllData($event, 'school')"
        >
          {{ 'AllM' | translate }}
        </mat-checkbox>
      </ng-template>
    </ng-select>
  </div>
  <div class="p-col-fixed no-padding" style="width: 140px; float: left; padding-right: 15px !important">
    <label class="float-label" *ngIf="campusFilter?.value && campusFilter?.value?.length !== 0">
      {{ 'ADMISSION.TABLE_ADMISSION_CHANNEL.Campus' | translate }}
    </label>
    <ng-select
      [items]="campusList"
      bindValue="_id"
      bindLabel="name"
      class="custom-dropdownpanel"
      [appendTo]="'body'"
      [multiple]="true"
      notFoundText="{{ 'NOT RECORD FOUND' | translate }}"
      placeholder="{{ 'ADMISSION.TABLE_ADMISSION_CHANNEL.Campus' | translate }}"
      [formControl]="campusFilter"
      [clearable]="false"
      [closeOnSelect]="false"
      (close)="checkSuperFilterCampus()"
    >
      <ng-template ng-option-tmp let-item="item" let-item$="item$" let-index="index">
        <input id="item-{{ index }}" type="checkbox" [ngModel]="item$.selected" /> {{ item.name }}
      </ng-template>
      <ng-template ng-header-tmp *ngIf="campusList?.length">
        <mat-checkbox
          class="all-input"
          style="cursor: pointer"
          [checked]="isAllDropdownSelected('campus')"
          [indeterminate]="isSomeDropdownSelected('campus')"
          (change)="selectAllData($event, 'campus')"
        >
          {{ 'AllF' | translate }}
        </mat-checkbox>
      </ng-template>
    </ng-select>
  </div>
  <div class="p-col-fixed no-padding" style="width: 140px; float: left; padding-right: 15px !important">
    <label class="float-label" *ngIf="levelFilter?.value && levelFilter?.value?.length !== 0">
      {{ 'ADMISSION.TABLE_ADMISSION_CHANNEL.Level' | translate }}
    </label>
    <ng-select
      [items]="levels"
      bindValue="_id"
      bindLabel="name"
      class="custom-dropdownpanel"
      [appendTo]="'body'"
      [multiple]="true"
      notFoundText="{{ 'NOT RECORD FOUND' | translate }}"
      placeholder="{{ 'ADMISSION.TABLE_ADMISSION_CHANNEL.Level' | translate }}"
      [formControl]="levelFilter"
      [clearable]="false"
      [closeOnSelect]="false"
      (close)="checkSuperFilterLevel()"
    >
      <ng-template ng-option-tmp let-item="item" let-item$="item$" let-index="index">
        <input id="item-{{ index }}" type="checkbox" [ngModel]="item$.selected" /> {{ item.name }}
      </ng-template>
      <ng-template ng-header-tmp *ngIf="levels?.length">
        <mat-checkbox
          class="all-input"
          style="cursor: pointer"
          [checked]="isAllDropdownSelected('level')"
          [indeterminate]="isSomeDropdownSelected('level')"
          (change)="selectAllData($event, 'level')"
        >
          {{ 'AllF' | translate }}
        </mat-checkbox>
      </ng-template>
    </ng-select>
  </div>
  <div class="p-col-fixed no-padding" style="width: 140px; float: left; padding-right: 15px !important">
    <label class="float-label" *ngIf="sectorFilter?.value && sectorFilter?.value?.length !== 0">
      {{ 'ADMISSION.TABLE_ADMISSION_CHANNEL.Sector' | translate }}
    </label>
    <ng-select
      [items]="sectorList"
      bindValue="_id"
      bindLabel="name"
      class="custom-dropdownpanel"
      [appendTo]="'body'"
      [multiple]="true"
      notFoundText="{{ 'NOT RECORD FOUND' | translate }}"
      placeholder="{{ 'ADMISSION.TABLE_ADMISSION_CHANNEL.Sector' | translate }}"
      [formControl]="sectorFilter"
      [clearable]="false"
      [closeOnSelect]="false"
      (close)="selectSectorFilter()"
    >
      <ng-template ng-option-tmp let-item="item" let-item$="item$" let-index="index">
        <input id="item-{{ index }}" type="checkbox" [ngModel]="item$.selected" /> {{ item.name }}
      </ng-template>
      <ng-template ng-header-tmp *ngIf="sectorList?.length">
        <mat-checkbox
          class="all-input"
          style="cursor: pointer"
          [checked]="isAllDropdownSelected('sector')"
          [indeterminate]="isSomeDropdownSelected('sector')"
          (change)="selectAllData($event, 'sector')"
        >
          {{ 'AllF' | translate }}
        </mat-checkbox>
      </ng-template>
    </ng-select>
  </div>
  <div class="p-col-fixed no-padding" style="width: 140px; float: left; padding-right: 15px !important">
    <label class="float-label" *ngIf="specialityFilter?.value && specialityFilter?.value?.length !== 0">
      {{ 'ADMISSION.TABLE_ADMISSION_CHANNEL.Speciality' | translate }}
    </label>
    <ng-select
      [items]="specialityList"
      bindValue="_id"
      bindLabel="name"
      class="custom-dropdownpanel"
      [appendTo]="'body'"
      [multiple]="true"
      notFoundText="{{ 'NOT RECORD FOUND' | translate }}"
      placeholder="{{ 'ADMISSION.TABLE_ADMISSION_CHANNEL.Speciality' | translate }}"
      [formControl]="specialityFilter"
      [clearable]="false"
      [closeOnSelect]="false"
      (close)="selectSpecialityFilter()"
    >
      <ng-template ng-option-tmp let-item="item" let-item$="item$" let-index="index">
        <input id="item-{{ index }}" type="checkbox" [ngModel]="item$.selected" /> {{ item.name }}
      </ng-template>
      <ng-template ng-header-tmp *ngIf="specialityList?.length">
        <mat-checkbox
          class="all-input"
          style="cursor: pointer"
          [checked]="isAllDropdownSelected('speciality')"
          [indeterminate]="isSomeDropdownSelected('speciality')"
          (change)="selectAllData($event, 'speciality')"
        >
          {{ 'AllF' | translate }}
        </mat-checkbox>
      </ng-template>
    </ng-select>
  </div>
  <div class="p-col-fixed no-padding super-filter">
    <label class="float-label" *ngIf="tagFilter?.value && tagFilter?.value?.length !== 0">
      {{ 'All_Students.Tag' | translate }}
    </label>
    <ng-select
      [items]="tagList"
      bindValue="_id"
      bindLabel="name"
      class="custom-dropdownpanel"
      [appendTo]="'body'"
      [multiple]="true"
      notFoundText="{{ 'NOT RECORD FOUND' | translate }}"
      placeholder="{{ 'All_Students.Tag' | translate }}"
      [formControl]="tagFilter"
      [clearable]="false"
      [closeOnSelect]="false"
      (close)="checkSuperFilterTags()"
    >
      <ng-template ng-option-tmp let-item="item" let-item$="item$" let-index="index">
        <input id="item-{{ index }}" type="checkbox" [ngModel]="item$.selected" /> {{ item.name }}
      </ng-template>
      <ng-template ng-header-tmp *ngIf="tagList?.length">
        <mat-checkbox
          class="all-input"
          style="cursor: pointer"
          [checked]="isAllDropdownSelected('tags')"
          [indeterminate]="isSomeDropdownSelected('tags')"
          (change)="selectAllData($event, 'tags')"
        >
          {{ 'AllF' | translate }}
        </mat-checkbox>
      </ng-template>
    </ng-select>
  </div>
  <div class="p-col-fixed" style="float: left; padding-right: 15px !important; margin-top: 2px !important">
    <button
      mat-button
      mat-raised-button
      color="accent"
      [disabled]="isDisabled || isLoading || isWaitingForResponse"
      (click)="applySuperFilter()"
      data-cy="button-apply-filter"
    >
      {{ 'Apply Filter' | translate }}
    </button>
  </div>
</div>

<div class="horizontal header-button header-action">
  <div class="btn-left">
    <div class="p-grid">
      <div class="text-right" [ngClass]="dataSelected?.length || (isCheckedAll && dataCount) ? 'text-count' : ''">
        <span style="font-family: 'firaSans' !important" *ngIf="dataSelected?.length || (isCheckedAll && dataCount)"
          >{{ 'Selected Data' | translate }} : {{ isCheckedAll ? dataCount - dataUnselectUser?.length : dataSelected?.length }}</span
        >
      </div>
      <div class="p-col-3 width-datepick">
        <mat-form-field class="form-field-above">
          <input
            matInput
            (click)="fromDatePick.open()"
            readonly
            class="form-field"
            [matDatepicker]="fromDatePick"
            [formControl]="fromDateFilter"
            placeholder="{{ 'From' | translate }}"
            [max]="toDateFilter.value"
            data-cy="table-date-from"
          />
          <mat-datepicker-toggle matSuffix [for]="fromDatePick"></mat-datepicker-toggle>
          <mat-datepicker #fromDatePick></mat-datepicker>
        </mat-form-field>
      </div>
      <div class="p-col-3 width-datepick">
        <mat-form-field class="form-field-above">
          <input
            matInput
            (click)="toDatePick.open()"
            readonly
            class="form-field"
            [matDatepicker]="toDatePick"
            [formControl]="toDateFilter"
            placeholder="{{ 'To' | translate }}"
            [min]="fromDateFilter.value"
            data-cy="table-date-to"
          />
          <mat-datepicker-toggle matSuffix [for]="toDatePick"></mat-datepicker-toggle>
          <mat-datepicker #toDatePick></mat-datepicker>
        </mat-form-field>
      </div>
      <div class="p-col-3" style="width: 140px !important">
        <mat-form-field class="form-field-above" style="margin-top: 10px">
          <mat-select
            [formControl]="statusFilter"
            placeholder="{{ 'Status' | translate }}"
            [disableOptionCentering]="true"
            panelClass="filterPanel"
            data-cy="table-status"
          >
            <mat-option [value]="record.value" *ngFor="let record of statusFilterList" data-cy="table-status-option">
              {{ record.key | translate }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
    </div>
  </div>
  <div class="text-right" style="display: inline-block; float: right">
    <button
      matTooltip="{{ 'Action' | translate }} "
      style="padding: 0px 7px !important"
      mat-raised-button
      color="accent"
      [disabled]="isLoading"
      [matMenuTriggerFor]="action"
      data-cy="button-action-menu"
    >
      {{ 'Action' | translate }}
      <mat-icon class="m-4px">expand_more</mat-icon>
    </button>
    <mat-menu #action="matMenu">
      <button
        mat-menu-item
        (click)="getAllDataCheckboxForGenerate(0)"
        matTooltip="{{ 'Generate Billing' | translate }}"
        class="border-button"
        *ngIf="permission.generateBillingInFollowUpOrganization()"
        data-cy="button-generate-billing"
      >
        {{ 'Generate Billing' | translate }}
      </button>
      <button
        mat-menu-item
        (click)="getAllDataCheckboxForAssign(0)"
        matTooltip="{{ 'Assign Timeline' | translate }}"
        class="border-button"
        *ngIf="permission.assignTimelineTemplateMultipleInFollowUpOrganization()"
        data-cy="button-assign-timeline"
      >
        {{ 'Assign Timeline' | translate }}
      </button>

      <button
        mat-menu-item
        matTooltip="{{ 'Send email' | translate }}"
        (click)="getAllDataCheckboxForMultipleMail(0)"
        *ngIf="permission.sendMailMultipleInFollowUpOrganization()"
        data-cy="button-send-email"
      >
        <!-- <mat-icon svgIcon="email" class="mat-icon-svgIcon icon-svgIcon-menu"></mat-icon> -->
        {{ 'Send email' | translate }}
      </button>
    </mat-menu>

    <button
      class="text-right"
      style="padding: 0px 7px !important"
      mat-raised-button
      color="accent"
      matTooltip="{{ 'Export' | translate }} "      
      [disabled]="isLoading"
      [matMenuTriggerFor]="export"
      *ngIf="permission.exportFinanceFollowUpPerm()"
      data-cy="button-export">      
      {{ 'Export' | translate }}
      <mat-icon>expand_more</mat-icon>
    </button>
    <mat-menu #export="matMenu">
      <button
        mat-menu-item
        matTooltip="{{ 'Export follow up organization' | translate }}"
        [disabled]="isLoading"
        (click)="buttonClicked = 'export'; getAllIdForCheckbox(0)"
        *ngIf="permission.exportInFollowUpOrganization()"
        data-cy="button-export">
        {{ 'Export follow up organization' | translate }}
      </button>
      <button
        mat-menu-item
        matTooltip="{{ 'Export controlling report' | translate }} "
        (click)="buttonClicked = 'export-controlling'; controllerButton('export-controlling')"
        *ngIf="permission.exportFinanceFollowUpPerm()"
        class="border-button"
        data-cy="button-send-email">        
        {{ 'Export controlling report' | translate }}
      </button>
    </mat-menu>

    <!-- <button
      class="text-right"
      mat-raised-button
      color="primary"
      matTooltip="{{ 'Export' | translate }}"
      [disabled]="isLoading"
      (click)="getAllIdForCheckbox(0)"
      *ngIf="permission.exportInFollowUpOrganization()"
      data-cy="button-export"
    >
      <mat-icon svgIcon="file-excel-outline" class="mat-icon-svgIcon"></mat-icon>
      {{ 'Export' | translate }}
    </button> -->

    <button
      mat-raised-button
      color="primary"
      matTooltip="{{ 'Reset Filter' | translate }}"
      (click)="resetFilter()"
      [disabled]="isLoading"
      *ngIf="permission.resetInFollowUpOrganization()"
      data-cy="button-reset"
    >
      <mat-icon svgIcon="loop" class="mat-icon-svgIcon"></mat-icon>
      {{ 'RESET' | translate }}
    </button>
  </div>
</div>

<div class="horizontal mat-elevation-z8 finance-table" style="font-family: 'firaSans' !important">
  <table
    mat-table
    [dataSource]="dataSource"
    matSort
    (matSortChange)="sortData($event)"
    class="mat-elevation-z8"
    style="font-family: 'firaSans'"
    data-cy="table-finance-follow-up-organization"
  >
    <ng-container matColumnDef="select" sticky>
      <th mat-header-cell *matHeaderCellDef class="text-center" data-cy="table-col-selection">
        <mat-checkbox
          (change)="$event ? masterToggle() : null"
          (change)="showOptions('all', '')"
          [checked]="(selection.hasValue() && isAllSelected()) || isCheckedAll"
          [indeterminate]="selection.hasValue() && !isAllSelected()"
          [aria-label]="checkboxLabel()"
        >
        </mat-checkbox>
      </th>
      <td mat-cell *matCellDef="let row" class="text-center" data-cy="table-col-selection">
        <mat-checkbox
          (click)="$event.stopPropagation()"
          (change)="$event ? selection.toggle(row._id) : null"
          [checked]="selection.isSelected(row._id) || (isCheckedAll && !dataUnselectUser.includes(row?._id))"
          (change)="showOptions('one', row)"
          [aria-label]="checkboxLabel(row)"
        >
        </mat-checkbox>
      </td>
    </ng-container>

    <ng-container matColumnDef="organizationTypeFilter" sticky>
      <th mat-header-cell *matHeaderCellDef class="custom-filter-table">
        <!-- <mat-form-field>
          <input
            matInput
            class="form-field"
            [formControl]="organizationTypeFilter"
            [matAutocomplete]="orgTypeAuto"
            placeholder="{{ 'search' | translate }}"
            data-cy="table-filter-type-of-organization"
          />
          <mat-autocomplete #orgTypeAuto="matAutocomplete" [panelWidth]="'fit'">
            <mat-option
              value="{{ 'All' | translate }}"
              (click)="setOrganizationTypeFilter('All')"
              data-cy="table-filter-type-of-organization-option"
              >{{ 'All' | translate }}
            </mat-option>
            <mat-option
              *ngFor="let item of filteredType | async"
              [value]="item | translate"
              matTooltip="{{ item | translate }}"
              (click)="setOrganizationTypeFilter(item)"
              data-cy="table-filter-type-of-organization-option"
            >
              {{ item | translate }}
            </mat-option>
          </mat-autocomplete>
        </mat-form-field> -->
        <ng-select
        [items]="typeList"
        bindValue="name"
        bindLabel="name"
        class="custom-dropdownpanel"
        [appendTo]="'body'"
        [multiple]="true"
        notFoundText="{{ 'NOT RECORD FOUND' | translate }}"
        placeholder="{{ 'search' | translate }}"
        [formControl]="organizationTypeFilter"
        [clearable]="false"
        [closeOnSelect]="false"
        (close)="setOrganizationFilter()"
      >
        <ng-template ng-option-tmp let-item="item" let-item$="item$" let-index="index">
          <input id="item-{{ index }}" type="checkbox" [ngModel]="item$.selected" /> {{ item?.name }}
        </ng-template>
        <ng-template ng-header-tmp *ngIf="typeList?.length">
          <mat-checkbox
            class="all-input"
            style="cursor: pointer"
            [checked]="isAllDropdownSelected('typeOrganization')"
            [indeterminate]="isSomeDropdownSelected('typeOrganization')"
            (change)="selectAllData($event, 'typeOrganization')"
          >
            {{ 'AllF' | translate }}
          </mat-checkbox>
        </ng-template>
      </ng-select>
      </th>
    </ng-container>

    <ng-container matColumnDef="organizationNameFilter" sticky>
      <th mat-header-cell *matHeaderCellDef>
        <mat-form-field>
          <input
            [formControl]="organizationNameFilter"
            matInput
            class="form-field"
            placeholder="{{ 'search' | translate }}"
            data-cy="table-filter-organization-name"
          />
        </mat-form-field>
      </th>
    </ng-container>

    <ng-container matColumnDef="studentNumberFilter" sticky>
      <th mat-header-cell *matHeaderCellDef>
        <mat-form-field>
          <input
            [formControl]="studentNumberFilter"
            matInput
            class="form-field"
            placeholder="{{ 'search' | translate }}"
            data-cy="table-filter-student-number"
          />
        </mat-form-field>
      </th>
    </ng-container>

    <ng-container matColumnDef="studentNameFilter" sticky>
      <th mat-header-cell *matHeaderCellDef>
        <mat-form-field>
          <input
            [formControl]="studentFilter"
            matInput
            class="form-field"
            placeholder="{{ 'search' | translate }}"
            data-cy="table-filter-student-name"
          />
        </mat-form-field>
      </th>
    </ng-container>

    <ng-container matColumnDef="studentProgramFilter" sticky>
      <th mat-header-cell *matHeaderCellDef class="text-center custom-filter-table-student-status">
        <!-- <mat-form-field>
          <input
            matInput
            class="form-field"
            [matAutocomplete]="currentProgramAuto"
            [formControl]="currentProgramFilter"
            placeholder="{{ 'search' | translate }}"
            data-cy="table-filter-student-program"
          />
          <mat-autocomplete #currentProgramAuto="matAutocomplete" [panelWidth]="'fit'">
            <mat-option
              value="{{ 'All' | translate }}"
              (click)="setCurrentProgramFilter('All')"
              data-cy="table-filter-student-program-option"
              >{{ 'All' | translate }}</mat-option
            >
            <mat-option
              *ngFor="let record of filteredCurrentProgram | async"
              [value]="record?.program"
              (click)="setCurrentProgramFilter(record)"
              data-cy="table-filter-student-program-option"
            >
              {{ record?.program | translate }}
            </mat-option>
          </mat-autocomplete>
        </mat-form-field> -->

        <ng-select
        [items]="intakeList"
        bindValue="_id"
        bindLabel="program"
        class="custom-dropdownpanel"
        [appendTo]="'body'"
        [multiple]="true"
        notFoundText="{{ 'NOT RECORD FOUND' | translate }}"
        placeholder="{{ 'search' | translate }}"
        [formControl]="currentProgramFilter"
        [clearable]="false"
        [closeOnSelect]="false"
        (close)="setIntakeChannelFilter()"
      >
        <ng-template ng-option-tmp let-item="item" let-item$="item$" let-index="index">
          <input id="item-{{ index }}" type="checkbox" [ngModel]="item$.selected" /> {{ item.program }}
        </ng-template>
        <ng-template ng-header-tmp *ngIf="intakeList?.length">
          <mat-checkbox
            class="all-input"
            style="cursor: pointer"
            [checked]="isAllDropdownSelected('intakeChannels')"
            [indeterminate]="isSomeDropdownSelected('intakeChannels')"
            (change)="selectAllData($event, 'intakeChannels')"
          >
            {{ 'AllF' | translate }}
          </mat-checkbox>
        </ng-template>
      </ng-select>
      </th>
    </ng-container>

    <ng-container matColumnDef="formationTypeFilter">
      <th mat-header-cell *matHeaderCellDef class="custom-filter-table-student-status">
        <!-- <mat-form-field>
          <input
            matInput
            class="form-field"
            [matAutocomplete]="currentProgramAuto"
            [formControl]="studentTypeFilter"
            placeholder="{{ 'search' | translate }}"
            data-cy="table-filter-type-of-formation"
          />
          <mat-autocomplete #currentProgramAuto="matAutocomplete" [panelWidth]="'fit'">
            <mat-option value="{{ 'All' | translate }}" (click)="setStudentTypeFilter('All')">{{ 'All' | translate }}</mat-option>
            <mat-option
              *ngFor="let record of filteredFormation | async"
              [value]="'type_formation.' + record?.type_of_formation | translate"
              (click)="setStudentTypeFilter(record)"
              data-cy="table-filter-type-of-formation-option"
            >
              {{ 'type_formation.' + record?.type_of_formation | translate }}
            </mat-option>
          </mat-autocomplete>
        </mat-form-field> -->

        <ng-select
        [items]="studentType"
        bindValue="_id"
        bindLabel="label"
        class="custom-dropdownpanel"
        [appendTo]="'body'"
        [multiple]="true"
        notFoundText="{{ 'NOT RECORD FOUND' | translate }}"
        placeholder="{{ 'search' | translate }}"
        [formControl]="studentTypeFilter"
        [clearable]="false"
        [closeOnSelect]="false"
        (close)="setStudentTypesFilter()"
      >
        <ng-template ng-option-tmp let-item="item" let-item$="item$" let-index="index">
          <input id="item-{{ index }}" type="checkbox" [ngModel]="item$.selected" /> {{ item?.label }}
        </ng-template>
        <ng-template ng-header-tmp *ngIf="studentType?.length">
          <mat-checkbox
            class="all-input"
            style="cursor: pointer"
            [checked]="isAllDropdownSelected('studentTypes')"
            [indeterminate]="isSomeDropdownSelected('studentTypes')"
            (change)="selectAllData($event, 'studentTypes')"
          >
            {{ 'AllF' | translate }}
          </mat-checkbox>
        </ng-template>
      </ng-select>
      </th>
    </ng-container>

    <ng-container matColumnDef="totalAmountFilter">
      <th mat-header-cell *matHeaderCellDef></th>
    </ng-container>

    <ng-container matColumnDef="amountBilledFilter">
      <th mat-header-cell *matHeaderCellDef></th>
    </ng-container>

    <ng-container matColumnDef="amountPaidFilter">
      <th mat-header-cell *matHeaderCellDef></th>
    </ng-container>

    <ng-container matColumnDef="remainingDueFilter">
      <th mat-header-cell *matHeaderCellDef></th>
    </ng-container>

    <ng-container matColumnDef="amountLateFilter">
      <th mat-header-cell *matHeaderCellDef></th>
    </ng-container>

    <ng-container matColumnDef="accumulatedLateFilter">
      <th mat-header-cell *matHeaderCellDef></th>
    </ng-container>

    <!-- <ng-container matColumnDef="downPaymentFilter">
      <th mat-header-cell *matHeaderCellDef>
        <mat-form-field>
          <mat-select [formControl]="depositFilter" [matTooltip]="depositFilter.value | translate">
            <mat-option [value]="record.value" *ngFor="let record of DPandTermsFilterList">
              {{ record.key | translate }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </th>
    </ng-container> -->

    <ng-container matColumnDef="notRespectedFilter">
      <th mat-header-cell *matHeaderCellDef></th>
    </ng-container>

    <ng-container matColumnDef="notSettledFilter">
      <th mat-header-cell *matHeaderCellDef></th>
    </ng-container>

    <ng-container matColumnDef="term1Filter">
      <th mat-header-cell *matHeaderCellDef class="custom-filter-table-student-status">
        <!-- <mat-form-field>
          <mat-select
            [formControl]="terms1Filter"
            [matTooltip]="terms1Filter.value === 'billed' ? ('Generated' | translate) : (terms1Filter.value | translate)"
            [disableOptionCentering]="true"
            panelClass="filterPanel custom-matselect-dropdown"
            data-cy="table-filter-term-1">
            <mat-option
              value="AllM">
              {{ 'All' | translate }}
            </mat-option>
            <mat-option [value]="record.value" *ngFor="let record of DPandTermsFilterList"
              data-cy="table-filter-term-1-option">
              {{ record.key | translate }}
            </mat-option>
          </mat-select>
        </mat-form-field> -->
        <ng-select
          [items]="DPandTermsFilterList"
          bindValue="value"
          bindLabel="label"
          class="custom-dropdownpanel"
          [appendTo]="'body'"
          [multiple]="true"
          notFoundText="{{ 'NOT RECORD FOUND' | translate }}"
          placeholder="{{ 'search' | translate }}"
          [formControl]="terms1Filter"
          [clearable]="false"
          [closeOnSelect]="false"
          (close)="setTermsFilter('terms1')"
        >
          <ng-template ng-option-tmp let-item="item" let-item$="item$" let-index="index">
            <input id="item-{{ index }}" type="checkbox" [ngModel]="item$.selected" /> {{ item?.label }}
          </ng-template>
          <ng-template ng-header-tmp *ngIf="DPandTermsFilterList?.length">
            <mat-checkbox
              class="all-input"
              style="cursor: pointer"
              [checked]="isAllDropdownSelected('terms1')"
              [indeterminate]="isSomeDropdownSelected('terms1')"
              (change)="selectAllData($event, 'terms1')"
            >
              {{ 'AllM' | translate }}
            </mat-checkbox>
          </ng-template>
        </ng-select>
      </th>
    </ng-container>
    <ng-container matColumnDef="term2Filter">
      <th mat-header-cell *matHeaderCellDef class="custom-filter-table-student-status">
        <!-- <mat-form-field>
          <mat-select
            [formControl]="terms2Filter"
            [matTooltip]="terms2Filter.value === 'billed' ? ('Generated' | translate) : (terms2Filter.value | translate)"
            [disableOptionCentering]="true"
            panelClass="filterPanel custom-matselect-dropdown"
            data-cy="table-filter-term-2">
            <mat-option
              value="AllM">
              {{ 'All' | translate }}
            </mat-option>
            <mat-option [value]="record.value" *ngFor="let record of DPandTermsFilterList"
              data-cy="table-filter-term-2-option">
              {{ record.key | translate }}
            </mat-option>
          </mat-select>
        </mat-form-field> -->
        <ng-select
          [items]="DPandTermsFilterList"
          bindValue="value"
          bindLabel="label"
          class="custom-dropdownpanel"
          [appendTo]="'body'"
          [multiple]="true"
          notFoundText="{{ 'NOT RECORD FOUND' | translate }}"
          placeholder="{{ 'search' | translate }}"
          [formControl]="terms2Filter"
          [clearable]="false"
          [closeOnSelect]="false"
          (close)="setTermsFilter('terms2')"
        >
          <ng-template ng-option-tmp let-item="item" let-item$="item$" let-index="index">
            <input id="item-{{ index }}" type="checkbox" [ngModel]="item$.selected" /> {{ item?.label }}
          </ng-template>
          <ng-template ng-header-tmp *ngIf="DPandTermsFilterList?.length">
            <mat-checkbox
              class="all-input"
              style="cursor: pointer"
              [checked]="isAllDropdownSelected('terms2')"
              [indeterminate]="isSomeDropdownSelected('terms2')"
              (change)="selectAllData($event, 'terms2')"
            >
              {{ 'AllM' | translate }}
            </mat-checkbox>
          </ng-template>
        </ng-select>
      </th>
    </ng-container>
    <ng-container matColumnDef="term3Filter">
      <th mat-header-cell *matHeaderCellDef class="custom-filter-table-student-status">
        <!-- <mat-form-field>
          <mat-select
            [formControl]="terms3Filter"
            [matTooltip]="terms3Filter.value === 'billed' ? ('Generated' | translate) : (terms3Filter.value | translate)"
            [disableOptionCentering]="true"
            panelClass="filterPanel custom-matselect-dropdown"
            data-cy="table-filter-term-3">
            <mat-option
              value="AllM">
              {{ 'All' | translate }}
            </mat-option>
            <mat-option [value]="record.value" *ngFor="let record of DPandTermsFilterList"
              data-cy="table-filter-term-3-option">
              {{ record.key | translate }}
            </mat-option>
          </mat-select>
        </mat-form-field> -->
        <ng-select
          [items]="DPandTermsFilterList"
          bindValue="value"
          bindLabel="label"
          class="custom-dropdownpanel"
          [appendTo]="'body'"
          [multiple]="true"
          notFoundText="{{ 'NOT RECORD FOUND' | translate }}"
          placeholder="{{ 'search' | translate }}"
          [formControl]="terms3Filter"
          [clearable]="false"
          [closeOnSelect]="false"
          (close)="setTermsFilter('terms3')"
        >
          <ng-template ng-option-tmp let-item="item" let-item$="item$" let-index="index">
            <input id="item-{{ index }}" type="checkbox" [ngModel]="item$.selected" /> {{ item?.label }}
          </ng-template>
          <ng-template ng-header-tmp *ngIf="DPandTermsFilterList?.length">
            <mat-checkbox
              class="all-input"
              style="cursor: pointer"
              [checked]="isAllDropdownSelected('terms3')"
              [indeterminate]="isSomeDropdownSelected('terms3')"
              (change)="selectAllData($event, 'terms3')"
            >
              {{ 'AllM' | translate }}
            </mat-checkbox>
          </ng-template>
        </ng-select>
      </th>
    </ng-container>
    <ng-container matColumnDef="term4Filter">
      <th mat-header-cell *matHeaderCellDef class="custom-filter-table-student-status">
        <!-- <mat-form-field>
          <mat-select
            [formControl]="terms4Filter"
            [matTooltip]="terms4Filter.value === 'billed' ? ('Generated' | translate) : (terms4Filter.value | translate)"
            [disableOptionCentering]="true"
            panelClass="filterPanel custom-matselect-dropdown"
            data-cy="table-filter-term-4">
            <mat-option
              value="AllM">
              {{ 'All' | translate }}
            </mat-option>
            <mat-option [value]="record.value" *ngFor="let record of DPandTermsFilterList"
              data-cy="table-filter-term-4-option">
              {{ record.key | translate }}
            </mat-option>
          </mat-select>
        </mat-form-field> -->
        <ng-select
          [items]="DPandTermsFilterList"
          bindValue="value"
          bindLabel="label"
          class="custom-dropdownpanel"
          [appendTo]="'body'"
          [multiple]="true"
          notFoundText="{{ 'NOT RECORD FOUND' | translate }}"
          placeholder="{{ 'search' | translate }}"
          [formControl]="terms4Filter"
          [clearable]="false"
          [closeOnSelect]="false"
          (close)="setTermsFilter('terms4')"
        >
          <ng-template ng-option-tmp let-item="item" let-item$="item$" let-index="index">
            <input id="item-{{ index }}" type="checkbox" [ngModel]="item$.selected" /> {{ item?.label }}
          </ng-template>
          <ng-template ng-header-tmp *ngIf="DPandTermsFilterList?.length">
            <mat-checkbox
              class="all-input"
              style="cursor: pointer"
              [checked]="isAllDropdownSelected('terms4')"
              [indeterminate]="isSomeDropdownSelected('terms4')"
              (change)="selectAllData($event, 'terms4')"
            >
              {{ 'AllM' | translate }}
            </mat-checkbox>
          </ng-template>
        </ng-select>
      </th>
    </ng-container>
    <ng-container matColumnDef="term5Filter">
      <th mat-header-cell *matHeaderCellDef class="custom-filter-table-student-status">
        <!-- <mat-form-field>
          <mat-select
            [formControl]="terms5Filter"
            [matTooltip]="terms5Filter.value === 'billed' ? ('Generated' | translate) : (terms5Filter.value | translate)"
            [disableOptionCentering]="true"
            panelClass="filterPanel custom-matselect-dropdown"
            data-cy="table-filter-term-5">
            <mat-option
              value="AllM">
              {{ 'All' | translate }}
            </mat-option>
            <mat-option [value]="record.value" *ngFor="let record of DPandTermsFilterList"
              data-cy="table-filter-term-5-option">
              {{ record.key | translate }}
            </mat-option>
          </mat-select>
        </mat-form-field> -->
        <ng-select
          [items]="DPandTermsFilterList"
          bindValue="value"
          bindLabel="label"
          class="custom-dropdownpanel"
          [appendTo]="'body'"
          [multiple]="true"
          notFoundText="{{ 'NOT RECORD FOUND' | translate }}"
          placeholder="{{ 'search' | translate }}"
          [formControl]="terms5Filter"
          [clearable]="false"
          [closeOnSelect]="false"
          (close)="setTermsFilter('terms5')"
        >
          <ng-template ng-option-tmp let-item="item" let-item$="item$" let-index="index">
            <input id="item-{{ index }}" type="checkbox" [ngModel]="item$.selected" /> {{ item?.label }}
          </ng-template>
          <ng-template ng-header-tmp *ngIf="DPandTermsFilterList?.length">
            <mat-checkbox
              class="all-input"
              style="cursor: pointer"
              [checked]="isAllDropdownSelected('terms5')"
              [indeterminate]="isSomeDropdownSelected('terms5')"
              (change)="selectAllData($event, 'terms5')"
            >
              {{ 'AllM' | translate }}
            </mat-checkbox>
          </ng-template>
        </ng-select>
      </th>
    </ng-container>
    <ng-container matColumnDef="term6Filter">
      <th mat-header-cell *matHeaderCellDef class="custom-filter-table-student-status">
        <!-- <mat-form-field>
          <mat-select
            [formControl]="terms6Filter"
            [matTooltip]="terms6Filter.value === 'billed' ? ('Generated' | translate) : (terms6Filter.value | translate)"
            [disableOptionCentering]="true"
            panelClass="filterPanel custom-matselect-dropdown"
            data-cy="table-filter-term-6">
            <mat-option
              value="AllM">
              {{ 'All' | translate }}
            </mat-option>
            <mat-option [value]="record.value" *ngFor="let record of DPandTermsFilterList"
              data-cy="table-filter-term-6-option">
              {{ record.key | translate }}
            </mat-option>
          </mat-select>
        </mat-form-field> -->
        <ng-select
          [items]="DPandTermsFilterList"
          bindValue="value"
          bindLabel="label"
          class="custom-dropdownpanel"
          [appendTo]="'body'"
          [multiple]="true"
          notFoundText="{{ 'NOT RECORD FOUND' | translate }}"
          placeholder="{{ 'search' | translate }}"
          [formControl]="terms6Filter"
          [clearable]="false"
          [closeOnSelect]="false"
          (close)="setTermsFilter('terms6')"
        >
          <ng-template ng-option-tmp let-item="item" let-item$="item$" let-index="index">
            <input id="item-{{ index }}" type="checkbox" [ngModel]="item$.selected" /> {{ item?.label }}
          </ng-template>
          <ng-template ng-header-tmp *ngIf="DPandTermsFilterList?.length">
            <mat-checkbox
              class="all-input"
              style="cursor: pointer"
              [checked]="isAllDropdownSelected('terms6')"
              [indeterminate]="isSomeDropdownSelected('terms6')"
              (change)="selectAllData($event, 'terms6')"
            >
              {{ 'AllM' | translate }}
            </mat-checkbox>
          </ng-template>
        </ng-select>
      </th>
    </ng-container>
    <ng-container matColumnDef="term7Filter">
      <th mat-header-cell *matHeaderCellDef class="custom-filter-table-student-status">
        <!-- <mat-form-field>
          <mat-select
            [formControl]="terms7Filter"
            [matTooltip]="terms7Filter.value === 'billed' ? ('Generated' | translate) : (terms7Filter.value | translate)"
            [disableOptionCentering]="true"
            panelClass="filterPanel custom-matselect-dropdown"
            data-cy="table-filter-term-7">
            <mat-option
              value="AllM">
              {{ 'All' | translate }}
            </mat-option>
            <mat-option [value]="record.value" *ngFor="let record of DPandTermsFilterList"
              data-cy="table-filter-term-7-option">
              {{ record.key | translate }}
            </mat-option>
          </mat-select>
        </mat-form-field> -->
        <ng-select
          [items]="DPandTermsFilterList"
          bindValue="value"
          bindLabel="label"
          class="custom-dropdownpanel"
          [appendTo]="'body'"
          [multiple]="true"
          notFoundText="{{ 'NOT RECORD FOUND' | translate }}"
          placeholder="{{ 'search' | translate }}"
          [formControl]="terms7Filter"
          [clearable]="false"
          [closeOnSelect]="false"
          (close)="setTermsFilter('terms7')"
        >
          <ng-template ng-option-tmp let-item="item" let-item$="item$" let-index="index">
            <input id="item-{{ index }}" type="checkbox" [ngModel]="item$.selected" /> {{ item?.label }}
          </ng-template>
          <ng-template ng-header-tmp *ngIf="DPandTermsFilterList?.length">
            <mat-checkbox
              class="all-input"
              style="cursor: pointer"
              [checked]="isAllDropdownSelected('terms7')"
              [indeterminate]="isSomeDropdownSelected('terms7')"
              (change)="selectAllData($event, 'terms7')"
            >
              {{ 'AllM' | translate }}
            </mat-checkbox>
          </ng-template>
        </ng-select>
      </th>
    </ng-container>
    <ng-container matColumnDef="term8Filter">
      <th mat-header-cell *matHeaderCellDef class="custom-filter-table-student-status">
        <!-- <mat-form-field>
          <mat-select
            [formControl]="terms8Filter"
            [matTooltip]="terms8Filter.value === 'billed' ? ('Generated' | translate) : (terms8Filter.value | translate)"
            [disableOptionCentering]="true"
            panelClass="filterPanel custom-matselect-dropdown"
            data-cy="table-filter-term-8">
            <mat-option
              value="AllM">
              {{ 'All' | translate }}
            </mat-option>
            <mat-option [value]="record.value" *ngFor="let record of DPandTermsFilterList"
              data-cy="table-filter-term-8-option">
              {{ record.key | translate }}
            </mat-option>
          </mat-select>
        </mat-form-field> -->
        <ng-select
          [items]="DPandTermsFilterList"
          bindValue="value"
          bindLabel="label"
          class="custom-dropdownpanel"
          [appendTo]="'body'"
          [multiple]="true"
          notFoundText="{{ 'NOT RECORD FOUND' | translate }}"
          placeholder="{{ 'search' | translate }}"
          [formControl]="terms8Filter"
          [clearable]="false"
          [closeOnSelect]="false"
          (close)="setTermsFilter('terms8')"
        >
          <ng-template ng-option-tmp let-item="item" let-item$="item$" let-index="index">
            <input id="item-{{ index }}" type="checkbox" [ngModel]="item$.selected" /> {{ item?.label }}
          </ng-template>
          <ng-template ng-header-tmp *ngIf="DPandTermsFilterList?.length">
            <mat-checkbox
              class="all-input"
              style="cursor: pointer"
              [checked]="isAllDropdownSelected('terms8')"
              [indeterminate]="isSomeDropdownSelected('terms8')"
              (change)="selectAllData($event, 'terms8')"
            >
              {{ 'AllM' | translate }}
            </mat-checkbox>
          </ng-template>
        </ng-select>
      </th>
    </ng-container>
    <ng-container matColumnDef="term9Filter">
      <th mat-header-cell *matHeaderCellDef class="custom-filter-table-student-status">
        <!-- <mat-form-field>
          <mat-select
            [formControl]="terms9Filter"
            [matTooltip]="terms9Filter.value === 'billed' ? ('Generated' | translate) : (terms9Filter.value | translate)"
            [disableOptionCentering]="true"
            panelClass="filterPanel custom-matselect-dropdown"
            data-cy="table-filter-term-9">
            <mat-option
              value="AllM">
              {{ 'All' | translate }}
            </mat-option>
            <mat-option [value]="record.value" *ngFor="let record of DPandTermsFilterList"
              data-cy="table-filter-term-9-option">
              {{ record.key | translate }}
            </mat-option>
          </mat-select>
        </mat-form-field> -->
        <ng-select
          [items]="DPandTermsFilterList"
          bindValue="value"
          bindLabel="label"
          class="custom-dropdownpanel"
          [appendTo]="'body'"
          [multiple]="true"
          notFoundText="{{ 'NOT RECORD FOUND' | translate }}"
          placeholder="{{ 'search' | translate }}"
          [formControl]="terms9Filter"
          [clearable]="false"
          [closeOnSelect]="false"
          (close)="setTermsFilter('terms9')"
        >
          <ng-template ng-option-tmp let-item="item" let-item$="item$" let-index="index">
            <input id="item-{{ index }}" type="checkbox" [ngModel]="item$.selected" /> {{ item?.label }}
          </ng-template>
          <ng-template ng-header-tmp *ngIf="DPandTermsFilterList?.length">
            <mat-checkbox
              class="all-input"
              style="cursor: pointer"
              [checked]="isAllDropdownSelected('terms9')"
              [indeterminate]="isSomeDropdownSelected('terms9')"
              (change)="selectAllData($event, 'terms9')"
            >
              {{ 'AllM' | translate }}
            </mat-checkbox>
          </ng-template>
        </ng-select>
      </th>
    </ng-container>
    <ng-container matColumnDef="term10Filter">
      <th mat-header-cell *matHeaderCellDef class="custom-filter-table-student-status">
        <!-- <mat-form-field>
          <mat-select
            [formControl]="terms10Filter"
            [matTooltip]="terms10Filter.value === 'billed' ? ('Generated' | translate) : (terms10Filter.value | translate)"
            [disableOptionCentering]="true"
            panelClass="filterPanel custom-matselect-dropdown"
            data-cy="table-filter-term-10">
            <mat-option
              value="AllM">
              {{ 'All' | translate }}
            </mat-option>
            <mat-option [value]="record.value" *ngFor="let record of DPandTermsFilterList"
              data-cy="table-filter-term-10-option">
              {{ record.key | translate }}
            </mat-option>
          </mat-select>
        </mat-form-field> -->
        <ng-select
          [items]="DPandTermsFilterList"
          bindValue="value"
          bindLabel="label"
          class="custom-dropdownpanel"
          [appendTo]="'body'"
          [multiple]="true"
          notFoundText="{{ 'NOT RECORD FOUND' | translate }}"
          placeholder="{{ 'search' | translate }}"
          [formControl]="terms10Filter"
          [clearable]="false"
          [closeOnSelect]="false"
          (close)="setTermsFilter('terms10')"
        >
          <ng-template ng-option-tmp let-item="item" let-item$="item$" let-index="index">
            <input id="item-{{ index }}" type="checkbox" [ngModel]="item$.selected" /> {{ item?.label }}
          </ng-template>
          <ng-template ng-header-tmp *ngIf="DPandTermsFilterList?.length">
            <mat-checkbox
              class="all-input"
              style="cursor: pointer"
              [checked]="isAllDropdownSelected('terms10')"
              [indeterminate]="isSomeDropdownSelected('terms10')"
              (change)="selectAllData($event, 'terms10')"
            >
              {{ 'AllM' | translate }}
            </mat-checkbox>
          </ng-template>
        </ng-select>
      </th>
    </ng-container>
    <ng-container matColumnDef="term11Filter">
      <th mat-header-cell *matHeaderCellDef class="custom-filter-table-student-status">
        <!-- <mat-form-field>
          <mat-select
            [formControl]="terms11Filter"
            [matTooltip]="terms11Filter.value === 'billed' ? ('Generated' | translate) : (terms11Filter.value | translate)"
            [disableOptionCentering]="true"
            panelClass="filterPanel custom-matselect-dropdown"
            data-cy="table-filter-term-11">
            <mat-option
              value="AllM">
              {{ 'All' | translate }}
            </mat-option>
            <mat-option [value]="record.value" *ngFor="let record of DPandTermsFilterList"
              data-cy="table-filter-term-11-option">
              {{ record.key | translate }}
            </mat-option>
          </mat-select>
        </mat-form-field> -->
        <ng-select
          [items]="DPandTermsFilterList"
          bindValue="value"
          bindLabel="label"
          class="custom-dropdownpanel"
          [appendTo]="'body'"
          [multiple]="true"
          notFoundText="{{ 'NOT RECORD FOUND' | translate }}"
          placeholder="{{ 'search' | translate }}"
          [formControl]="terms11Filter"
          [clearable]="false"
          [closeOnSelect]="false"
          (close)="setTermsFilter('terms11')"
        >
          <ng-template ng-option-tmp let-item="item" let-item$="item$" let-index="index">
            <input id="item-{{ index }}" type="checkbox" [ngModel]="item$.selected" /> {{ item?.label }}
          </ng-template>
          <ng-template ng-header-tmp *ngIf="DPandTermsFilterList?.length">
            <mat-checkbox
              class="all-input"
              style="cursor: pointer"
              [checked]="isAllDropdownSelected('terms11')"
              [indeterminate]="isSomeDropdownSelected('terms11')"
              (change)="selectAllData($event, 'terms11')"
            >
              {{ 'AllM' | translate }}
            </mat-checkbox>
          </ng-template>
        </ng-select>
      </th>
    </ng-container>
    <ng-container matColumnDef="term12Filter">
      <th mat-header-cell *matHeaderCellDef class="custom-filter-table-student-status">
        <!-- <mat-form-field>
          <mat-select
            [formControl]="terms12Filter"
            [matTooltip]="terms12Filter.value === 'billed' ? ('Generated' | translate) : (terms12Filter.value | translate)"
            [disableOptionCentering]="true"
            panelClass="filterPanel custom-matselect-dropdown"
            data-cy="table-filter-term-12">
            <mat-option
              value="AllM">
              {{ 'All' | translate }}
            </mat-option>
            <mat-option [value]="record.value" *ngFor="let record of DPandTermsFilterList"
              data-cy="table-filter-term-12-option">
              {{ record.key | translate }}
            </mat-option>
          </mat-select>
        </mat-form-field> -->
        <ng-select
          [items]="DPandTermsFilterList"
          bindValue="value"
          bindLabel="label"
          class="custom-dropdownpanel"
          [appendTo]="'body'"
          [multiple]="true"
          notFoundText="{{ 'NOT RECORD FOUND' | translate }}"
          placeholder="{{ 'search' | translate }}"
          [formControl]="terms12Filter"
          [clearable]="false"
          [closeOnSelect]="false"
          (close)="setTermsFilter('terms12')"
        >
          <ng-template ng-option-tmp let-item="item" let-item$="item$" let-index="index">
            <input id="item-{{ index }}" type="checkbox" [ngModel]="item$.selected" /> {{ item?.label }}
          </ng-template>
          <ng-template ng-header-tmp *ngIf="DPandTermsFilterList?.length">
            <mat-checkbox
              class="all-input"
              style="cursor: pointer"
              [checked]="isAllDropdownSelected('terms12')"
              [indeterminate]="isSomeDropdownSelected('terms12')"
              (change)="selectAllData($event, 'terms12')"
            >
              {{ 'AllM' | translate }}
            </mat-checkbox>
          </ng-template>
        </ng-select>
      </th>
    </ng-container>

    <ng-container matColumnDef="actionFilter" stickyEnd>
      <th mat-header-cell *matHeaderCellDef></th>
    </ng-container>

    <ng-container matColumnDef="selectFilter" sticky>
      <th mat-header-cell *matHeaderCellDef></th>
    </ng-container>

    <ng-container matColumnDef="organizationType" sticky>
      <th
        mat-header-cell
        *matHeaderCellDef
        matTooltip="{{ 'Type of Organization' | translate }}"
        matTooltipPosition="above"
        data-cy="table-col-type-of-organization"
      >
        <h5 style="font-size: 11px; text-align: center">
          {{ 'Type of Organization' | translate }}
        </h5>
      </th>
      <td
        mat-cell
        *matCellDef="let element"
        [matTooltip]="element?.organization_type | translate"
        class="pad-l-xs"
        data-cy="table-col-type-of-organization"
      >
        {{ element?.organization_type | translate }}
      </td>
    </ng-container>

    <ng-container matColumnDef="organizationName" sticky>
      <th
        mat-header-cell
        *matHeaderCellDef
        matTooltip="{{ 'Organization Name' | translate }}"
        matTooltipPosition="above"
        data-cy="table-col-organization-name"
      >
        <h5 mat-sort-header="organization_name" style="font-size: 11px; text-align: center">
          {{ 'Organization Name' | translate }}
        </h5>
      </th>
      <td
        mat-cell
        *matCellDef="let element"
        [matTooltip]="element?.organization_name"
        class="pad-l-xs"
        data-cy="table-col-organization-name"
      >
        {{ element?.organization_name }}
      </td>
    </ng-container>

    <ng-container matColumnDef="studentNumber" sticky>
      <th
        mat-header-cell
        *matHeaderCellDef
        matTooltip="{{ 'Student Number' | translate }}"
        matTooltipPosition="above"
        data-cy="table-col-student-number"
      >
        <h5 mat-sort-header="student_number" style="font-size: 11px; text-align: center">
          {{ 'Student Number' | translate }}
        </h5>
      </th>
      <td
        mat-cell
        *matCellDef="let element"
        class="pad-l-xs"
        [matTooltip]="element?.account_number"
        style="text-align: start; padding-left: 0.5rem !important"
        data-cy="table-col-student-number"
      >
        {{ element?.account_number }}
      </td>
    </ng-container>

    <ng-container matColumnDef="studentName" sticky>
      <th
        mat-header-cell
        *matHeaderCellDef
        matTooltip="{{ 'Student Name' | translate }}"
        matTooltipPosition="above"
        data-cy="table-col-student-name"
      >
        <h5 mat-sort-header="student_name" style="font-size: 11px; text-align: center">
          <mat-icon class="mat-icon-status" style="font-size: 16px; position: relative; top: 0px"> school </mat-icon>
        </h5>
      </th>
      <td
        mat-cell
        *matCellDef="let element"
        [matTooltip]="
          (element?.candidate_id.last_name | uppercase) +
          ' ' +
          element?.candidate_id.first_name +
          ' ' +
          (element?.candidate_id.civility && element?.candidate_id.civility === 'neutral'
            ? ''
            : (element?.candidate_id.civility | translate))
        "
        class="pad-l-xs"
        data-cy="table-col-student-name"
      >
        {{
          (element?.candidate_id.last_name | uppercase) +
            ' ' +
            element?.candidate_id.first_name +
            ' ' +
            (element?.candidate_id.civility && element?.candidate_id.civility === 'neutral'
              ? ''
              : (element?.candidate_id.civility | translate))
        }}
      </td>
    </ng-container>

    <ng-container matColumnDef="studentProgram" sticky>
      <th
        style="padding-top: 7px"
        mat-header-cell
        *matHeaderCellDef
        matTooltip="{{ 'Student Program' | translate }}"
        matTooltipPosition="above"
        data-cy="table-col-student-program"
      >
        <h5 style="font-size: 11px; text-align: center">
          {{ 'Student Program' | translate }}
        </h5>
      </th>
      <td mat-cell *matCellDef="let element" [matTooltip]="element?.intake_channel?.program" data-cy="table-col-student-program">
        {{ element?.intake_channel?.program }}
      </td>
    </ng-container>

    <ng-container matColumnDef="formationType">
      <th
        mat-header-cell
        *matHeaderCellDef
        matTooltip="{{ 'Type of Formation' | translate }}"
        matTooltipPosition="above"
        data-cy="table-col-type-of-formation"
      >
        <h5 style="font-size: 11px">
          <mat-icon svgIcon="shield-account" class="mat-icon-svgIcon"> shield-account </mat-icon>
        </h5>
      </th>
      <ng-container *matCellDef="let element">
        <td
          *ngIf="element?.student_type?.type_of_formation"
          mat-cell
          class="pad-l-xs"
          matTooltip="{{ 'type_formation.' + element?.student_type?.type_of_formation | translate }}"
          data-cy="table-col-type-of-formation"
        >
          {{ 'type_formation.' + element?.student_type?.type_of_formation | translate }}
        </td>
        <td
          *ngIf="!element?.student_type?.type_of_formation"
          mat-cell
          class="pad-l-xs"
          matTooltip="-"
          data-cy="table-col-type-of-formation"
        >
          -
        </td>
      </ng-container>
    </ng-container>

    <ng-container matColumnDef="totalAmount">
      <th
        mat-header-cell
        *matHeaderCellDef
        matTooltip="{{ 'Total Amount' | translate }}"
        matTooltipPosition="above"
        data-cy="table-col-total-amount"
      >
        <h5 style="font-size: 11px; padding: 0px 2px; font-weight: 500">
          {{ 'Total Amount' | translate }}
        </h5>
      </th>
      <td mat-cell *matCellDef="let element" class="pad-l-xs" data-cy="table-col-total-amount">
        <ng-container *ngIf="element?.student_type?.type_of_formation !== 'classic'">
          <ng-container *ngIf="checkNoPayment(element)">
            <span style="color: #b7b7b7">X</span>
          </ng-container>

          <ng-container *ngIf="!checkNoPayment(element)">
            <ng-container
              *ngIf="
                element?.total_amount === '0' ||
                element?.total_amount === '0.00' ||
                element?.total_amount === 0 ||
                element?.total_amount === 0.0 ||
                element?.total_amount === '' ||
                !element?.total_amount
              "
            >
              <span style="color: #b7b7b7">X</span>
            </ng-container>

            <ng-container
              *ngIf="
                element?.total_amount &&
                element?.total_amount !== '0' &&
                element?.total_amount !== '0.00' &&
                element?.total_amount !== 0 &&
                element?.total_amount !== 0.0 &&
                element?.total_amount !== '' &&
                element?.total_amount
              "
            >
              {{ formatCurrencyHistory(element?.total_amount) }}
            </ng-container>
          </ng-container>
        </ng-container>
      </td>
    </ng-container>

    <ng-container matColumnDef="amountBilled">
      <th
        mat-header-cell
        *matHeaderCellDef
        matTooltip="{{ 'Amount Billed' | translate }}"
        matTooltipPosition="above"
        data-cy="table-col-amount-billed"
      >
        <h5 style="font-size: 11px; padding: 0px 2px; font-weight: 500">
          {{ 'Amount Billed' | translate }}
        </h5>
      </th>
      <td mat-cell *matCellDef="let element" class="pad-l-xs" data-cy="table-col-amount-billed">
        <!-- Classic -->
        <ng-container *ngIf="element?.student_type?.type_of_formation === 'classic'">
          <ng-container *ngIf="checkNoPayment(element)">
            <span style="color: #b7b7b7">X</span>
          </ng-container>

          <ng-container *ngIf="!checkNoPayment(element)">
            <ng-container
              *ngIf="
                element?.candidate_id?.candidate_admission_status === 'admitted' ||
                element?.candidate_id?.candidate_admission_status === 'admission_in_progress'
              "
            >
              <span style="color: #b7b7b7">X</span>
            </ng-container>

            <ng-container
              *ngIf="
                element?.candidate_id?.candidate_admission_status !== 'admitted' &&
                element?.candidate_id?.candidate_admission_status !== 'admission_in_progress'
              "
            >
              <ng-container *ngIf="element?.amount_billed !== 0">
                {{ formatCurrencyHistory(element?.amount_billed) }}
              </ng-container>
              <ng-container *ngIf="element?.amount_billed === 0 || (element?.amount_billed && element?.amount_billed === '')">
                <span style="color: #b7b7b7">X</span>
              </ng-container>
            </ng-container>
          </ng-container>
        </ng-container>

        <!-- Continuous -->
        <ng-container *ngIf="element?.student_type?.type_of_formation !== 'classic'">
          <ng-container *ngIf="checkNoPayment(element)">
            <span style="color: #b7b7b7">X</span>
          </ng-container>

          <ng-container *ngIf="!checkNoPayment(element)">
            <ng-container *ngIf="element?.amount_billed !== 0">
              {{ formatCurrencyHistory(element?.amount_billed) }}
            </ng-container>
            <ng-container *ngIf="element?.amount_billed === 0 || (element?.amount_billed && element?.amount_billed === '')">
              <span style="color: #b7b7b7">X</span>
            </ng-container>
          </ng-container>
        </ng-container>
      </td>
    </ng-container>

    <ng-container matColumnDef="amountPaid">
      <th
        mat-header-cell
        *matHeaderCellDef
        matTooltip="{{ 'Amount Paid' | translate }}"
        matTooltipPosition="above"
        data-cy="table-col-amount-paid"
      >
        <h5 style="font-size: 11px; padding: 0px 2px; font-weight: 500">
          {{ 'Amount Paid' | translate }}
        </h5>
      </th>
      <td mat-cell *matCellDef="let element" class="pad-l-xs" data-cy="table-col-amount-paid">
        <!-- Classic -->
        <ng-container *ngIf="element?.student_type?.type_of_formation === 'classic'">
          <ng-container *ngIf="checkNoPayment(element) && !checkIfCandidateTransferHasAmountPaid(element?.amount_paid)">
            <ng-container *ngIf="!element?.amount_paid || element?.amount_paid === 0 || element?.amount_paid === 0.0">
              <span style="color: #b7b7b7">X</span>
            </ng-container>
          </ng-container>

          <ng-container *ngIf="!checkNoPayment(element) || checkIfCandidateTransferHasAmountPaid(element?.amount_paid)">
            <ng-container *ngIf="!checkIfCandidateTransferHasAmountPaid(element?.amount_paid)">
              <span style="color: #b7b7b7">X</span>
            </ng-container>

            <ng-container
              *ngIf="
                element?.amount_paid !== 0 &&
                element?.amount_paid !== 0.0 &&
                element?.amount_paid !== '0' &&
                element?.amount_paid !== '0.00' &&
                element?.amount_paid !== ''
              "
            >
              {{ formatCurrencyHistory(element?.amount_paid) }}
            </ng-container>
            <ng-container
              *ngIf="
                element?.amount_paid === 0 ||
                element?.amount_paid === 0.0 ||
                element?.amount_paid === '0' ||
                element?.amount_paid === '0.00' ||
                element?.amount_paid === ''
              "
            >
              <span style="color: #b7b7b7">X</span>
            </ng-container>
          </ng-container>
        </ng-container>

        <!-- Continuous -->
        <ng-container *ngIf="element?.student_type?.type_of_formation !== 'classic'">
          <ng-container *ngIf="checkNoPayment(element) && !checkIfCandidateTransferHasAmountPaid(element?.amount_paid)">
            <ng-container *ngIf="!element?.amount_paid || element?.amount_paid === 0 || element?.amount_paid === 0.0">
              <span style="color: #b7b7b7">X</span>
            </ng-container>
          </ng-container>

          <ng-container *ngIf="!checkNoPayment(element) || checkIfCandidateTransferHasAmountPaid(element?.amount_paid)">
            <ng-container
              *ngIf="
                element?.amount_paid !== 0 &&
                element?.amount_paid !== 0.0 &&
                element?.amount_paid !== '0' &&
                element?.amount_paid !== '0.00' &&
                element?.amount_paid !== ''
              "
            >
              {{ formatCurrencyHistory(element?.amount_paid) }}
            </ng-container>
            <ng-container
              *ngIf="
                element?.amount_paid === 0 ||
                element?.amount_paid === 0.0 ||
                element?.amount_paid === '0' ||
                element?.amount_paid === '0.00' ||
                element?.amount_paid === ''
              "
            >
              <span style="color: #b7b7b7">X</span>
            </ng-container>
          </ng-container>
        </ng-container>
      </td>
    </ng-container>

    <ng-container matColumnDef="remainingDue">
      <th
        mat-header-cell
        *matHeaderCellDef
        matTooltip="{{ 'Remaining Due' | translate }}"
        matTooltipPosition="above"
        data-cy="table-col-remaining-due"
      >
        <h5 style="font-size: 11px; padding: 0px 2px; font-weight: 500">
          {{ 'Remaining Due' | translate }}
        </h5>
      </th>
      <td mat-cell *matCellDef="let element" class="pad-l-xs" data-cy="table-col-remaining-due">
        <!-- Classic -->
        <ng-container *ngIf="element?.student_type?.type_of_formation === 'classic'">
          <ng-container *ngIf="checkNoPayment(element)">
            <span style="color: #b7b7b7">X</span>
          </ng-container>

          <ng-container *ngIf="!checkNoPayment(element)">
            <ng-container
              *ngIf="
                element?.candidate_id?.candidate_admission_status === 'admitted' ||
                element?.candidate_id?.candidate_admission_status === 'admission_in_progress'
              "
            >
              <span style="color: #b7b7b7">X</span>
            </ng-container>

            <ng-container
              *ngIf="
                element?.candidate_id?.candidate_admission_status !== 'admitted' &&
                element?.candidate_id?.candidate_admission_status !== 'admission_in_progress' &&
                element?.remaining_billed !== 0 &&
                element?.remaining_billed !== '0' &&
                element?.remaining_billed !== 0.0 &&
                element?.remaining_billed !== '0.00'
              "
            >
              {{ formatCurrencyHistory(element?.remaining_billed) }}
            </ng-container>

            <ng-container
              *ngIf="
                element?.candidate_id?.candidate_admission_status !== 'admitted' &&
                element?.candidate_id?.candidate_admission_status !== 'admission_in_progress' &&
                (element?.remaining_billed === 0 ||
                  element?.remaining_billed === '0' ||
                  element?.remaining_billed === 0.0 ||
                  element?.remaining_billed === '0.00' ||
                  element?.remaining_billed === '')
              "
            >
              <span style="color: #b7b7b7">X</span>
            </ng-container>
          </ng-container>
        </ng-container>

        <!-- Continuous -->
        <ng-container *ngIf="element?.student_type?.type_of_formation !== 'classic'">
          <ng-container *ngIf="checkNoPayment(element)">
            <span style="color: #b7b7b7">X</span>
          </ng-container>

          <ng-container *ngIf="!checkNoPayment(element)">
            <ng-container
              *ngIf="
                element?.remaining_billed !== 0 &&
                element?.remaining_billed !== '0' &&
                element?.remaining_billed !== 0.0 &&
                element?.remaining_billed !== '0.00' &&
                element?.remaining_billed !== ''
              "
            >
              {{ formatCurrencyHistory(element?.remaining_billed) }}
            </ng-container>

            <ng-container
              *ngIf="
                element?.remaining_billed === 0 ||
                element?.remaining_billed === '0' ||
                element?.remaining_billed === 0.0 ||
                element?.remaining_billed === '0.00' ||
                element?.remaining_billed === ''
              "
            >
              <span style="color: #b7b7b7">X</span>
            </ng-container>
          </ng-container>
        </ng-container>
      </td>
    </ng-container>

    <ng-container matColumnDef="amountLate" data-cy="table-col-amount-late">
      <th mat-header-cell *matHeaderCellDef matTooltip="{{ 'Amount Late' | translate }}" matTooltipPosition="above">
        <h5 style="font-size: 11px; padding: 0px 2px; font-weight: 500">
          {{ 'Amount Late' | translate }}
        </h5>
      </th>
      <td mat-cell *matCellDef="let element" class="pad-l-xs" data-cy="table-col-amount-late">
        <!-- Classic -->
        <ng-container *ngIf="element?.student_type?.type_of_formation === 'classic'">
          <ng-container *ngIf="checkNoPayment(element)">
            <span style="color: #b7b7b7">X</span>
          </ng-container>

          <ng-container *ngIf="!checkNoPayment(element)">
            <ng-container
              *ngIf="
                element?.candidate_id?.candidate_admission_status === 'admitted' ||
                element?.candidate_id?.candidate_admission_status === 'admission_in_progress'
              "
            >
              <span style="color: #b7b7b7">X</span>
            </ng-container>

            <ng-container
              *ngIf="
                element?.candidate_id?.candidate_admission_status !== 'admitted' &&
                element?.candidate_id?.candidate_admission_status !== 'admission_in_progress'
              "
            >
              <span
                *ngIf="
                  element?.amount_late !== 0 &&
                  element?.amount_late !== 0.0 &&
                  element?.amount_late !== '0' &&
                  element?.amount_late !== '0.00' &&
                  element?.amount_late !== ''
                "
              >
                {{ formatCurrency(element?.amount_late) }}
              </span>
              <ng-container
                *ngIf="
                  element?.amount_late === 0 ||
                  element?.amount_late === 0.0 ||
                  element?.amount_late === '0' ||
                  element?.amount_late === '0.00' ||
                  element?.amount_late === ''
                "
              >
                <span
                  *ngIf="
                    element?.amount_billed === 0 ||
                    element?.amount_billed === 0.0 ||
                    element?.amount_billed === '0' ||
                    element?.amount_billed === '0.00'
                  "
                  style="color: #b7b7b7"
                  >X</span
                >
                <span
                  *ngIf="
                    element?.amount_billed !== 0 &&
                    element?.amount_billed !== 0.0 &&
                    element?.amount_billed !== '0' &&
                    element?.amount_billed !== '0.00'
                  "
                ></span>
              </ng-container>
            </ng-container>
          </ng-container>
        </ng-container>

        <!-- Continuous -->
        <ng-container *ngIf="element?.student_type?.type_of_formation !== 'classic'">
          <ng-container *ngIf="checkNoPayment(element)">
            <span style="color: #b7b7b7">X</span>
          </ng-container>

          <ng-container *ngIf="!checkNoPayment(element)">
            <span
              *ngIf="
                element?.amount_late !== 0 &&
                element?.amount_late !== 0.0 &&
                element?.amount_late !== '0' &&
                element?.amount_late !== '0.00' &&
                element?.amount_late !== ''
              "
            >
              {{ formatCurrency(element?.amount_late) }}
            </span>
            <ng-container
              *ngIf="
                element?.amount_late === 0 ||
                element?.amount_late === 0.0 ||
                element?.amount_late === '0' ||
                element?.amount_late === '0.00' ||
                element?.amount_late === ''
              "
            >
              <span
                *ngIf="
                  element?.amount_billed === 0 ||
                  element?.amount_billed === 0.0 ||
                  element?.amount_billed === '0' ||
                  element?.amount_billed === '0.00'
                "
                style="color: #b7b7b7"
                >X</span
              >
              <span
                *ngIf="
                  element?.amount_billed !== 0 &&
                  element?.amount_billed !== 0.0 &&
                  element?.amount_billed !== '0' &&
                  element?.amount_billed !== '0.00'
                "
              ></span>
            </ng-container>
          </ng-container>
        </ng-container>
      </td>
    </ng-container>

    <ng-container matColumnDef="accumulatedLate">
      <th
        mat-header-cell
        *matHeaderCellDef
        matTooltip="{{ 'Accumulated Late (d)' | translate }}"
        matTooltipPosition="above"
        data-cy="table-col-accumulated-late"
      >
        <h5 style="font-size: 11px; padding: 0px 2px; font-weight: 500">
          {{ 'Accumulated Late (d)' | translate }}
        </h5>
      </th>
      <td mat-cell *matCellDef="let element" class="pad-l-xs" data-cy="table-col-accumulated-late">
        <!-- Classic -->
        <ng-container *ngIf="element?.student_type?.type_of_formation === 'classic'">
          <ng-container *ngIf="checkNoPayment(element)">
            <span style="color: #b7b7b7">X</span>
          </ng-container>

          <ng-container *ngIf="!checkNoPayment(element)">
            <ng-container
              *ngIf="
                element?.candidate_id?.candidate_admission_status === 'admitted' ||
                element?.candidate_id?.candidate_admission_status === 'admission_in_progress'
              "
            >
              <span style="color: #b7b7b7">X</span>
            </ng-container>

            <ng-container
              *ngIf="
                element?.candidate_id?.candidate_admission_status !== 'admitted' &&
                element?.candidate_id?.candidate_admission_status !== 'admission_in_progress'
              "
            >
              <span
                *ngIf="
                  element?.accumulated_late !== 0 &&
                  element?.accumulated_late !== 0.0 &&
                  element?.accumulated_late !== '0' &&
                  element?.accumulated_late !== '0.00' &&
                  element?.accumulated_late !== ''
                "
                >{{ formatCurrency(element?.accumulated_late) }}</span
              >
              <ng-container
                *ngIf="
                  element?.accumulated_late === 0 ||
                  element?.accumulated_late === 0.0 ||
                  element?.accumulated_late === '0' ||
                  element?.accumulated_late === '0.00' ||
                  element?.accumulated_late === ''
                "
              >
                <span
                  *ngIf="
                    element?.amount_billed === 0 ||
                    element?.amount_billed === 0.0 ||
                    element?.amount_billed === '0' ||
                    element?.amount_billed === '0.00'
                  "
                  style="color: #b7b7b7"
                  >X</span
                >
                <span
                  *ngIf="
                    element?.amount_billed !== 0 &&
                    element?.amount_billed !== 0.0 &&
                    element?.amount_billed !== '0' &&
                    element?.amount_billed !== '0.00'
                  "
                ></span>
              </ng-container>
            </ng-container>
          </ng-container>
        </ng-container>

        <!-- Continuous -->
        <ng-container *ngIf="element?.student_type?.type_of_formation !== 'classic'">
          <ng-container *ngIf="checkNoPayment(element)">
            <span style="color: #b7b7b7">X</span>
          </ng-container>

          <ng-container *ngIf="!checkNoPayment(element)">
            <span
              *ngIf="
                element?.accumulated_late !== 0 &&
                element?.accumulated_late !== 0.0 &&
                element?.accumulated_late !== '0' &&
                element?.accumulated_late !== '0.00' &&
                element?.accumulated_late !== ''
              "
              >{{ formatCurrency(element?.accumulated_late) }}</span
            >
            <ng-container
              *ngIf="
                element?.accumulated_late === 0 ||
                element?.accumulated_late === 0.0 ||
                element?.accumulated_late === '0' ||
                element?.accumulated_late === '0.00' ||
                element?.accumulated_late === ''
              "
            >
              <span
                *ngIf="
                  element?.amount_billed === 0 ||
                  element?.amount_billed === 0.0 ||
                  element?.amount_billed === '0' ||
                  element?.amount_billed === '0.00'
                "
                style="color: #b7b7b7"
                >X</span
              >
              <span
                *ngIf="
                  element?.amount_billed !== 0 &&
                  element?.amount_billed !== 0.0 &&
                  element?.amount_billed !== '0' &&
                  element?.amount_billed !== '0.00'
                "
              ></span>
            </ng-container>
          </ng-container>
        </ng-container>
      </td>
    </ng-container>

    <!-- <ng-container matColumnDef="downPayment">
      <th mat-header-cell *matHeaderCellDef matTooltip="{{ 'Down Payment' | translate }}" matTooltipPosition="above">
        <h5 style="font-size: 11px">
          <mat-icon svgIcon="credit-card-check" class="mat-icon-svgIcon"> credit-card-check </mat-icon>
        </h5>
      </th>
      <td mat-cell *matCellDef="let element" class="pad-l-xs">
        <ng-container *ngIf="checkNoPayment(element) && !checkIfCandidateTransferHasDP(element?.deposit_pay_amount)">
          <span style="color: #b7b7b7">X</span>
        </ng-container>

        <ng-container *ngIf="!checkNoPayment(element) || checkIfCandidateTransferHasDP(element?.deposit_pay_amount)">
          <ng-container
            *ngIf="
              (element?.candidate_id?.candidate_admission_status === 'admitted' ||
                element?.candidate_id?.candidate_admission_status === 'admission_in_progress' ||
                checkHasNoDP(element)) &&
              !checkIfCandidateTransferHasDP(element?.deposit_pay_amount)
            "
          >
            <span style="color: #b7b7b7">X</span>
          </ng-container>

          <ng-container
            *ngIf="
              (element?.candidate_id?.candidate_admission_status !== 'admitted' &&
                element?.candidate_id?.candidate_admission_status !== 'admission_in_progress' &&
                element?.deposit !== 0) ||
              checkIfCandidateTransferHasDP(element?.deposit_pay_amount)
            "
          >
            <span *ngIf="element?.deposit && element?.deposit_pay_amount !== 0 && element?.deposit_pay_amount !== element?.deposit">
              <span class="deposit"
                >{{
                  checkIsNumber(element?.deposit_pay_amount)
                    ? formatCurrency(element?.deposit_pay_amount)
                    : (element?.deposit_pay_amount | currency: 'EURO':'':'0.2')
                }}
                <mat-icon matTooltipPosition="above" class="icon-status green" aria-hidden="true">lens </mat-icon>
              </span>
              <span
                >{{
                  checkIsNumber(element?.deposit - element?.deposit_pay_amount)
                    ? formatCurrency(element?.deposit - element?.deposit_pay_amount)
                    : (element?.deposit - element?.deposit_pay_amount | currency: 'EURO':'':'0.2')
                }}
                <mat-icon matTooltipPosition="above" class="icon-status red" aria-hidden="true">lens </mat-icon>
              </span>
            </span>
            <span *ngIf="element?.deposit_pay_amount === 0 || element?.deposit_pay_amount === element?.deposit">
              {{ element?.deposit ? formatCurrency(element?.deposit) : '' }}
              <mat-icon
                matTooltipPosition="above"
                [ngClass]="{
                  red: !element?.is_deposit_completed || !element?.deposit,
                  green: element?.is_deposit_completed && element?.deposit
                }"
                class="green icon-status"
                aria-hidden="true"
                >lens
              </mat-icon>
            </span>
          </ng-container>
        </ng-container>
      </td>
    </ng-container> -->

    <ng-container matColumnDef="notRespected">
      <th
        mat-header-cell
        *matHeaderCellDef
        matTooltip="{{ 'Terms Not respected' | translate }}"
        matTooltipPosition="above"
        data-cy="table-col-terms-not-respected"
      >
        <h5 style="font-size: 11px; padding: 0px 2px; font-weight: 500">
          {{ 'Terms Not respected' | translate }}
        </h5>
      </th>
      <td mat-cell *matCellDef="let element" class="pad-l-xs" data-cy="table-col-terms-not-respected">
        <!-- Classic -->
        <ng-container *ngIf="element?.student_type?.type_of_formation === 'classic'">
          <ng-container *ngIf="checkNoPayment(element)">
            <span style="color: #b7b7b7">X</span>
          </ng-container>

          <ng-container *ngIf="!checkNoPayment(element)">
            <ng-container
              *ngIf="
                element?.candidate_id?.candidate_admission_status === 'admitted' ||
                element?.candidate_id?.candidate_admission_status === 'admission_in_progress'
              "
            >
              <span style="color: #b7b7b7">X</span>
            </ng-container>

            <ng-container
              *ngIf="
                element?.candidate_id?.candidate_admission_status !== 'admitted' &&
                element?.candidate_id?.candidate_admission_status !== 'admission_in_progress'
              "
            >
              <span *ngIf="element?.overdue !== 0 && element?.overdue !== ''">{{ formatCurrency(element?.overdue) }}</span>
              <ng-container *ngIf="element?.overdue === 0 || element?.overdue === ''">
                <span
                  *ngIf="
                    element?.amount_billed === 0 ||
                    element?.amount_billed === 0.0 ||
                    element?.amount_billed === '0' ||
                    element?.amount_billed === '0.00'
                  "
                  style="color: #b7b7b7"
                  >X</span
                >
                <span
                  *ngIf="
                    element?.amount_billed !== 0 &&
                    element?.amount_billed !== 0.0 &&
                    element?.amount_billed !== '0' &&
                    element?.amount_billed !== '0.00'
                  "
                ></span>
              </ng-container>
            </ng-container>
          </ng-container>
        </ng-container>

        <!-- Continuous -->
        <ng-container *ngIf="element?.student_type?.type_of_formation !== 'classic'">
          <ng-container *ngIf="checkNoPayment(element)">
            <span style="color: #b7b7b7">X</span>
          </ng-container>

          <ng-container *ngIf="!checkNoPayment(element)">
            <span *ngIf="element?.overdue !== 0 && element?.overdue !== ''">{{ formatCurrency(element?.overdue) }}</span>
            <ng-container *ngIf="element?.overdue === 0 || element?.overdue === ''">
              <span
                *ngIf="
                  element?.amount_billed === 0 ||
                  element?.amount_billed === 0.0 ||
                  element?.amount_billed === '0' ||
                  element?.amount_billed === '0.00'
                "
                style="color: #b7b7b7"
                >X</span
              >
              <span
                *ngIf="
                  element?.amount_billed !== 0 &&
                  element?.amount_billed !== 0.0 &&
                  element?.amount_billed !== '0' &&
                  element?.amount_billed !== '0.00'
                "
              ></span>
            </ng-container>
          </ng-container>
        </ng-container>
      </td>
    </ng-container>

    <ng-container matColumnDef="notSettled">
      <th
        mat-header-cell
        *matHeaderCellDef
        matTooltip="{{ 'Terms Not Respected & till not Settled up today' | translate }}"
        matTooltipPosition="above"
        data-cy="table-col-terms-not-settled"
      >
        <h5 style="font-size: 11px; padding: 0px 2px; font-weight: 500">
          {{ 'Terms Not Respected & till not Settled up today' | translate }}
        </h5>
      </th>
      <td mat-cell *matCellDef="let element" class="pad-l-xs" data-cy="table-col-terms-not-settled">
        <!-- Classic -->
        <ng-container *ngIf="element?.student_type?.type_of_formation === 'classic'">
          <ng-container *ngIf="checkNoPayment(element)">
            <span style="color: #b7b7b7">X</span>
          </ng-container>

          <ng-container *ngIf="!checkNoPayment(element)">
            <ng-container
              *ngIf="
                element?.candidate_id?.candidate_admission_status === 'admitted' ||
                element?.candidate_id?.candidate_admission_status === 'admission_in_progress'
              "
            >
              <span style="color: #b7b7b7">X</span>
            </ng-container>

            <ng-container
              *ngIf="
                element?.candidate_id?.candidate_admission_status !== 'admitted' &&
                element?.candidate_id?.candidate_admission_status !== 'admission_in_progress'
              "
            >
              <span *ngIf="element?.overdue_not_paid !== 0 && element?.overdue_not_paid !== ''">{{
                formatCurrency(element?.overdue_not_paid)
              }}</span>
              <ng-container *ngIf="element?.overdue_not_paid === 0 || element?.overdue_not_paid === ''">
                <span
                  *ngIf="
                    element?.amount_billed === 0 ||
                    element?.amount_billed === 0.0 ||
                    element?.amount_billed === '0' ||
                    element?.amount_billed === '0.00'
                  "
                  style="color: #b7b7b7"
                  >X</span
                >
                <span
                  *ngIf="
                    element?.amount_billed !== 0 &&
                    element?.amount_billed !== 0.0 &&
                    element?.amount_billed !== '0' &&
                    element?.amount_billed !== '0.00'
                  "
                ></span>
              </ng-container>
            </ng-container>
          </ng-container>
        </ng-container>

        <!-- Continuous -->
        <ng-container *ngIf="element?.student_type?.type_of_formation !== 'classic'">
          <ng-container *ngIf="checkNoPayment(element)">
            <span style="color: #b7b7b7">X</span>
          </ng-container>

          <ng-container *ngIf="!checkNoPayment(element)">
            <span *ngIf="element?.overdue_not_paid !== 0 && element?.overdue_not_paid !== ''">{{
              formatCurrency(element?.overdue_not_paid)
            }}</span>
            <ng-container *ngIf="element?.overdue_not_paid === 0 || element?.overdue_not_paid === ''">
              <span
                *ngIf="
                  element?.amount_billed === 0 ||
                  element?.amount_billed === 0.0 ||
                  element?.amount_billed === '0' ||
                  element?.amount_billed === '0.00'
                "
                style="color: #b7b7b7"
                >X</span
              >
              <span
                *ngIf="
                  element?.amount_billed !== 0 &&
                  element?.amount_billed !== 0.0 &&
                  element?.amount_billed !== '0' &&
                  element?.amount_billed !== '0.00'
                "
              ></span>
            </ng-container>
          </ng-container>
        </ng-container>
      </td>
    </ng-container>

    <ng-container matColumnDef="term1">
      <th
        mat-header-cell
        *matHeaderCellDef="let element"
        matTooltip="{{ 'Term 1' | translate }}"
        matTooltipPosition="above"
        data-cy="table-col-term-1"
      >
        <h5 style="font-size: 11px">
          <mat-icon svgIcon="numeric-1-box" class="mat-icon-svgIcon"> numeric-1-box </mat-icon>
          <span class="date-term">{{ 'August' | translate }}</span>
        </h5>
      </th>
      <td mat-cell *matCellDef="let element" [matTooltip]="element?.term_1" class="pad-l-xs">
        <!-- <ng-container *ngIf="checkNoPayment(element)">
          <div *ngIf="(element && !element?.terms_1) || !element?.terms_1?.term_amount" style="color: #b7b7b7">X</div>
        </ng-container> -->

        <ng-container>
          <ng-container *ngIf="(element && !element?.terms_1) || element?.terms_1?.length < 1">
            <span style="color: #b7b7b7">X</span>
          </ng-container>

          <ng-container *ngIf="element && element?.terms_1?.length === 1">
            <ng-container *ngFor="let term of element?.terms_1">
              <div style="text-align: end; margin-right: 8px" *ngIf="term">
                <span class="date-terms"
                  >{{
                    term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount
                      ? checkIsNumber(term?.term_pay_amount)
                        ? formatCurrency(term?.term_pay_amount)
                        : (term?.term_pay_amount | currency : 'EURO' : '' : '0.2')
                      : ''
                  }}
                  <mat-icon
                    *ngIf="term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount"
                    matTooltipPosition="above"
                    class="icon-status green"
                    aria-hidden="true"
                    >lens
                  </mat-icon></span
                >
                <span *ngIf="!term?.is_partial"
                  >{{
                    checkIsNumber(term?.term_amount)
                      ? formatCurrency(term?.term_amount)
                      : (term?.term_amount | currency : 'EURO' : '' : '0.2')
                  }}
                  <mat-icon *ngIf="term?.term_status === 'billed'" matTooltipPosition="above" class="icon-status blue" aria-hidden="true"
                    >lens
                  </mat-icon>
                </span>
                <span *ngIf="term?.is_partial"
                  >{{
                    checkIsNumber(term?.term_amount - term?.term_pay_amount)
                      ? formatCurrency(term?.term_amount - term?.term_pay_amount)
                      : (term?.term_amount - term?.term_pay_amount | currency : 'EURO' : '' : '0.2')
                  }}
                  <mat-icon matTooltipPosition="above" class="icon-status blue" aria-hidden="true">lens </mat-icon>
                </span>
                <mat-icon
                  *ngIf="term?.is_term_paid && !term?.is_partial"
                  matTooltipPosition="above"
                  class="icon-status green"
                  aria-hidden="true"
                  >lens
                </mat-icon>
                <!-- <mat-icon
                  *ngIf="
                    ((checkPaymentLate(term?.term_payment?.date) &&
                      !term?.is_term_paid &&
                      term?.term_amount) ||
                      checkPartiallyTerms(term)) &&
                    term?.term_status === 'not_billed'
                  "
                  matTooltipPosition="above"
                  class="icon-status red"
                  aria-hidden="true"
                  [ngClass]="{
                    none:
                      changedPlan(term) &&
                      term?.term_payment_deferment?.date &&
                      term?.term_status === 'not_billed'
                  }"
                  >lens
                </mat-icon>
                <span class="date-terms" *ngIf="term?.term_payment_deferment?.date">{{
                  term?.term_payment_deferment?.date ? term?.term_payment_deferment?.date : ''
                }}</span> -->
              </div>
            </ng-container>
          </ng-container>

          <ng-container *ngIf="element?.terms_1?.length > 1">
            <button
              mat-icon-button
              class="margin-right-button view-term"
              matTooltip="{{ 'View term' | translate }}"
              (click)="viewTermDetail(element?.terms_1, 'August')"
            >
              <mat-icon svgIcon="eye"></mat-icon>
            </button>
          </ng-container>
        </ng-container>
      </td>
    </ng-container>

    <ng-container matColumnDef="term2">
      <th
        mat-header-cell
        *matHeaderCellDef="let element"
        matTooltip="{{ 'Term 2' | translate }}"
        matTooltipPosition="above"
        data-cy="table-col-term-2"
      >
        <h5 style="font-size: 11px">
          <mat-icon svgIcon="numeric-2-box" class="mat-icon-svgIcon"> numeric-2-box </mat-icon>
          <span class="date-term">{{ 'September' | translate }}</span>
        </h5>
      </th>
      <td mat-cell *matCellDef="let element" [matTooltip]="element?.term_2" class="pad-l-xs">
        <!-- <ng-container *ngIf="checkNoPayment(element)">
          <div *ngIf="(element && !element?.terms_2) || !element?.terms_2?.term_amount" style="color: #b7b7b7">X</div>
        </ng-container> -->

        <ng-container>
          <ng-container *ngIf="(element && !element?.terms_2) || element?.terms_2?.length < 1">
            <span style="color: #b7b7b7">X</span>
          </ng-container>

          <ng-container *ngIf="element && element?.terms_2?.length === 1">
            <ng-container *ngFor="let term of element?.terms_2">
              <div style="text-align: end; margin-right: 8px" *ngIf="term">
                <span class="date-terms"
                  >{{
                    term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount
                      ? checkIsNumber(term?.term_pay_amount)
                        ? formatCurrency(term?.term_pay_amount)
                        : (term?.term_pay_amount | currency : 'EURO' : '' : '0.2')
                      : ''
                  }}
                  <mat-icon
                    *ngIf="term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount"
                    matTooltipPosition="above"
                    class="icon-status green"
                    aria-hidden="true"
                    >lens
                  </mat-icon></span
                >
                <span *ngIf="!term?.is_partial"
                  >{{
                    checkIsNumber(term?.term_amount)
                      ? formatCurrency(term?.term_amount)
                      : (term?.term_amount | currency : 'EURO' : '' : '0.2')
                  }}
                  <mat-icon *ngIf="term.term_status === 'billed'" matTooltipPosition="above" class="icon-status blue" aria-hidden="true"
                    >lens
                  </mat-icon>
                </span>
                <span *ngIf="term?.is_partial"
                  >{{
                    checkIsNumber(term?.term_amount - term?.term_pay_amount)
                      ? formatCurrency(term?.term_amount - term?.term_pay_amount)
                      : (term?.term_amount - term?.term_pay_amount | currency : 'EURO' : '' : '0.2')
                  }}
                  <mat-icon matTooltipPosition="above" class="icon-status blue" aria-hidden="true">lens </mat-icon>
                </span>
                <mat-icon
                  *ngIf="term?.is_term_paid && !term?.is_partial"
                  matTooltipPosition="above"
                  class="icon-status green"
                  aria-hidden="true"
                  >lens
                </mat-icon>
                <!-- <mat-icon
                  *ngIf="
                    ((checkPaymentLate(term?.term_payment?.date) &&
                      !term?.is_term_paid &&
                      term?.term_amount) ||
                      checkPartiallyTerms(term)) &&
                    term?.term_status === 'not_billed'
                  "
                  matTooltipPosition="above"
                  class="icon-status red"
                  aria-hidden="true"
                  [ngClass]="{
                    none:
                      changedPlan(term) &&
                      term?.term_payment_deferment?.date &&
                      term?.term_status === 'not_billed'
                  }"
                  >lens
                </mat-icon>
                <span class="date-terms" *ngIf="term?.term_payment_deferment?.date">{{
                  term?.term_payment_deferment?.date ? term?.term_payment_deferment?.date : ''
                }}</span> -->
              </div>
            </ng-container>
          </ng-container>
          <ng-container *ngIf="element?.terms_2?.length > 1">
            <button
              mat-icon-button
              class="margin-right-button view-term"
              matTooltip="{{ 'View term' | translate }}"
              (click)="viewTermDetail(element?.terms_2, 'September')"
            >
              <mat-icon svgIcon="eye"></mat-icon>
            </button>
          </ng-container>
        </ng-container>
      </td>
    </ng-container>

    <ng-container matColumnDef="term3">
      <th
        mat-header-cell
        *matHeaderCellDef="let element"
        matTooltip="{{ 'Term 3' | translate }}"
        matTooltipPosition="above"
        data-cy="table-col-term-3"
      >
        <h5 style="font-size: 11px">
          <mat-icon svgIcon="numeric-3-box" class="mat-icon-svgIcon"> numeric-3-box </mat-icon>
          <span class="date-term">{{ 'October' | translate }}</span>
        </h5>
      </th>
      <td mat-cell *matCellDef="let element" [matTooltip]="element?.term_3" class="pad-l-xs">
        <!-- <ng-container *ngIf="checkNoPayment(element)">
          <div *ngIf="(element && !element?.terms_3) || !element?.terms_3?.term_amount" style="color: #b7b7b7">X</div>
        </ng-container> -->

        <ng-container>
          <ng-container *ngIf="(element && !element?.terms_3) || element?.terms_3?.length < 1">
            <span style="color: #b7b7b7">X</span>
          </ng-container>

          <ng-container *ngIf="element && element?.terms_3?.length === 1">
            <ng-container *ngFor="let term of element?.terms_3">
              <div style="text-align: end; margin-right: 8px" *ngIf="term">
                <span class="date-terms"
                  >{{
                    term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount
                      ? checkIsNumber(term?.term_pay_amount)
                        ? formatCurrency(term?.term_pay_amount)
                        : (term?.term_pay_amount | currency : 'EURO' : '' : '0.2')
                      : ''
                  }}
                  <mat-icon
                    *ngIf="term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount"
                    matTooltipPosition="above"
                    class="icon-status green"
                    aria-hidden="true"
                    >lens
                  </mat-icon></span
                >
                <span *ngIf="!term?.is_partial"
                  >{{
                    checkIsNumber(term?.term_amount)
                      ? formatCurrency(term?.term_amount)
                      : (term?.term_amount | currency : 'EURO' : '' : '0.2')
                  }}
                  <mat-icon *ngIf="term.term_status === 'billed'" matTooltipPosition="above" class="icon-status blue" aria-hidden="true"
                    >lens
                  </mat-icon>
                </span>
                <span *ngIf="term?.is_partial"
                  >{{
                    checkIsNumber(term?.term_amount - term?.term_pay_amount)
                      ? formatCurrency(term?.term_amount - term?.term_pay_amount)
                      : (term?.term_amount - term?.term_pay_amount | currency : 'EURO' : '' : '0.2')
                  }}
                  <mat-icon matTooltipPosition="above" class="icon-status blue" aria-hidden="true">lens </mat-icon>
                </span>
                <mat-icon
                  *ngIf="term?.is_term_paid && !term?.is_partial"
                  matTooltipPosition="above"
                  class="icon-status green"
                  aria-hidden="true"
                  >lens
                </mat-icon>
                <!-- <mat-icon
                  *ngIf="
                    ((checkPaymentLate(term?.term_payment?.date) &&
                      !term?.is_term_paid &&
                      term?.term_amount) ||
                      checkPartiallyTerms(term)) &&
                    term?.term_status === 'not_billed'
                  "
                  matTooltipPosition="above"
                  class="icon-status red"
                  aria-hidden="true"
                  [ngClass]="{
                    none:
                      changedPlan(term) &&
                      term?.term_payment_deferment?.date &&
                      term?.term_status === 'not_billed'
                  }"
                  >lens
                </mat-icon>
                <span class="date-terms" *ngIf="term?.term_payment_deferment?.date">{{
                  term?.term_payment_deferment?.date ? term?.term_payment_deferment?.date : ''
                }}</span> -->
              </div>
            </ng-container>
          </ng-container>
          <ng-container *ngIf="element?.terms_3?.length > 1">
            <button
              mat-icon-button
              class="margin-right-button view-term"
              matTooltip="{{ 'View term' | translate }}"
              (click)="viewTermDetail(element?.terms_3, 'October')"
            >
              <mat-icon svgIcon="eye"></mat-icon>
            </button>
          </ng-container>
        </ng-container>
      </td>
    </ng-container>

    <ng-container matColumnDef="term4">
      <th
        mat-header-cell
        *matHeaderCellDef="let element"
        matTooltip="{{ 'Term 4' | translate }}"
        matTooltipPosition="above"
        data-cy="table-col-term-4"
      >
        <h5 style="font-size: 11px">
          <mat-icon svgIcon="numeric-4-box" class="mat-icon-svgIcon"> numeric-4-box </mat-icon>
          <span class="date-term">{{ 'November' | translate }}</span>
        </h5>
      </th>
      <td mat-cell *matCellDef="let element" [matTooltip]="element?.term_4" class="pad-l-xs">
        <!-- <ng-container *ngIf="checkNoPayment(element)">
          <div *ngIf="(element && !element?.terms_4) || !element?.terms_4?.term_amount" style="color: #b7b7b7">X</div>
        </ng-container> -->

        <ng-container>
          <ng-container *ngIf="(element && !element?.terms_4) || element?.terms_4?.length < 1">
            <span style="color: #b7b7b7">X</span>
          </ng-container>

          <ng-container *ngIf="element && element?.terms_4.length === 1">
            <ng-container *ngFor="let term of element?.terms_4">
              <div style="text-align: end; margin-right: 8px" *ngIf="term">
                <span class="date-terms"
                  >{{
                    term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount
                      ? checkIsNumber(term?.term_pay_amount)
                        ? formatCurrency(term?.term_pay_amount)
                        : (term?.term_pay_amount | currency : 'EURO' : '' : '0.2')
                      : ''
                  }}
                  <mat-icon
                    *ngIf="term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount"
                    matTooltipPosition="above"
                    class="icon-status green"
                    aria-hidden="true"
                    >lens
                  </mat-icon></span
                >
                <span *ngIf="!term?.is_partial"
                  >{{
                    checkIsNumber(term?.term_amount)
                      ? formatCurrency(term?.term_amount)
                      : (term?.term_amount | currency : 'EURO' : '' : '0.2')
                  }}
                  <mat-icon *ngIf="term.term_status === 'billed'" matTooltipPosition="above" class="icon-status blue" aria-hidden="true"
                    >lens
                  </mat-icon>
                </span>
                <span *ngIf="term?.is_partial"
                  >{{
                    checkIsNumber(term?.term_amount - term?.term_pay_amount)
                      ? formatCurrency(term?.term_amount - term?.term_pay_amount)
                      : (term?.term_amount - term?.term_pay_amount | currency : 'EURO' : '' : '0.2')
                  }}
                  <mat-icon matTooltipPosition="above" class="icon-status blue" aria-hidden="true">lens </mat-icon>
                </span>
                <mat-icon
                  *ngIf="term?.is_term_paid && !term?.is_partial"
                  matTooltipPosition="above"
                  class="icon-status green"
                  aria-hidden="true"
                  >lens
                </mat-icon>
                <!-- <mat-icon
                  *ngIf="
                    ((checkPaymentLate(term?.term_payment?.date) &&
                      !term?.is_term_paid &&
                      term?.term_amount) ||
                      checkPartiallyTerms(term)) &&
                    term?.term_status === 'not_billed'
                  "
                  matTooltipPosition="above"
                  class="icon-status red"
                  aria-hidden="true"
                  [ngClass]="{
                    none:
                      changedPlan(term) &&
                      term?.term_payment_deferment?.date &&
                      term?.term_status === 'not_billed'
                  }"
                  >lens
                </mat-icon>
                <span class="date-terms" *ngIf="term?.term_payment_deferment?.date">{{
                  term?.term_payment_deferment?.date ? term?.term_payment_deferment?.date : ''
                }}</span> -->
              </div>
            </ng-container>
          </ng-container>

          <ng-container *ngIf="element?.terms_4?.length > 1">
            <button
              mat-icon-button
              class="margin-right-button view-term"
              matTooltip="{{ 'View term' | translate }}"
              (click)="viewTermDetail(element?.terms_4, 'November')"
            >
              <mat-icon svgIcon="eye"></mat-icon>
            </button>
          </ng-container>
        </ng-container>
      </td>
    </ng-container>

    <ng-container matColumnDef="term5">
      <th
        mat-header-cell
        *matHeaderCellDef="let element"
        matTooltip="{{ 'Term 5' | translate }}"
        matTooltipPosition="above"
        data-cy="table-col-term-5"
      >
        <h5 style="font-size: 11px">
          <mat-icon svgIcon="numeric-5-box" class="mat-icon-svgIcon"> numeric-5-box </mat-icon>
          <span class="date-term">{{ 'December' | translate }}</span>
        </h5>
      </th>
      <td mat-cell *matCellDef="let element" [matTooltip]="element?.term_5" class="pad-l-xs">
        <!-- <ng-container *ngIf="checkNoPayment(element)">
          <div *ngIf="(element && !element?.terms_5) || !element?.terms_5?.term_amount" style="color: #b7b7b7">X</div>
        </ng-container> -->

        <ng-container>
          <ng-container *ngIf="(element && !element?.terms_5) || element?.terms_5?.length < 1">
            <span style="color: #b7b7b7">X</span>
          </ng-container>

          <ng-container *ngIf="element && element?.terms_5?.length === 1">
            <ng-container *ngFor="let term of element?.terms_5">
              <div style="text-align: end; margin-right: 8px" *ngIf="term">
                <span class="date-terms"
                  >{{
                    term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount
                      ? checkIsNumber(term?.term_pay_amount)
                        ? formatCurrency(term?.term_pay_amount)
                        : (term?.term_pay_amount | currency : 'EURO' : '' : '0.2')
                      : ''
                  }}
                  <mat-icon
                    *ngIf="term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount"
                    matTooltipPosition="above"
                    class="icon-status green"
                    aria-hidden="true"
                    >lens
                  </mat-icon></span
                >
                <span *ngIf="!term?.is_partial"
                  >{{
                    checkIsNumber(term?.term_amount)
                      ? formatCurrency(term?.term_amount)
                      : (term?.term_amount | currency : 'EURO' : '' : '0.2')
                  }}
                  <mat-icon *ngIf="term.term_status === 'billed'" matTooltipPosition="above" class="icon-status blue" aria-hidden="true"
                    >lens
                  </mat-icon>
                </span>
                <span *ngIf="term?.is_partial"
                  >{{
                    checkIsNumber(term?.term_amount - term?.term_pay_amount)
                      ? formatCurrency(term?.term_amount - term?.term_pay_amount)
                      : (term?.term_amount - term?.term_pay_amount | currency : 'EURO' : '' : '0.2')
                  }}
                  <mat-icon matTooltipPosition="above" class="icon-status blue" aria-hidden="true">lens </mat-icon>
                </span>
                <mat-icon
                  *ngIf="term?.is_term_paid && !term?.is_partial"
                  matTooltipPosition="above"
                  class="icon-status green"
                  aria-hidden="true"
                  >lens
                </mat-icon>
                <!-- <mat-icon
                *ngIf="
                  ((checkPaymentLate(term?.term_payment?.date) &&
                    !term?.is_term_paid &&
                    term?.term_amount) ||
                    checkPartiallyTerms(term)) &&
                  term?.term_status === 'not_billed'
                "
                matTooltipPosition="above"
                class="icon-status red"
                aria-hidden="true"
                [ngClass]="{
                  none:
                    changedPlan(term) &&
                    term?.term_payment_deferment?.date &&
                    term?.term_status === 'not_billed'
                }"
                >lens
              </mat-icon>
              <span class="date-terms" *ngIf="term?.term_payment_deferment?.date">{{
                term?.term_payment_deferment?.date ? term?.term_payment_deferment?.date : ''
              }}</span> -->
              </div>
            </ng-container>
          </ng-container>

          <ng-container *ngIf="element?.terms_5?.length > 1">
            <button
              mat-icon-button
              class="margin-right-button view-term"
              matTooltip="{{ 'View term' | translate }}"
              (click)="viewTermDetail(element?.terms_5, 'December')"
            >
              <mat-icon svgIcon="eye"></mat-icon>
            </button>
          </ng-container>
        </ng-container>
      </td>
    </ng-container>

    <ng-container matColumnDef="term6">
      <th
        mat-header-cell
        *matHeaderCellDef="let element"
        matTooltip="{{ 'Term 6' | translate }}"
        matTooltipPosition="above"
        data-cy="table-col-term-6"
      >
        <h5 style="font-size: 11px">
          <mat-icon svgIcon="numeric-6-box" class="mat-icon-svgIcon"> numeric-6-box </mat-icon>
          <span class="date-term">{{ 'January' | translate }}</span>
        </h5>
      </th>
      <td mat-cell *matCellDef="let element" [matTooltip]="element?.term_6" class="pad-l-xs">
        <!-- <ng-container *ngIf="checkNoPayment(element)">
          <div *ngIf="(element && !element?.terms_6) || !element?.terms_6?.term_amount" style="color: #b7b7b7">X</div>
        </ng-container> -->

        <ng-container>
          <ng-container *ngIf="(element && !element?.terms_6) || element?.terms_6?.length < 1">
            <span style="color: #b7b7b7">X</span>
          </ng-container>

          <ng-container *ngIf="element && element?.terms_6.length === 1">
            <ng-container *ngFor="let term of element?.terms_6">
              <div style="text-align: end; margin-right: 8px" *ngIf="term">
                <span class="date-terms"
                  >{{
                    term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount
                      ? checkIsNumber(term?.term_pay_amount)
                        ? formatCurrency(term?.term_pay_amount)
                        : (term?.term_pay_amount | currency : 'EURO' : '' : '0.2')
                      : ''
                  }}
                  <mat-icon
                    *ngIf="term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount"
                    matTooltipPosition="above"
                    class="icon-status green"
                    aria-hidden="true"
                    >lens
                  </mat-icon></span
                >
                <span *ngIf="!term?.is_partial"
                  >{{
                    checkIsNumber(term?.term_amount)
                      ? formatCurrency(term?.term_amount)
                      : (term?.term_amount | currency : 'EURO' : '' : '0.2')
                  }}
                  <mat-icon *ngIf="term.term_status === 'billed'" matTooltipPosition="above" class="icon-status blue" aria-hidden="true"
                    >lens
                  </mat-icon>
                </span>
                <span *ngIf="term?.is_partial"
                  >{{
                    checkIsNumber(term?.term_amount - term?.term_pay_amount)
                      ? formatCurrency(term?.term_amount - term?.term_pay_amount)
                      : (term?.term_amount - term?.term_pay_amount | currency : 'EURO' : '' : '0.2')
                  }}
                  <mat-icon matTooltipPosition="above" class="icon-status blue" aria-hidden="true">lens </mat-icon>
                </span>
                <mat-icon
                  *ngIf="term?.is_term_paid && !term?.is_partial"
                  matTooltipPosition="above"
                  class="icon-status green"
                  aria-hidden="true"
                  >lens
                </mat-icon>
                <!-- <mat-icon
                  *ngIf="
                    ((checkPaymentLate(term?.term_payment?.date) &&
                      !term?.is_term_paid &&
                      term?.term_amount) ||
                      checkPartiallyTerms(term)) &&
                    term?.term_status === 'not_billed'
                  "
                  matTooltipPosition="above"
                  class="icon-status red"
                  aria-hidden="true"
                  [ngClass]="{
                    none:
                      changedPlan(term) &&
                      term?.term_payment_deferment?.date &&
                      term?.term_status === 'not_billed'
                  }"
                  >lens
                </mat-icon>
                <span class="date-terms" *ngIf="term?.term_payment_deferment?.date">{{
                  term?.term_payment_deferment?.date ? term?.term_payment_deferment?.date : ''
                }}</span> -->
              </div>
            </ng-container>
          </ng-container>

          <ng-container *ngIf="element?.terms_6?.length > 1">
            <button
              mat-icon-button
              class="margin-right-button view-term"
              matTooltip="{{ 'View term' | translate }}"
              (click)="viewTermDetail(element?.terms_6, 'January')"
            >
              <mat-icon svgIcon="eye"></mat-icon>
            </button>
          </ng-container>
        </ng-container>
      </td>
    </ng-container>

    <ng-container matColumnDef="term7">
      <th
        mat-header-cell
        *matHeaderCellDef="let element"
        matTooltip="{{ 'Term 7' | translate }}"
        matTooltipPosition="above"
        data-cy="table-col-term-7"
      >
        <h5 style="font-size: 11px">
          <mat-icon svgIcon="numeric-7-box" class="mat-icon-svgIcon"> numeric-7-box </mat-icon>
          <span class="date-term">{{ 'February' | translate }}</span>
        </h5>
      </th>
      <td mat-cell *matCellDef="let element" [matTooltip]="element?.term_7" class="pad-l-xs">
        <!-- <ng-container *ngIf="checkNoPayment(element)">
          <div *ngIf="(element && !element?.terms_7) || !element?.terms_7?.term_amount" style="color: #b7b7b7">X</div>
        </ng-container> -->

        <ng-container>
          <ng-container *ngIf="(element && !element?.terms_7) || element?.terms_7?.length < 1">
            <span style="color: #b7b7b7">X</span>
          </ng-container>

          <ng-container *ngIf="element && element?.terms_7.length === 1">
            <ng-container *ngFor="let term of element?.terms_7">
              <div style="text-align: end; margin-right: 8px" *ngIf="term">
                <span class="date-terms"
                  >{{
                    term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount
                      ? checkIsNumber(term?.term_pay_amount)
                        ? formatCurrency(term?.term_pay_amount)
                        : (term?.term_pay_amount | currency : 'EURO' : '' : '0.2')
                      : ''
                  }}
                  <mat-icon
                    *ngIf="term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount"
                    matTooltipPosition="above"
                    class="icon-status green"
                    aria-hidden="true"
                    >lens
                  </mat-icon></span
                >
                <span *ngIf="!term?.is_partial"
                  >{{
                    checkIsNumber(term?.term_amount)
                      ? formatCurrency(term?.term_amount)
                      : (term?.term_amount | currency : 'EURO' : '' : '0.2')
                  }}
                  <mat-icon *ngIf="term.term_status === 'billed'" matTooltipPosition="above" class="icon-status blue" aria-hidden="true"
                    >lens
                  </mat-icon>
                </span>
                <span *ngIf="term?.is_partial"
                  >{{
                    checkIsNumber(term?.term_amount - term?.term_pay_amount)
                      ? formatCurrency(term?.term_amount - term?.term_pay_amount)
                      : (term?.term_amount - term?.term_pay_amount | currency : 'EURO' : '' : '0.2')
                  }}
                  <mat-icon matTooltipPosition="above" class="icon-status blue" aria-hidden="true">lens </mat-icon>
                </span>
                <mat-icon
                  *ngIf="term?.is_term_paid && !term?.is_partial"
                  matTooltipPosition="above"
                  class="icon-status green"
                  aria-hidden="true"
                  >lens
                </mat-icon>
                <!-- <mat-icon
                  *ngIf="
                    ((checkPaymentLate(term?.term_payment?.date) &&
                      !term?.is_term_paid &&
                      term?.term_amount) ||
                      checkPartiallyTerms(term)) &&
                    term?.term_status === 'not_billed'
                  "
                  matTooltipPosition="above"
                  class="icon-status red"
                  aria-hidden="true"
                  [ngClass]="{
                    none:
                      changedPlan(term) &&
                      term?.term_payment_deferment?.date &&
                      term?.term_status === 'not_billed'
                  }"
                  >lens
                </mat-icon>
                <span class="date-terms" *ngIf="term?.term_payment_deferment?.date">{{
                  term?.term_payment_deferment?.date ? term?.term_payment_deferment?.date : ''
                }}</span> -->
              </div>
            </ng-container>
          </ng-container>

          <ng-container *ngIf="element?.terms_7?.length > 1">
            <button
              mat-icon-button
              class="margin-right-button view-term"
              matTooltip="{{ 'View term' | translate }}"
              (click)="viewTermDetail(element?.terms_7, 'February')"
            >
              <mat-icon svgIcon="eye"></mat-icon>
            </button>
          </ng-container>
        </ng-container>
      </td>
    </ng-container>

    <ng-container matColumnDef="term8">
      <th
        mat-header-cell
        *matHeaderCellDef="let element"
        matTooltip="{{ 'Term 8' | translate }}"
        matTooltipPosition="above"
        data-cy="table-col-term-8"
      >
        <h5 style="font-size: 11px">
          <mat-icon svgIcon="numeric-8-box" class="mat-icon-svgIcon"> numeric-8-box </mat-icon>
          <span class="date-term">{{ 'March' | translate }}</span>
        </h5>
      </th>
      <td mat-cell *matCellDef="let element" [matTooltip]="element?.term_8" class="pad-l-xs">
        <!-- <ng-container *ngIf="checkNoPayment(element)">
          <div *ngIf="(element && !element?.terms_8) || !element?.terms_8?.term_amount" style="color: #b7b7b7">X</div>
        </ng-container> -->

        <ng-container>
          <ng-container *ngIf="(element && !element?.terms_8) || element?.terms_8?.length < 1">
            <span style="color: #b7b7b7">X</span>
          </ng-container>

          <ng-container *ngIf="element && element?.terms_8.length === 1">
            <ng-container *ngFor="let term of element?.terms_8">
              <div style="text-align: end; margin-right: 8px" *ngIf="term">
                <span class="date-terms"
                  >{{
                    term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount
                      ? checkIsNumber(term?.term_pay_amount)
                        ? formatCurrency(term?.term_pay_amount)
                        : (term?.term_pay_amount | currency : 'EURO' : '' : '0.2')
                      : ''
                  }}
                  <mat-icon
                    *ngIf="term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount"
                    matTooltipPosition="above"
                    class="icon-status green"
                    aria-hidden="true"
                    >lens
                  </mat-icon></span
                >
                <span *ngIf="!term?.is_partial"
                  >{{
                    checkIsNumber(term?.term_amount)
                      ? formatCurrency(term?.term_amount)
                      : (term?.term_amount | currency : 'EURO' : '' : '0.2')
                  }}
                  <mat-icon *ngIf="term.term_status === 'billed'" matTooltipPosition="above" class="icon-status blue" aria-hidden="true"
                    >lens
                  </mat-icon>
                </span>
                <span *ngIf="term?.is_partial"
                  >{{
                    checkIsNumber(term?.term_amount - term?.term_pay_amount)
                      ? formatCurrency(term?.term_amount - term?.term_pay_amount)
                      : (term?.term_amount - term?.term_pay_amount | currency : 'EURO' : '' : '0.2')
                  }}
                  <mat-icon matTooltipPosition="above" class="icon-status blue" aria-hidden="true">lens </mat-icon>
                </span>
                <mat-icon
                  *ngIf="term?.is_term_paid && !term?.is_partial"
                  matTooltipPosition="above"
                  class="icon-status green"
                  aria-hidden="true"
                  >lens
                </mat-icon>
                <!-- <mat-icon
                  *ngIf="
                    ((checkPaymentLate(term?.term_payment?.date) &&
                      !term?.is_term_paid &&
                      term?.term_amount) ||
                      checkPartiallyTerms(term)) &&
                    term?.term_status === 'not_billed'
                  "
                  matTooltipPosition="above"
                  class="icon-status red"
                  aria-hidden="true"
                  [ngClass]="{
                    none:
                      changedPlan(term) &&
                      term?.term_payment_deferment?.date &&
                      term?.term_status === 'not_billed'
                  }"
                  >lens
                </mat-icon>
                <span class="date-terms" *ngIf="term?.term_payment_deferment?.date">{{
                  term?.term_payment_deferment?.date ? term?.term_payment_deferment?.date : ''
                }}</span> -->
              </div>
            </ng-container>
          </ng-container>

          <ng-container *ngIf="element?.terms_8?.length > 1">
            <button
              mat-icon-button
              class="margin-right-button view-term"
              matTooltip="{{ 'View term' | translate }}"
              (click)="viewTermDetail(element?.terms_8, 'March')"
            >
              <mat-icon svgIcon="eye"></mat-icon>
            </button>
          </ng-container>
        </ng-container>
      </td>
    </ng-container>

    <ng-container matColumnDef="term9">
      <th
        mat-header-cell
        *matHeaderCellDef="let element"
        matTooltip="{{ 'Term 9' | translate }}"
        matTooltipPosition="above"
        data-cy="table-col-term-9"
      >
        <h5 style="font-size: 11px">
          <mat-icon svgIcon="numeric-9-box" class="mat-icon-svgIcon"> numeric-9-box </mat-icon>
          <span class="date-term">{{ 'April' | translate }}</span>
        </h5>
      </th>
      <td mat-cell *matCellDef="let element" [matTooltip]="element?.term_9" class="pad-l-xs">
        <!-- <ng-container *ngIf="checkNoPayment(element)">
          <div *ngIf="(element && !element?.terms_9) || !element?.terms_9?.term_amount" style="color: #b7b7b7">X</div>
        </ng-container> -->

        <ng-container>
          <ng-container *ngIf="(element && !element?.terms_9) || element?.terms_9?.length < 1">
            <span style="color: #b7b7b7">X</span>
          </ng-container>

          <ng-container *ngIf="element && element?.terms_9?.length === 1">
            <ng-container *ngFor="let term of element?.terms_9">
              <div style="text-align: end; margin-right: 8px" *ngIf="term">
                <span class="date-terms"
                  >{{
                    term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount
                      ? checkIsNumber(term?.term_pay_amount)
                        ? formatCurrency(term?.term_pay_amount)
                        : (term?.term_pay_amount | currency : 'EURO' : '' : '0.2')
                      : ''
                  }}
                  <mat-icon
                    *ngIf="term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount"
                    matTooltipPosition="above"
                    class="icon-status green"
                    aria-hidden="true"
                    >lens
                  </mat-icon></span
                >
                <span *ngIf="!term?.is_partial"
                  >{{
                    checkIsNumber(term?.term_amount)
                      ? formatCurrency(term?.term_amount)
                      : (term?.term_amount | currency : 'EURO' : '' : '0.2')
                  }}
                  <mat-icon *ngIf="term.term_status === 'billed'" matTooltipPosition="above" class="icon-status blue" aria-hidden="true"
                    >lens
                  </mat-icon>
                </span>
                <span *ngIf="term?.is_partial"
                  >{{
                    checkIsNumber(term?.term_amount - term?.term_pay_amount)
                      ? formatCurrency(term?.term_amount - term?.term_pay_amount)
                      : (term?.term_amount - term?.term_pay_amount | currency : 'EURO' : '' : '0.2')
                  }}
                  <mat-icon matTooltipPosition="above" class="icon-status blue" aria-hidden="true">lens </mat-icon>
                </span>
                <mat-icon
                  *ngIf="term?.is_term_paid && !term?.is_partial"
                  matTooltipPosition="above"
                  class="icon-status green"
                  aria-hidden="true"
                  >lens
                </mat-icon>
                <!-- <mat-icon
                  *ngIf="
                    ((checkPaymentLate(term?.term_payment?.date) &&
                      !term?.is_term_paid &&
                      term?.term_amount) ||
                      checkPartiallyTerms(term)) &&
                    term?.term_status === 'not_billed'
                  "
                  matTooltipPosition="above"
                  class="icon-status red"
                  aria-hidden="true"
                  [ngClass]="{
                    none:
                      changedPlan(term) &&
                      term?.term_payment_deferment?.date &&
                      term?.term_status === 'not_billed'
                  }"
                  >lens
                </mat-icon>
                <span class="date-terms" *ngIf="term?.term_payment_deferment?.date">{{
                  term?.term_payment_deferment?.date ? term?.term_payment_deferment?.date : ''
                }}</span> -->
              </div>
            </ng-container>
          </ng-container>

          <ng-container *ngIf="element?.terms_9?.length > 1">
            <button
              mat-icon-button
              class="margin-right-button view-term"
              matTooltip="{{ 'View term' | translate }}"
              (click)="viewTermDetail(element?.terms_9, 'April')"
            >
              <mat-icon svgIcon="eye"></mat-icon>
            </button>
          </ng-container>
        </ng-container>
      </td>
    </ng-container>

    <ng-container matColumnDef="term10">
      <th
        mat-header-cell
        *matHeaderCellDef="let element"
        matTooltip="{{ 'Term 10' | translate }}"
        matTooltipPosition="above"
        data-cy="table-col-term-10"
      >
        <h5 style="font-size: 11px">
          <mat-icon svgIcon="numeric-10-box" class="mat-icon-svgIcon"> numeric-10-box </mat-icon>
          <span class="date-term" style="margin-bottom: 15px; margin-top: 2px">{{ 'May' | translate }}</span>
        </h5>
      </th>
      <td mat-cell *matCellDef="let element" [matTooltip]="element?.term_10" class="pad-l-xs">
        <!-- <ng-container *ngIf="checkNoPayment(element)">
          <div *ngIf="(element && !element?.terms_10) || !element?.terms_10?.term_amount" style="color: #b7b7b7">X</div>
        </ng-container> -->

        <ng-container>
          <ng-container *ngIf="(element && !element?.terms_10) || element?.terms_10?.length < 1">
            <span style="color: #b7b7b7">X</span>
          </ng-container>

          <ng-container *ngIf="element && element?.terms_10?.length === 1">
            <ng-container *ngFor="let term of element?.terms_10">
              <div style="text-align: end; margin-right: 8px" *ngIf="term">
                <span class="date-terms"
                  >{{
                    term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount
                      ? checkIsNumber(term?.term_pay_amount)
                        ? formatCurrency(term?.term_pay_amount)
                        : (term?.term_pay_amount | currency : 'EURO' : '' : '0.2')
                      : ''
                  }}
                  <mat-icon
                    *ngIf="term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount"
                    matTooltipPosition="above"
                    class="icon-status green"
                    aria-hidden="true"
                    >lens
                  </mat-icon></span
                >
                <span *ngIf="!term?.is_partial"
                  >{{
                    checkIsNumber(term?.term_amount)
                      ? formatCurrency(term?.term_amount)
                      : (term?.term_amount | currency : 'EURO' : '' : '0.2')
                  }}
                  <mat-icon *ngIf="term.term_status === 'billed'" matTooltipPosition="above" class="icon-status blue" aria-hidden="true"
                    >lens
                  </mat-icon>
                </span>
                <span *ngIf="term?.is_partial"
                  >{{
                    checkIsNumber(term?.term_amount - term?.term_pay_amount)
                      ? formatCurrency(term?.term_amount - term?.term_pay_amount)
                      : (term?.term_amount - term?.term_pay_amount | currency : 'EURO' : '' : '0.2')
                  }}
                  <mat-icon matTooltipPosition="above" class="icon-status blue" aria-hidden="true">lens </mat-icon>
                </span>
                <mat-icon
                  *ngIf="term?.is_term_paid && !term?.is_partial"
                  matTooltipPosition="above"
                  class="icon-status green"
                  aria-hidden="true"
                  >lens
                </mat-icon>
                <!-- <mat-icon
                  *ngIf="
                    ((checkPaymentLate(term?.term_payment?.date) &&
                      !term?.is_term_paid &&
                      term?.term_amount) ||
                      checkPartiallyTerms(term)) &&
                    term?.term_status === 'not_billed'
                  "
                  matTooltipPosition="above"
                  class="icon-status red"
                  aria-hidden="true"
                  [ngClass]="{
                    none:
                      changedPlan(term) &&
                      term?.term_payment_deferment?.date &&
                      term?.term_status === 'not_billed'
                  }"
                  >lens
                </mat-icon>
                <span class="date-terms" *ngIf="term?.term_payment_deferment?.date">{{
                  term?.term_payment_deferment?.date ? term?.term_payment_deferment?.date : ''
                }}</span> -->
              </div>
            </ng-container>
          </ng-container>

          <ng-container *ngIf="element?.terms_10?.length > 1">
            <button
              mat-icon-button
              class="margin-right-button view-term"
              matTooltip="{{ 'View term' | translate }}"
              (click)="viewTermDetail(element?.terms_10, 'May')"
            >
              <mat-icon svgIcon="eye"></mat-icon>
            </button>
          </ng-container>
        </ng-container>
      </td>
    </ng-container>

    <ng-container matColumnDef="term11">
      <th
        mat-header-cell
        *matHeaderCellDef="let element"
        matTooltip="{{ 'Term 11' | translate }}"
        matTooltipPosition="above"
        data-cy="table-col-term-11"
      >
        <h5 style="font-size: 11px">
          <span class="box-outline">11</span>
          <span class="date-term" style="margin-top: 4px">{{ 'June' | translate }}</span>
        </h5>
      </th>
      <td mat-cell *matCellDef="let element" [matTooltip]="element?.term_11" class="pad-l-xs">
        <!-- <ng-container *ngIf="checkNoPayment(element)">
          <div *ngIf="(element && !element?.terms_11) || !element?.terms_11?.term_amount" style="color: #b7b7b7">X</div>
        </ng-container> -->

        <ng-container>
          <ng-container *ngIf="(element && !element?.terms_11) || element?.terms_11?.length < 1">
            <span style="color: #b7b7b7">X</span>
          </ng-container>

          <ng-container *ngIf="element && element?.terms_11?.length === 1">
            <ng-container *ngFor="let term of element?.terms_11">
              <div style="text-align: end; margin-right: 8px" *ngIf="term">
                <span class="date-terms"
                  >{{
                    term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount
                      ? checkIsNumber(term?.term_pay_amount)
                        ? formatCurrency(term?.term_pay_amount)
                        : (term?.term_pay_amount | currency : 'EURO' : '' : '0.2')
                      : ''
                  }}
                  <mat-icon
                    *ngIf="term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount"
                    matTooltipPosition="above"
                    class="icon-status green"
                    aria-hidden="true"
                    >lens
                  </mat-icon></span
                >
                <span *ngIf="!term?.is_partial"
                  >{{
                    checkIsNumber(term?.term_amount)
                      ? formatCurrency(term?.term_amount)
                      : (term?.term_amount | currency : 'EURO' : '' : '0.2')
                  }}
                  <mat-icon *ngIf="term.term_status === 'billed'" matTooltipPosition="above" class="icon-status blue" aria-hidden="true"
                    >lens
                  </mat-icon>
                </span>
                <span *ngIf="term?.is_partial"
                  >{{
                    checkIsNumber(term?.term_amount - term?.term_pay_amount)
                      ? formatCurrency(term?.term_amount - term?.term_pay_amount)
                      : (term?.term_amount - term?.term_pay_amount | currency : 'EURO' : '' : '0.2')
                  }}
                  <mat-icon matTooltipPosition="above" class="icon-status blue" aria-hidden="true">lens </mat-icon>
                </span>
                <mat-icon
                  *ngIf="term?.is_term_paid && !term?.is_partial"
                  matTooltipPosition="above"
                  class="icon-status green"
                  aria-hidden="true"
                  >lens
                </mat-icon>
                <!-- <mat-icon
                  *ngIf="
                    ((checkPaymentLate(term?.term_payment?.date) &&
                      !term?.is_term_paid &&
                      term?.term_amount) ||
                      checkPartiallyTerms(term)) &&
                    term?.term_status === 'not_billed'
                  "
                  matTooltipPosition="above"
                  class="icon-status red"
                  aria-hidden="true"
                  [ngClass]="{
                    none:
                      changedPlan(term) &&
                      term?.term_payment_deferment?.date &&
                      term?.term_status === 'not_billed'
                  }"
                  >lens
                </mat-icon>
                <span class="date-terms" *ngIf="term?.term_payment_deferment?.date">{{
                  term?.term_payment_deferment?.date ? term?.term_payment_deferment?.date : ''
                }}</span> -->
              </div>
            </ng-container>
          </ng-container>

          <ng-container *ngIf="element?.terms_11?.length > 1">
            <button
              mat-icon-button
              class="margin-right-button view-term"
              matTooltip="{{ 'View term' | translate }}"
              (click)="viewTermDetail(element?.terms_11, 'June')"
            >
              <mat-icon svgIcon="eye"></mat-icon>
            </button>
          </ng-container>
        </ng-container>
      </td>
    </ng-container>

    <ng-container matColumnDef="term12">
      <th
        mat-header-cell
        *matHeaderCellDef="let element"
        matTooltip="{{ 'Term 12' | translate }}"
        matTooltipPosition="above"
        data-cy="table-col-term-12"
      >
        <h5 style="font-size: 11px">
          <span class="box-outline">12</span>
          <span class="date-term" style="margin-top: 4px">{{ 'July' | translate }}</span>
        </h5>
      </th>
      <td mat-cell *matCellDef="let element" [matTooltip]="element?.term_12" class="pad-l-xs">
        <!-- <ng-container *ngIf="checkNoPayment(element)">
          <div *ngIf="(element && !element?.terms_12) || !element?.terms_12?.term_amount" style="color: #b7b7b7">X</div>
        </ng-container> -->

        <ng-container>
          <ng-container *ngIf="(element && !element?.terms_12) || element?.terms_12?.length < 1">
            <span style="color: #b7b7b7">X</span>
          </ng-container>

          <ng-container *ngIf="element && element?.terms_12?.length === 1">
            <ng-container *ngFor="let term of element?.terms_12">
              <div style="text-align: end; margin-right: 8px" *ngIf="term">
                <span class="date-terms"
                  >{{
                    term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount
                      ? checkIsNumber(term?.term_pay_amount)
                        ? formatCurrency(term?.term_pay_amount)
                        : (term?.term_pay_amount | currency : 'EURO' : '' : '0.2')
                      : ''
                  }}
                  <mat-icon
                    *ngIf="term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount"
                    matTooltipPosition="above"
                    class="icon-status green"
                    aria-hidden="true"
                    >lens
                  </mat-icon></span
                >
                <span *ngIf="!term?.is_partial"
                  >{{
                    checkIsNumber(term?.term_amount)
                      ? formatCurrency(term?.term_amount)
                      : (term?.term_amount | currency : 'EURO' : '' : '0.2')
                  }}
                  <mat-icon *ngIf="term.term_status === 'billed'" matTooltipPosition="above" class="icon-status blue" aria-hidden="true"
                    >lens
                  </mat-icon>
                </span>
                <span *ngIf="term?.is_partial"
                  >{{
                    checkIsNumber(term?.term_amount - term?.term_pay_amount)
                      ? formatCurrency(term?.term_amount - term?.term_pay_amount)
                      : (term?.term_amount - term?.term_pay_amount | currency : 'EURO' : '' : '0.2')
                  }}
                  <mat-icon matTooltipPosition="above" class="icon-status blue" aria-hidden="true">lens </mat-icon>
                </span>
                <mat-icon
                  *ngIf="term?.is_term_paid && !term?.is_partial"
                  matTooltipPosition="above"
                  class="icon-status green"
                  aria-hidden="true"
                  >lens
                </mat-icon>
                <!-- <mat-icon
                  *ngIf="
                    ((checkPaymentLate(term?.term_payment?.date) &&
                      !term?.is_term_paid &&
                      term?.term_amount) ||
                      checkPartiallyTerms(term)) &&
                    term?.term_status === 'not_billed'
                  "
                  matTooltipPosition="above"
                  class="icon-status red"
                  aria-hidden="true"
                  [ngClass]="{
                    none:
                      changedPlan(term) &&
                      term?.term_payment_deferment?.date &&
                      term?.term_status === 'not_billed'
                  }"
                  >lens
                </mat-icon>
                <span class="date-terms" *ngIf="term?.term_payment_deferment?.date">{{
                  term?.term_payment_deferment?.date ? term?.term_payment_deferment?.date : ''
                }}</span> -->
              </div>
            </ng-container>
          </ng-container>

          <ng-container *ngIf="element?.terms_12?.length > 1">
            <button
              mat-icon-button
              class="margin-right-button view-term"
              matTooltip="{{ 'View term' | translate }}"
              (click)="viewTermDetail(element?.terms_12, 'July')"
            >
              <mat-icon svgIcon="eye"></mat-icon>
            </button>
          </ng-container>
        </ng-container>
      </td>
    </ng-container>

    <ng-container matColumnDef="action" stickyEnd>
      <th mat-header-cell *matHeaderCellDef matTooltip="{{ 'Action' | translate }}" matTooltipPosition="above" data-cy="table-col-action">
        <h5 style="font-size: 11px; text-align: center">
          {{ 'Action' | translate }}
        </h5>
      </th>
      <td mat-cell *matCellDef="let element" class="pad-l-xs" data-cy="table-col-action">
        <button
          mat-icon-button
          class="margin-right-button"
          matTooltip="{{ 'Send an email' | translate }}"
          (click)="internshipMailDialog(element)"
          *ngIf="permission.sendMailInFollowUpOrganization()"
          [disabled]="dataSelected?.length > 0 || isCheckedAll"
          data-cy="table-action-send-an-email"
        >
          <mat-icon>send</mat-icon>
        </button>

        <button
          mat-icon-button
          class="margin-right-button"
          matTooltip="{{ 'Add payment' | translate }}"
          (click)="openAddPaymentDialog('add', element)"
          *ngIf="permission.addPaymentInFollowUpOrganization()"
          [disabled]="dataSelected?.length > 0 || isCheckedAll"
          data-cy="table-action-add-payment"
        >
          <mat-icon svgIcon="pencil"> </mat-icon>
        </button>

        <button
          mat-icon-button
          class="margin-right-button"
          matTooltip="{{ 'Edit Terms' | translate }}"
          (click)="openEditTermsDialog(element)"
          *ngIf="permission.editTermInFollowUpOrganization()"
          [disabled]="dataSelected?.length > 0 || isCheckedAll"
          data-cy="table-action-edit-terms"
        >
          <mat-icon svgIcon="archive-edit-outline"> </mat-icon>
        </button>

        <button
          mat-icon-button
          class="margin-right-button"
          matTooltip="{{ 'View Student Card' | translate }}"
          (click)="viewCandidateInfo(element?.candidate_id?._id,'Student','Finance')"
          *ngIf="permission.viewStudentCardInFollowUpOrganization()"
          [disabled]="dataSelected?.length > 0 || isCheckedAll"
          data-cy="table-action-view-student-card"
        >
          <mat-icon svgIcon="eye"> </mat-icon>
        </button>

        <button
          *ngIf="element?.term_times === 0 && permission.assignTimelineInFollowUpOrganization()"
          mat-icon-button
          class="margin-right-button"
          matTooltip="{{ 'Assign Timeline' | translate }}"
          (click)="openDialogAdd(element)"
          [disabled]="dataSelected?.length > 0 || isCheckedAll"
          data-cy="table-action-assign-timeline"
        >
          <mat-icon>event_busy</mat-icon>
        </button>
      </td>
    </ng-container>

    <ng-container matColumnDef="loading">
      <th mat-header-cell *matHeaderCellDef colspan="100%" style="text-align: center !important">
        <div class="center-spinner">
          <mat-spinner color="accent" data-cy="table-spinner"></mat-spinner>
        </div>
      </th>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-header-row *matHeaderRowDef="filterColumns"></tr>
    <tr mat-header-row *matHeaderRowDef="['loading']" [hidden]="!isLoading"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns" [hidden]="isLoading"></tr>
  </table>
</div>

<div class="horizontal" style="margin-bottom: 40px">
  <div [ngClass]="{ hide: noData | async }">
    <mat-paginator
      [ngClass]="{ 'hide-pagination-buttons': paginator.length <= 10 }"
      [hidePageSize]="true"
      [pageSize]="10"
      showFirstLastButtons
      data-cy="mat-paginator"
    ></mat-paginator>
  </div>

  <div *ngIf="noData | async" class="no-records" [ngClass]="{ hide: isLoading }">
    {{ 'NOT RECORD FOUND' | translate }}
  </div>
</div>

<div *ngIf="isWaitingForResponse" class="loading-indicator">
  <mat-progress-spinner mode="indeterminate" color="accent"></mat-progress-spinner>
</div>
