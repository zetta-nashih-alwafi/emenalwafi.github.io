<div *ngIf="isWaitingForResponse" class="inner-loading-indicator">
  <mat-spinner color="accent" [diameter]="100"></mat-spinner>
</div>
<div class="center-card mrgn-btn50 mrgn-t1">
  <div>
    <mat-accordion class="example-headers-align">
      <mat-expansion-panel [expanded]="true" style="background: #424242" class="panel-spacing">
        <mat-expansion-panel-header>
          <mat-panel-title>
            <h4 style="color: white; align-self: center; margin: 0px">
              {{ 'Registration' | translate }} {{ scholarSeasonData?.intake_channel?.program }} - {{'ADMISIONSTEPFINANCEMENT.Full Rate' | translate }} :
              <span *ngIf="scholarSeasonData?.registration_profile_type === 'internal' ">
                {{ formatCurrencyHistory(scholarSeasonData?.full_rate_id?.amount_internal) ? formatCurrencyHistory(scholarSeasonData?.full_rate_id?.amount_internal) : '0'}} €
              </span>
              <span *ngIf="scholarSeasonData?.registration_profile_type === 'external' ">
                {{ formatCurrencyHistory(scholarSeasonData?.full_rate_id?.amount_external) ? formatCurrencyHistory(scholarSeasonData?.full_rate_id?.amount_external) : '0'}} €
              </span>
            </h4>
          </mat-panel-title>
        </mat-expansion-panel-header>
        <div class="p-grid top-space">
          <div class="p-col-12 panel-divider"></div>
          <div class="p-col-12 no-padding">
            <h4>{{ 'Finance status' | translate }}</h4>
          </div>
        </div>

        <div>
          <div class="horizontal mat-elevation-z8 finance-table" style="font-family: 'firaSans' !important">
            <table mat-table [dataSource]="financeStatus" class="mat-elevation-z8" style="font-family: 'firaSans'">
              <ng-container matColumnDef="payer">
                <th mat-header-cell *matHeaderCellDef matTooltip="{{ 'Payer' | translate }}" matTooltipPosition="above">
                  <h5 style="font-size: 11px; padding: 0px 2px; font-weight: 500">
                    {{ 'Payer' | translate }}
                  </h5>
                </th>
                <td mat-cell *matCellDef="let element">
                  <span
                    *ngIf="!element?.is_financial_support && !element?.company_branch_id && !element?.organization_id"
                    style="padding-left: 5px"
                    matTooltip="{{
                      (element?.candidate_id?.last_name | uppercase) +
                        ' ' +
                        element?.candidate_id?.first_name +
                        ' ' +
                        (element?.candidate_id?.civility && element?.candidate_id?.civility === 'neutral'
                          ? ''
                          : (element?.candidate_id?.civility | translate))
                    }} 
                    {{
                      element?.candidate_id?.legal_representative?.unique_id ? ('MINOR_STUDENT_MANAGEMENT.LR' | translate) : ''
                    }}">
                    {{
                    (element?.candidate_id?.last_name | uppercase) +
                    ' ' +
                    element?.candidate_id?.first_name +
                    ' ' +
                    (element?.candidate_id?.civility && element?.candidate_id?.civility === 'neutral'
                    ? ''
                    : (element?.candidate_id?.civility | translate))
                    }} 
                    {{
                      element?.candidate_id?.legal_representative?.unique_id ? ('MINOR_STUDENT_MANAGEMENT.LR' | translate) : ''
                    }}
                  </span>
                  <span
                    *ngIf="element?.is_financial_support && !element?.company_branch_id && !element?.organization_id"
                    style="padding-left: 5px"
                    matTooltip="{{
                      (element?.financial_support_info?.family_name | uppercase) +
                        ' ' +
                        element?.financial_support_info?.name +
                        ' ' +
                        (element?.financial_support_info?.civility && element?.financial_support_info?.civility === 'neutral'
                          ? ''
                          : (element?.financial_support_info?.civility | translate))
                    }}">
                    {{
                    (element?.financial_support_info?.family_name | uppercase) +
                    ' ' +
                    element?.financial_support_info?.name +
                    ' ' +
                    (element?.financial_support_info?.civility && element?.financial_support_info?.civility ===
                    'neutral'
                    ? ''
                    : (element?.financial_support_info?.civility | translate))
                    }}
                  </span>
                  <span
                    *ngIf="(element?.is_financial_support || !element?.is_financial_support) && element?.company_branch_id"
                    style="padding-left: 5px"
                    matTooltip="{{ element?.company_branch_id?.company_name }}">
                    {{ element?.company_branch_id?.company_name }}
                  </span>
                  <span *ngIf="element?.organization_id" style="padding-left: 5px"
                    [matTooltip]="element?.organization_id?.name">
                    {{ element?.organization_id?.name }}
                  </span>
                </td>
              </ng-container>

              <ng-container matColumnDef="totalAmount">
                <th mat-header-cell *matHeaderCellDef matTooltip="{{ 'Total Amount' | translate }}"
                  matTooltipPosition="above">
                  <h5 style="font-size: 11px; padding: 0px 2px; font-weight: 500">
                    {{ 'Total Amount' | translate }}
                  </h5>
                </th>
                <td mat-cell *matCellDef="let element" class="pad-l-xs">
                  <ng-container *ngIf="element?.student_type?.type_of_information === 'classic'">
                    <ng-container *ngIf="checkNoPayment(element) || element?.total_amount === 0">
                      <span style="color: #b7b7b7">X</span>
                    </ng-container>

                    <ng-container *ngIf="!checkNoPayment(element)">
                      <ng-container>
                        {{ element?.total_amount && element?.total_amount !== '0' ?
                        formatCurrencyHistory(element?.total_amount) : '' }}
                      </ng-container>
                    </ng-container>
                  </ng-container>
                  <ng-container *ngIf="element?.student_type?.type_of_information !== 'classic'">
                    <ng-container *ngIf="checkNoPayment(element)">
                      <span style="color: #b7b7b7">X</span>
                    </ng-container>

                    <ng-container *ngIf="!checkNoPayment(element)">
                      <ng-container
                        *ngIf="
                          element?.total_amount === '0' ||
                          element?.total_amount === '0.00' ||
                          element?.total_amount === 0 ||
                          element?.total_amount === 0.0 ||
                          element?.total_amount === '' ||
                          element?.total_amount === null
                        ">
                        <span style="color: #b7b7b7">X</span>
                      </ng-container>

                      <ng-container
                        *ngIf="
                          element?.total_amount &&
                          element?.total_amount !== '0' &&
                          element?.total_amount !== '0.00' &&
                          element?.total_amount !== 0 &&
                          element?.total_amount !== 0.0 &&
                          element?.total_amount !== '' &&
                          element?.total_amount !== null
                        ">
                        {{ formatCurrencyHistory(element?.total_amount) }}
                      </ng-container>
                    </ng-container>
                  </ng-container>
                </td>
              </ng-container>

              <ng-container matColumnDef="amountBilled">
                <th mat-header-cell *matHeaderCellDef matTooltip="{{ 'Amount Billed' | translate }}"
                  matTooltipPosition="above">
                  <h5 style="font-size: 11px; padding: 0px 2px; font-weight: 500">
                    {{ 'Amount Billed' | translate }}
                  </h5>
                </th>
                <td mat-cell *matCellDef="let element" class="pad-l-xs">
                  <!-- Classic Amount Billed -->
                  <ng-container *ngIf="element?.student_type?.type_of_information === 'classic'">
                    <ng-container *ngIf="checkNoPayment(element) || element?.amount_billed === 0">
                      <span style="color: #b7b7b7">X</span>
                    </ng-container>

                    <ng-container *ngIf="!checkNoPayment(element)">
                      <ng-container>
                        {{ element?.amount_billed && element?.amount_billed !== '0' ?
                        formatCurrencyHistory(element?.amount_billed) : '' }}
                      </ng-container>
                    </ng-container>
                  </ng-container>

                  <!-- Continous Amount Billed -->
                  <ng-container *ngIf="element?.student_type?.type_of_information !== 'classic'">
                    <ng-container *ngIf="checkNoPayment(element)">
                      <span style="color: #b7b7b7">X</span>
                    </ng-container>

                    <ng-container *ngIf="!checkNoPayment(element)">
                      <ng-container *ngIf="element?.amount_billed === 0">
                        <span style="color: #b7b7b7">X</span>
                      </ng-container>

                      <ng-container *ngIf="element?.amount_billed > 0">
                        {{ element?.amount_billed && element?.amount_billed > 0 ?
                        formatCurrencyHistory(element?.amount_billed) : '' }}
                      </ng-container>
                    </ng-container>
                  </ng-container>
                </td>
              </ng-container>

              <ng-container matColumnDef="amountPaid">
                <th mat-header-cell *matHeaderCellDef matTooltip="{{ 'Amount Paid' | translate }}"
                  matTooltipPosition="above">
                  <h5 style="font-size: 11px; padding: 0px 2px; font-weight: 500">
                    {{ 'Amount Paid' | translate }}
                  </h5>
                </th>
                <td mat-cell *matCellDef="let element" class="pad-l-xs">
                  <!-- Classic Amount Paid -->
                  <ng-container *ngIf="element?.student_type?.type_of_information === 'classic'">
                    <ng-container
                      *ngIf="checkNoPayment(element) && !checkIfCandidateTransferHasAmountPaid(element?.amount_paid)">
                      <ng-container
                        *ngIf="!element?.amount_paid || element?.amount_paid === '0' || element?.amount_paid === '0.00'">
                        <span style="color: #b7b7b7">X</span>
                      </ng-container>
                    </ng-container>

                    <ng-container
                      *ngIf="!checkNoPayment(element) || checkIfCandidateTransferHasAmountPaid(element?.amount_paid)">
                      <ng-container *ngIf="!checkIfCandidateTransferHasAmountPaid(element?.amount_paid) || element?.amount_paid === '0' || element?.amount_paid === '0.00'">
                        <span style="color: #b7b7b7">X</span>
                      </ng-container>

                      <ng-container
                        *ngIf="
                          element?.amount_paid !== '0' ||
                          element?.amount_paid !== '0.00' ||
                          !element?.amount_paid ||
                          checkIfCandidateTransferHasAmountPaid(element?.amount_paid)
                        ">
                        {{
                        formatCurrency(element?.amount_paid) && (element?.amount_paid !== '0' && element?.amount_paid
                        !== '0.00')
                        ? formatCurrencyHistory(element?.amount_paid)
                        : ''
                        }}
                      </ng-container>
                    </ng-container>
                  </ng-container>

                  <!-- Continous Amount Paid -->
                  <ng-container *ngIf="element?.student_type?.type_of_information !== 'classic'">
                    <ng-container
                      *ngIf="checkNoPayment(element) && !checkIfCandidateTransferHasAmountPaid(element?.amount_paid)">
                      <ng-container
                        *ngIf="!element?.amount_paid || element?.amount_paid === '0' || element?.amount_paid === '0.00'">
                        <span style="color: #b7b7b7">X</span>
                      </ng-container>
                    </ng-container>

                    <ng-container
                      *ngIf="!checkNoPayment(element) || checkIfCandidateTransferHasAmountPaid(element?.amount_paid)">
                      <ng-container *ngIf="!checkIfCandidateTransferHasAmountPaid(element?.amount_paid) || element?.amount_paid === '0' || element?.amount_paid === '0.00'">
                        <span style="color: #b7b7b7">X</span>
                      </ng-container>

                      <ng-container
                        *ngIf="
                          element?.amount_paid &&
                          element?.amount_paid !== '0' &&
                          element?.amount_paid !== '0.00' &&
                          checkIfCandidateTransferHasAmountPaid(element?.amount_paid)
                        ">
                        {{
                        formatCurrency(element?.amount_paid) && (element?.amount_paid !== '0' && element?.amount_paid
                        !== '0.00')
                        ? formatCurrencyHistory(element?.amount_paid)
                        : ''
                        }}
                      </ng-container>
                    </ng-container>
                  </ng-container>
                </td>
              </ng-container>

              <ng-container matColumnDef="remainingDue">
                <th mat-header-cell *matHeaderCellDef matTooltip="{{ 'Remaining Due' | translate }}"
                  matTooltipPosition="above">
                  <h5 style="font-size: 11px; padding: 0px 2px; font-weight: 500">
                    {{ 'Remaining Due' | translate }}
                  </h5>
                </th>
                <td mat-cell *matCellDef="let element" class="pad-l-xs">
                  <!-- Classic Remaining Due -->
                  <ng-container *ngIf="element?.student_type?.type_of_information === 'classic'">
                    <ng-container *ngIf="checkNoPayment(element) || element?.remaining_billed === '0'">
                      <span style="color: #b7b7b7">X</span>
                    </ng-container>

                    <ng-container *ngIf="!checkNoPayment(element)">
                      <ng-container *ngIf="element?.remaining_billed !== '0' || !element?.remaining_billed">
                        {{
                        formatCurrency(element?.remaining_billed) && element?.remaining_billed !== '0'
                        ? formatCurrencyHistory(element?.remaining_billed)
                        : ''
                        }}
                      </ng-container>
                    </ng-container>
                  </ng-container>

                  <!-- Continous Remaining Due -->
                  <ng-container *ngIf="element?.student_type?.type_of_information !== 'classic'">
                    <ng-container *ngIf="checkNoPayment(element)">
                      <span style="color: #b7b7b7">X</span>
                    </ng-container>

                    <ng-container *ngIf="!checkNoPayment(element)">
                      <ng-container
                        *ngIf="element?.remaining_billed === '0' || element?.remaining_billed === '0.00' || !element?.remaining_billed">
                        <span style="color: #b7b7b7">X</span>
                      </ng-container>

                      <ng-container
                        *ngIf="element?.remaining_billed && element?.remaining_billed !== '0' && element?.remaining_billed !== '0.00'">
                        {{
                        formatCurrency(element?.remaining_billed) && element?.remaining_billed !== '0'
                        ? formatCurrencyHistory(element?.remaining_billed)
                        : ''
                        }}
                      </ng-container>
                    </ng-container>
                  </ng-container>
                </td>
              </ng-container>

              <ng-container matColumnDef="amountLate">
                <th mat-header-cell *matHeaderCellDef matTooltip="{{ 'Amount Late' | translate }}"
                  matTooltipPosition="above">
                  <h5 style="font-size: 11px; padding: 0px 2px; font-weight: 500">
                    {{ 'Amount Late' | translate }}
                  </h5>
                </th>
                <td mat-cell *matCellDef="let element" class="pad-l-xs">
                  <!-- Classic Amount Late -->
                  <ng-container *ngIf="element?.student_type?.type_of_information === 'classic'">
                    <ng-container *ngIf="checkNoPayment(element) || !element?.amount_late">
                      <span style="color: #b7b7b7">X</span>
                    </ng-container>

                    <ng-container *ngIf="!checkNoPayment(element)">
                      <ng-container>
                        {{
                        formatCurrency(element?.amount_late) && element?.amount_late !== '0' ?
                        formatDecimal(element?.amount_late) : ''
                        }}
                      </ng-container>
                    </ng-container>
                  </ng-container>

                  <!-- Continous Amount Late -->
                  <ng-container *ngIf="element?.student_type?.type_of_information !== 'classic'">
                    <ng-container *ngIf="checkNoPayment(element)">
                      <span style="color: #b7b7b7">X</span>
                    </ng-container>

                    <ng-container *ngIf="!checkNoPayment(element)">
                      <ng-container
                        *ngIf="element?.amount_late === '0' || element?.amount_late === '0.00' || !element?.amount_late">
                        <span style="color: #b7b7b7">X</span>
                      </ng-container>

                      <ng-container
                        *ngIf="element?.amount_late && element?.amount_late !== '0' && element?.amount_late !== '0.00'">
                        {{
                        formatCurrency(element?.amount_late) && element?.amount_late !== '0' ?
                        formatDecimal(element?.amount_late) : ''
                        }}
                      </ng-container>
                    </ng-container>
                  </ng-container>
                </td>
              </ng-container>

              <ng-container matColumnDef="accumulatedLate">
                <th mat-header-cell *matHeaderCellDef matTooltip="{{ 'Accumulated Late (d)' | translate }}"
                  matTooltipPosition="above">
                  <h5 style="font-size: 11px; padding: 0px 2px; font-weight: 500">
                    {{ 'Accumulated Late (d)' | translate }}
                  </h5>
                </th>
                <td mat-cell *matCellDef="let element" class="pad-l-xs">
                  <!-- Classic Accumulated Late -->
                  <ng-container *ngIf="element?.student_type?.type_of_information === 'classic'">
                    <ng-container
                      *ngIf="
                        (checkNoPayment(element) || element?.accumulated_late === 0) &&
                        element?.candidate_id?.candidate_admission_status !== 'registered'
                      ">
                      <span style="color: #b7b7b7">X</span>
                    </ng-container>

                    <ng-container *ngIf="!checkNoPayment(element)">
                      <ng-container>
                        {{ element?.accumulated_late ? element?.accumulated_late : '' }}
                      </ng-container>
                    </ng-container>
                  </ng-container>

                  <!-- Continous Accumulated Late -->
                  <ng-container *ngIf="element?.student_type?.type_of_information !== 'classic'">
                    <ng-container *ngIf="checkNoPayment(element)">
                      <span style="color: #b7b7b7">X</span>
                    </ng-container>

                    <ng-container *ngIf="!checkNoPayment(element)">
                      <ng-container
                        *ngIf="element?.accumulated_late === '0' || element?.accumulated_late === '0.00' || !element?.accumulated_late">
                        <span style="color: #b7b7b7">X</span>
                      </ng-container>

                      <ng-container
                        *ngIf="element?.accumulated_late && element?.accumulated_late !== '0' && element?.accumulated_late !== '0.00'">
                        {{ element?.accumulated_late ? element?.accumulated_late : '' }}
                      </ng-container>
                    </ng-container>
                  </ng-container>
                </td>
              </ng-container>

              <ng-container matColumnDef="deposit">
                <th mat-header-cell *matHeaderCellDef matTooltip="{{ 'Deposit' | translate }}"
                  matTooltipPosition="above">
                  <h5 style="font-size: 11px">
                    <mat-icon svgIcon="credit-card-check" class="mat-icon-svgIcon"> credit-card-check </mat-icon>
                  </h5>
                </th>
                <td mat-cell *matCellDef="let element" class="pad-l-xs">
                  <ng-container
                    *ngIf="checkNoPayment(element) && !checkIfCandidateTransferHasDP(element?.deposit_pay_amount)">
                    <span style="color: #b7b7b7">X</span>
                  </ng-container>

                  <ng-container
                    *ngIf="!checkNoPayment(element) || checkIfCandidateTransferHasDP(element?.deposit_pay_amount) || element?.dp_deposit_chargeback">
                    <ng-container
                      *ngIf="checkHasNoDP(element) && !checkIfCandidateTransferHasDP(element?.deposit_pay_amount)">
                      <span style="color: #b7b7b7">X</span>
                    </ng-container>
                    <ng-container *ngIf="element?.student_type?.type_of_information !== 'classic'">
                      <ng-container
                        *ngIf="element?.deposit === 0 && element?.deposit_pay_amount === 0 && !checkHasNoDP(element)">
                        <span style="color: #b7b7b7">X</span>
                      </ng-container>
                    </ng-container>

                    <ng-container
                      *ngIf="element?.deposit !== 0 || element?.dp_deposit_chargeback || checkIfCandidateTransferHasDP(element?.deposit_pay_amount)">
                      <ng-container *ngIf="element?.dp_histories?.length < 1 || !isNoDepositPaidAndSomeHistoriesDifferent">
                        <span
                          *ngIf="element?.deposit && element?.deposit_pay_amount !== 0 && element?.deposit_pay_amount !== element?.deposit"
                        >
                          <span class="deposit"
                            >{{
                              element?.deposit_pay_amount
                                ? formatCurrency(element?.deposit_pay_amount)
                                : (element?.deposit_pay_amount | currency : 'EURO' : '' : '0.2')
                            }}
                            <mat-icon
                              *ngIf="element?.candidate_id?.payment !== 'chargeback'"
                              matTooltipPosition="above"
                              matTooltip="{{ 'Paid' | translate }}"
                              class="icon-status green"
                              aria-hidden="true"
                              >lens
                            </mat-icon>
                          </span>
                          <span>
                            <ng-container *ngIf="element?.deposit_status !== 'chargeback' || element?.candidate_id?.payment !== 'done'">
                              {{
                                element?.deposit - element?.deposit_pay_amount
                                  ? formatCurrency(element?.deposit - element?.deposit_pay_amount)
                                  : (element?.deposit - element?.deposit_pay_amount | currency : 'EURO' : '' : '0.2')
                              }}
                            </ng-container>
                            <mat-icon
                              matTooltipPosition="above"
                              *ngIf="
                                element?.deposit - element?.deposit_pay_amount > 0 &&
                                element?.candidate_id?.payment !== 'sepa_pending' &&
                                element?.candidate_id?.payment !== 'not_authorized' &&
                                element?.candidate_id?.payment !== 'pending'
                              "
                              class="icon-status blue"
                              aria-hidden="true"
                              >lens
                            </mat-icon>
                            <mat-icon
                              matTooltipPosition="above"
                              *ngIf="element?.candidate_id?.payment === 'sepa_pending' || element?.candidate_id?.payment === 'pending'"
                              class="icon-status orange"
                              aria-hidden="true"
                              >lens
                            </mat-icon>
                            <mat-icon
                              *ngIf="element?.candidate_id?.payment === 'not_authorized'"
                              matTooltipPosition="above"
                              matTooltip="{{ 'Refused' | translate }}"
                              class="icon-status red"
                              aria-hidden="true"
                              >lens
                            </mat-icon>
                          </span>
                        </span>
                        <span *ngIf="element?.deposit_pay_amount === 0 || element?.deposit_pay_amount === element?.deposit || element?.dp_deposit_chargeback">
                          {{ element?.deposit ? formatCurrency(element?.deposit) : element?.dp_deposit_chargeback ? formatCurrency(element?.dp_deposit_chargeback) : 'x' }}
                          <ng-container *ngIf="element?.deposit && element?.deposit_status && element?.deposit_status !== 'not_billed' || element?.dp_deposit_chargeback">
                            <mat-icon
                              *ngIf="
                                element?.is_deposit_completed &&
                                element?.deposit &&
                                element?.deposit_status === 'paid' &&
                                element?.candidate_id?.payment !== 'chargeback'
                              "
                              matTooltipPosition="above"
                              matTooltip="{{ 'Paid' | translate }}"
                              class="icon-status green"
                              aria-hidden="true"
                              >lens
                            </mat-icon>
                            <mat-icon
                              *ngIf="
                                element?.deposit &&
                                element?.deposit_status === 'billed' &&
                                element?.candidate_id?.payment !== 'sepa_pending' &&
                                element?.candidate_id?.payment !== 'not_authorized' &&
                                element?.candidate_id?.payment !== 'pending'
                              "
                              matTooltipPosition="above"
                              matTooltip="{{ 'Generated' | translate }}"
                              class="icon-status blue"
                              aria-hidden="true"
                              >lens
                            </mat-icon>
                            <mat-icon
                              *ngIf="
                                (!element?.is_deposit_completed || !element?.deposit) &&
                                (element?.candidate_id?.payment === 'sepa_pending' || element?.candidate_id?.payment === 'pending')
                              "
                              matTooltipPosition="above"
                              matTooltip="{{ 'Pending' | translate }}"
                              class="icon-status orange"
                              aria-hidden="true"
                              >lens
                            </mat-icon>
                            <mat-icon
                              *ngIf="element?.candidate_id?.payment === 'not_authorized'"
                              matTooltipPosition="above"
                              matTooltip="{{ 'Refused' | translate }}"
                              class="icon-status red"
                              aria-hidden="true"
                              >lens
                            </mat-icon>
                            <mat-icon
                              *ngIf="element?.candidate_id?.payment === 'chargeback' || element?.dp_deposit_chargeback"
                              matTooltipPosition="above"
                              matTooltip="{{ 'Chargeback' | translate }}"
                              class="icon-status purple"
                              aria-hidden="true"
                              >lens
                            </mat-icon>
                          </ng-container>
                        </span>
                      </ng-container>
                      <ng-container *ngIf="element?.dp_histories?.length > 0 && isNoDepositPaidAndSomeHistoriesDifferent">
                        <button
                          mat-icon-button
                          class="margin-right-button view-term"
                          matTooltip="{{ 'Detail of Down Payment' | translate }}"
                          (click)="getDPDetail(element?._id)"
                        >
                          <mat-icon svgIcon="eye"></mat-icon>
                        </button>
                      </ng-container>
                    </ng-container>
                  </ng-container>
                </td>
              </ng-container>

              <ng-container matColumnDef="notRespected">
                <th mat-header-cell *matHeaderCellDef matTooltip="{{ 'Terms Not respected' | translate }}"
                  matTooltipPosition="above">
                  <h5 style="font-size: 11px; padding: 0px 2px; font-weight: 500">
                    {{ 'Terms Not respected' | translate }}
                  </h5>
                </th>
                <td mat-cell *matCellDef="let element" class="pad-l-xs">
                  <!-- Classic Terms Not Respected -->
                  <ng-container *ngIf="element?.student_type?.type_of_information === 'classic'">
                    <ng-container *ngIf="checkNoPayment(element) || element?.overdue === 0">
                      <span style="color: #b7b7b7">X</span>
                    </ng-container>

                    <ng-container *ngIf="!checkNoPayment(element)">
                      <ng-container>
                        {{ formatNonDecimal(element?.overdue) }}
                      </ng-container>
                    </ng-container>
                  </ng-container>

                  <!-- Continous Terms Not Respected -->
                  <ng-container *ngIf="element?.student_type?.type_of_information !== 'classic'">
                    <ng-container *ngIf="checkNoPayment(element)">
                      <span style="color: #b7b7b7">X</span>
                    </ng-container>

                    <ng-container *ngIf="!checkNoPayment(element)">
                      <span
                        *ngIf="
                          element?.overdue !== 0 &&
                          element?.overdue !== 0.0 &&
                          element?.overdue !== '0' &&
                          element?.overdue !== '0.00' &&
                          element?.overdue !== ''
                        ">{{ formatNonDecimal(element?.overdue) }}</span>
                      <ng-container
                        *ngIf="
                          element?.overdue === 0 ||
                          element?.overdue === 0.0 ||
                          element?.overdue === '0' ||
                          element?.overdue === '0.00' ||
                          element?.overdue === ''
                        ">
                        <span
                          *ngIf="
                            element?.amount_billed === 0 ||
                            element?.amount_billed === 0.0 ||
                            element?.amount_billed === '0' ||
                            element?.amount_billed === '0.00'
                          "
                          style="color: #b7b7b7">X</span>
                        <span
                          *ngIf="
                            element?.amount_billed !== 0 &&
                            element?.amount_billed !== 0.0 &&
                            element?.amount_billed !== '0' &&
                            element?.amount_billed !== '0.00'
                          "></span>
                      </ng-container>
                    </ng-container>
                  </ng-container>
                </td>
              </ng-container>

              <ng-container matColumnDef="notSettled">
                <th
                  mat-header-cell
                  *matHeaderCellDef
                  matTooltip="{{ 'Terms Not Respected & till not Settled up today' | translate }}"
                  matTooltipPosition="above">
                  <h5 style="font-size: 11px; padding: 0px 2px; font-weight: 500">
                    {{ 'Terms Not Respected & till not Settled up today' | translate }}
                  </h5>
                </th>
                <td mat-cell *matCellDef="let element" class="pad-l-xs">
                  <!-- Classic Terms Not Respected & till not Settled up today -->
                  <ng-container *ngIf="element?.student_type?.type_of_information === 'classic'">
                    <ng-container *ngIf="checkNoPayment(element) || element?.overdue_not_paid === 0">
                      <span style="color: #b7b7b7">X</span>
                    </ng-container>

                    <ng-container *ngIf="!checkNoPayment(element)">
                      <ng-container>
                        {{ formatNonDecimal(element?.overdue_not_paid) }}
                      </ng-container>
                    </ng-container>
                  </ng-container>

                  <!-- Continous Terms Not Respected & till not Settled up today -->
                  <ng-container *ngIf="element?.student_type?.type_of_information !== 'classic'">
                    <ng-container *ngIf="checkNoPayment(element)">
                      <span style="color: #b7b7b7">X</span>
                    </ng-container>

                    <ng-container *ngIf="!checkNoPayment(element)">
                      <span
                        *ngIf="
                          element?.overdue_not_paid !== 0 &&
                          element?.overdue_not_paid !== 0.0 &&
                          element?.overdue_not_paid !== '0' &&
                          element?.overdue_not_paid !== '0.00' &&
                          element?.overdue_not_paid !== ''
                        ">
                        {{ formatNonDecimal(element?.overdue_not_paid) }}
                      </span>
                      <ng-container
                        *ngIf="
                          element?.overdue_not_paid === 0 ||
                          element?.overdue_not_paid === 0.0 ||
                          element?.overdue_not_paid === '0' ||
                          element?.overdue_not_paid === '0.00' ||
                          element?.overdue_not_paid === ''
                        ">
                        <span
                          *ngIf="
                            element?.amount_billed === 0 ||
                            element?.amount_billed === 0.0 ||
                            element?.amount_billed === '0' ||
                            element?.amount_billed === '0.00'
                          "
                          style="color: #b7b7b7">X</span>
                        <span
                          *ngIf="
                            element?.amount_billed !== 0 &&
                            element?.amount_billed !== 0.0 &&
                            element?.amount_billed !== '0' &&
                            element?.amount_billed !== '0.00'
                          "></span>
                      </ng-container>
                    </ng-container>
                  </ng-container>
                </td>
              </ng-container>
              <ng-container matColumnDef="term1">
                <th mat-header-cell *matHeaderCellDef="let element" matTooltip="{{ 'Term 1' | translate }}"
                  matTooltipPosition="above">
                  <h5 style="font-size: 11px">
                    <mat-icon svgIcon="numeric-1-box" class="mat-icon-svgIcon"> numeric-1-box </mat-icon>
                    <span class="date-term">{{ 'August' | translate }}</span>
                  </h5>
                </th>
                <td mat-cell *matCellDef="let element" class="pad-l-xs">
                  <ng-container *ngIf="element?.term_1?.length < 1 || checkNoPayment(element)">
                    <span style="color: #b7b7b7">X</span>
                  </ng-container>
                  <ng-container *ngIf="element?.term_1?.length">
                    <ng-container *ngIf="element?.term_1?.length === 1 && !checkIfTermHaveChargebackAndHaveDifferentStatus(element?.term_1)">
                      <ng-container *ngFor="let term of element?.term_1">
                        <ng-container *ngIf="checkNoPayment(element)">
                          <div *ngIf="!term || !term?.term_amount" style="color: #b7b7b7">X</div>
                        </ng-container>

                        <ng-container *ngIf="!checkNoPayment(element)" [matTooltip]="term">
                          <ng-container *ngIf="element?.student_type?.type_of_information === 'classic'">
                            <ng-container *ngIf="!term || !term?.term_amount">
                              <span style="color: #b7b7b7">X</span>
                            </ng-container>
                          </ng-container>
                          <ng-container *ngIf="element?.student_type?.type_of_information !== 'classic'">
                            <ng-container *ngIf="!term && !term?.term_amount">
                              <span style="color: #b7b7b7">X</span>
                            </ng-container>
                          </ng-container>

                          <ng-container *ngIf="term">
                            <div style="text-align: end; margin-right: 8px">
                              <span class="date-terms" *ngIf="term?.term_status === 'partially_paid' && term?.term_pay_amount - term?.term_amount_chargeback > 0"
                                >{{
                                  term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount
                                    ? term?.term_pay_amount
                                      ? formatCurrency(term?.term_pay_amount)
                                      : (term?.term_pay_amount | currency : 'EURO' : '' : '0.2')
                                    : ''
                                }}
                                <mat-icon
                                  *ngIf="term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount"
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Paid' | translate }}"
                                  class="icon-status green"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>

                              <span *ngIf="!term?.is_partial">{{
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending
                                ? formatCurrency(
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending
                                )
                                : ''
                                }}
                                <mat-icon
                                  *ngIf="
                                    term?.term_status === 'billed' &&
                                    term?.term_amount >
                                      term?.term_amount_not_authorised + term?.term_amount_chargeback + term?.term_amount_pending
                                  "
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Generated' | translate }}"
                                  class="icon-status blue"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <span *ngIf="term?.is_partial && term?.term_status !== 'partially_paid'">{{
                                term?.term_amount_chargeback ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : 
                                term?.term_pay_amount ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_pay_amount -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : ''
                                }}
                                <mat-icon
                                  *ngIf="
                                    (term?.term_amount -
                                    term?.term_amount_chargeback -
                                    term?.term_amount_not_authorised -
                                    term?.term_amount_pending >
                                    0) ||
                                    (term?.term_amount -
                                    term?.term_pay_amount -
                                    term?.term_amount_not_authorised -
                                    term?.term_amount_pending >
                                    0)
                                  "
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Generated' | translate }}"
                                  class="icon-status blue"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>

                              <span *ngIf="term?.is_partial && term?.term_status === 'partially_paid'">{{
                                term?.term_amount_chargeback ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : 
                                term?.term_pay_amount ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_pay_amount -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : ''
                                }}
                                <mat-icon
                                  *ngIf="
                                    term?.term_amount -
                                    term?.term_pay_amount -
                                    term?.term_amount_chargeback -
                                    term?.term_amount_not_authorised -
                                    term?.term_amount_pending >
                                    0
                                  "
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Generated' | translate }}"
                                  class="icon-status blue"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <mat-icon
                                *ngIf="
                                  term?.is_term_paid && !term?.is_partial && term?.term_status === 'paid' && !term?.term_amount_chargeback
                                "
                                matTooltipPosition="above"
                                matTooltip="{{ 'Paid' | translate }}"
                                class="icon-status green"
                                aria-hidden="true">lens
                              </mat-icon>
                              <mat-icon
                                *ngIf="
                                  ((!term?.is_term_paid && term?.term_amount) || checkPartiallyTerms(term)) &&
                                  term?.term_status === 'not_billed' &&
                                  term?.term_amount_not_authorised &&
                                  term?.term_amount >
                                    term?.term_amount_not_authorised + term?.term_amount_chargeback + term?.term_amount_pending
                                "
                                matTooltipPosition="above"
                                matTooltip="{{ 'Refused' | translate }}"
                                class="icon-status red"
                                aria-hidden="true"
                                [ngClass]="{
                                  none: changedPlan(term) && term?.term_payment_deferment?.date && term?.term_status === 'not_billed'
                                }">lens
                              </mat-icon>
                            </div>
                            <div style="text-align: end; margin-right: 8px">
                              <span *ngIf="term?.term_amount_pending">
                                {{
                                term?.term_amount_pending
                                ? formatCurrency(term?.term_amount_pending)
                                : (term?.term_amount_pending | currency : 'EURO' : '' : '0.2')
                                }}
                                <mat-icon
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Pending' | translate }}"
                                  class="icon-status orange"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <span *ngIf="term?.term_amount_chargeback">
                                {{
                                term?.term_amount_chargeback
                                ? formatCurrency(term?.term_amount_chargeback)
                                : (term?.term_amount_chargeback | currency : 'EURO' : '' : '0.2')
                                }}
                                <mat-icon
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'chargeback' | translate }}"
                                  class="icon-status purple"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <span *ngIf="term?.term_amount_not_authorised">
                                {{
                                term?.term_amount_not_authorised
                                ? formatCurrency(term?.term_amount_not_authorised)
                                : (term?.term_amount_not_authorised | currency : 'EURO' : '' : '0.2')
                                }}
                                <mat-icon
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Refused' | translate }}"
                                  class="icon-status red"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                            </div>
                          </ng-container>
                        </ng-container>
                      </ng-container>
                    </ng-container>
                    <ng-container *ngIf="element?.term_1?.length > 1 || checkIfTermHaveChargebackAndHaveDifferentStatus(element?.term_1)">
                      <button
                        mat-icon-button
                        class="margin-right-button view-term"
                        matTooltip="{{ 'View term' | translate }}"
                        (click)="viewTermDetail(element?.term_1, 'August')">
                        <mat-icon svgIcon="eye"></mat-icon>
                      </button>
                    </ng-container>
                  </ng-container>
                </td>
              </ng-container>

              <ng-container matColumnDef="term2">
                <th mat-header-cell *matHeaderCellDef="let element" matTooltip="{{ 'Term 2' | translate }}"
                  matTooltipPosition="above">
                  <h5 style="font-size: 11px">
                    <mat-icon svgIcon="numeric-2-box" class="mat-icon-svgIcon"> numeric-2-box </mat-icon>
                    <span class="date-term">{{ 'September' | translate }}</span>
                  </h5>
                </th>
                <td mat-cell *matCellDef="let element" class="pad-l-xs">
                  <ng-container *ngIf="element?.term_2?.length < 1 || checkNoPayment(element)">
                    <span style="color: #b7b7b7">X</span>
                  </ng-container>
                  <ng-container *ngIf="element?.term_2?.length">
                    <ng-container *ngIf="element?.term_2?.length === 1 && !checkIfTermHaveChargebackAndHaveDifferentStatus(element?.term_2)">
                      <ng-container *ngFor="let term of element?.term_2">
                        <ng-container *ngIf="checkNoPayment(element)">
                          <div *ngIf="!term || !term?.term_amount" style="color: #b7b7b7">X</div>
                        </ng-container>

                        <ng-container *ngIf="!checkNoPayment(element)" [matTooltip]="term">
                          <ng-container *ngIf="element?.student_type?.type_of_information === 'classic'">
                            <ng-container *ngIf="!term || !term?.term_amount">
                              <span style="color: #b7b7b7">X</span>
                            </ng-container>
                          </ng-container>
                          <ng-container *ngIf="element?.student_type?.type_of_information !== 'classic'">
                            <ng-container *ngIf="!term && !term?.term_amount">
                              <span style="color: #b7b7b7">X</span>
                            </ng-container>
                          </ng-container>

                          <ng-container *ngIf="term">
                            <div style="text-align: end; margin-right: 8px">
                              <span
                                class="date-terms"
                                *ngIf="term?.term_status === 'partially_paid' && term?.term_pay_amount - term?.term_amount_chargeback > 0"
                                >{{
                                  term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount
                                    ? term?.term_pay_amount
                                      ? formatCurrency(term?.term_pay_amount)
                                      : (term?.term_pay_amount | currency : 'EURO' : '' : '0.2')
                                    : ''
                                }}
                                <mat-icon
                                  *ngIf="term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount"
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Paid' | translate }}"
                                  class="icon-status green"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>

                              <span *ngIf="!term?.is_partial">{{
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending
                                ? formatCurrency(
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending
                                )
                                : ''
                                }}
                                <mat-icon
                                  *ngIf="
                                    term?.term_status === 'billed' &&
                                    term?.term_amount >
                                      term?.term_amount_not_authorised + term?.term_amount_chargeback + term?.term_amount_pending
                                  "
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Generated' | translate }}"
                                  class="icon-status blue"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <span *ngIf="term?.is_partial && term?.term_status !== 'partially_paid'">{{
                                term?.term_amount_chargeback ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : 
                                term?.term_pay_amount ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_pay_amount -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : ''
                                }}
                                <mat-icon
                                  *ngIf="
                                    (term?.term_amount -
                                    term?.term_amount_chargeback -
                                    term?.term_amount_not_authorised -
                                    term?.term_amount_pending >
                                    0) ||
                                    (term?.term_amount -
                                    term?.term_pay_amount -
                                    term?.term_amount_not_authorised -
                                    term?.term_amount_pending >
                                    0)
                                  "
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Generated' | translate }}"
                                  class="icon-status blue"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <span *ngIf="term?.is_partial && term?.term_status === 'partially_paid'">{{
                                term?.term_amount_chargeback ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : 
                                term?.term_pay_amount ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_pay_amount -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : ''
                                }}
                                <mat-icon
                                  *ngIf="
                                    term?.term_amount -
                                    term?.term_pay_amount -
                                    term?.term_amount_chargeback -
                                    term?.term_amount_not_authorised -
                                    term?.term_amount_pending >
                                    0
                                  "
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Generated' | translate }}"
                                  class="icon-status blue"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <mat-icon
                                *ngIf="
                                  term?.is_term_paid && !term?.is_partial && term?.term_status === 'paid' && !term?.term_amount_chargeback
                                "
                                matTooltipPosition="above"
                                matTooltip="{{ 'Paid' | translate }}"
                                class="icon-status green"
                                aria-hidden="true">lens
                              </mat-icon>
                              <mat-icon
                                *ngIf="
                                  ((!term?.is_term_paid && term?.term_amount) || checkPartiallyTerms(term)) &&
                                  term?.term_status === 'not_billed' &&
                                  term?.term_amount_not_authorised &&
                                  term?.term_amount >
                                    term?.term_amount_not_authorised + term?.term_amount_chargeback + term?.term_amount_pending
                                "
                                matTooltipPosition="above"
                                matTooltip="{{ 'Refused' | translate }}"
                                class="icon-status red"
                                aria-hidden="true"
                                [ngClass]="{
                                  none: changedPlan(term) && term?.term_payment_deferment?.date && term?.term_status === 'not_billed'
                                }">lens
                              </mat-icon>
                            </div>
                            <div style="text-align: end; margin-right: 8px">
                              <span *ngIf="term?.term_amount_pending">
                                {{
                                term?.term_amount_pending
                                ? formatCurrency(term?.term_amount_pending)
                                : (term?.term_amount_pending | currency : 'EURO' : '' : '0.2')
                                }}
                                <mat-icon
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Pending' | translate }}"
                                  class="icon-status orange"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <span *ngIf="term?.term_amount_chargeback">
                                {{
                                term?.term_amount_chargeback
                                ? formatCurrency(term?.term_amount_chargeback)
                                : (term?.term_amount_chargeback | currency : 'EURO' : '' : '0.2')
                                }}
                                <mat-icon
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'chargeback' | translate }}"
                                  class="icon-status purple"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <span *ngIf="term?.term_amount_not_authorised">
                                {{
                                term?.term_amount_not_authorised
                                ? formatCurrency(term?.term_amount_not_authorised)
                                : (term?.term_amount_not_authorised | currency : 'EURO' : '' : '0.2')
                                }}
                                <mat-icon
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Refused' | translate }}"
                                  class="icon-status red"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                            </div>
                          </ng-container>
                        </ng-container>
                      </ng-container>
                    </ng-container>
                    <ng-container *ngIf="element?.term_2?.length > 1 || checkIfTermHaveChargebackAndHaveDifferentStatus(element?.term_2)">
                      <button
                        mat-icon-button
                        class="margin-right-button view-term"
                        matTooltip="{{ 'View term' | translate }}"
                        (click)="viewTermDetail(element?.term_2, 'September')">
                        <mat-icon svgIcon="eye"></mat-icon>
                      </button>
                    </ng-container>
                  </ng-container>
                </td>
              </ng-container>

              <ng-container matColumnDef="term3">
                <th mat-header-cell *matHeaderCellDef="let element" matTooltip="{{ 'Term 3' | translate }}"
                  matTooltipPosition="above">
                  <h5 style="font-size: 11px">
                    <mat-icon svgIcon="numeric-3-box" class="mat-icon-svgIcon"> numeric-3-box </mat-icon>
                    <span class="date-term">{{ 'October' | translate }}</span>
                  </h5>
                </th>
                <td mat-cell *matCellDef="let element" class="pad-l-xs">
                  <ng-container *ngIf="element?.term_3?.length < 1 || checkNoPayment(element)">
                    <span style="color: #b7b7b7">X</span>
                  </ng-container>
                  <ng-container *ngIf="element?.term_3?.length">
                    <ng-container *ngIf="element?.term_3?.length === 1 && !checkIfTermHaveChargebackAndHaveDifferentStatus(element?.term_3)">
                      <ng-container *ngFor="let term of element?.term_3">
                        <ng-container *ngIf="checkNoPayment(element)">
                          <div *ngIf="!term || !term?.term_amount" style="color: #b7b7b7">X</div>
                        </ng-container>

                        <ng-container *ngIf="!checkNoPayment(element)" [matTooltip]="term">
                          <ng-container *ngIf="element?.student_type?.type_of_information === 'classic'">
                            <ng-container *ngIf="!term || !term?.term_amount">
                              <span style="color: #b7b7b7">X</span>
                            </ng-container>
                          </ng-container>
                          <ng-container *ngIf="element?.student_type?.type_of_information !== 'classic'">
                            <ng-container *ngIf="!term && !term?.term_amount">
                              <span style="color: #b7b7b7">X</span>
                            </ng-container>
                          </ng-container>

                          <ng-container *ngIf="term">
                            <div style="text-align: end; margin-right: 8px">
                              <span class="date-terms" *ngIf="term?.term_status === 'partially_paid' && term?.term_pay_amount - term?.term_amount_chargeback > 0"
                                >{{
                                  term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount
                                    ? term?.term_pay_amount
                                      ? formatCurrency(term?.term_pay_amount)
                                      : (term?.term_pay_amount | currency : 'EURO' : '' : '0.2')
                                    : ''
                                }}
                                <mat-icon
                                  *ngIf="term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount"
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Paid' | translate }}"
                                  class="icon-status green"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>

                              <span *ngIf="!term?.is_partial">{{
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending
                                ? formatCurrency(
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending
                                )
                                : ''
                                }}
                                <mat-icon
                                  *ngIf="
                                    term?.term_status === 'billed' &&
                                    term?.term_amount >
                                      term?.term_amount_not_authorised + term?.term_amount_chargeback + term?.term_amount_pending
                                  "
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Generated' | translate }}"
                                  class="icon-status blue"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <span *ngIf="term?.is_partial && term?.term_status !== 'partially_paid'">{{
                                term?.term_amount_chargeback ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : 
                                term?.term_pay_amount ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_pay_amount -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : ''
                                }}
                                <mat-icon
                                  *ngIf="
                                    (term?.term_amount -
                                    term?.term_amount_chargeback -
                                    term?.term_amount_not_authorised -
                                    term?.term_amount_pending >
                                    0) ||
                                    (term?.term_amount -
                                    term?.term_pay_amount -
                                    term?.term_amount_not_authorised -
                                    term?.term_amount_pending >
                                    0)
                                  "
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Generated' | translate }}"
                                  class="icon-status blue"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <span *ngIf="term?.is_partial && term?.term_status === 'partially_paid'">{{
                                term?.term_amount_chargeback ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : 
                                term?.term_pay_amount ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_pay_amount -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : ''
                                }}
                                <mat-icon
                                  *ngIf="
                                    term?.term_amount -
                                    term?.term_pay_amount -
                                    term?.term_amount_chargeback -
                                    term?.term_amount_not_authorised -
                                    term?.term_amount_pending >
                                    0
                                  "
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Generated' | translate }}"
                                  class="icon-status blue"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>

                              <mat-icon
                                *ngIf="
                                  term?.is_term_paid && !term?.is_partial && term?.term_status === 'paid' && !term?.term_amount_chargeback
                                "
                                matTooltipPosition="above"
                                matTooltip="{{ 'Paid' | translate }}"
                                class="icon-status green"
                                aria-hidden="true">lens
                              </mat-icon>
                              <mat-icon
                                *ngIf="
                                  ((!term?.is_term_paid && term?.term_amount) || checkPartiallyTerms(term)) &&
                                  term?.term_status === 'not_billed' &&
                                  term?.term_amount_not_authorised &&
                                  term?.term_amount >
                                    term?.term_amount_not_authorised + term?.term_amount_chargeback + term?.term_amount_pending
                                "
                                matTooltipPosition="above"
                                matTooltip="{{ 'Refused' | translate }}"
                                class="icon-status red"
                                aria-hidden="true"
                                [ngClass]="{
                                  none: changedPlan(term) && term?.term_payment_deferment?.date && term?.term_status === 'not_billed'
                                }">lens
                              </mat-icon>
                            </div>
                            <div style="text-align: end; margin-right: 8px">
                              <span *ngIf="term?.term_amount_pending">
                                {{
                                term?.term_amount_pending
                                ? formatCurrency(term?.term_amount_pending)
                                : (term?.term_amount_pending | currency : 'EURO' : '' : '0.2')
                                }}
                                <mat-icon
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Pending' | translate }}"
                                  class="icon-status orange"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <span *ngIf="term?.term_amount_chargeback">
                                {{
                                term?.term_amount_chargeback
                                ? formatCurrency(term?.term_amount_chargeback)
                                : (term?.term_amount_chargeback | currency : 'EURO' : '' : '0.2')
                                }}
                                <mat-icon
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'chargeback' | translate }}"
                                  class="icon-status purple"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <span *ngIf="term?.term_amount_not_authorised">
                                {{
                                term?.term_amount_not_authorised
                                ? formatCurrency(term?.term_amount_not_authorised)
                                : (term?.term_amount_not_authorised | currency : 'EURO' : '' : '0.2')
                                }}
                                <mat-icon
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Refused' | translate }}"
                                  class="icon-status red"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                            </div>
                          </ng-container>
                        </ng-container>
                      </ng-container>
                    </ng-container>
                    <ng-container *ngIf="element?.term_3?.length > 1 || checkIfTermHaveChargebackAndHaveDifferentStatus(element?.term_3)">
                      <button
                        mat-icon-button
                        class="margin-right-button view-term"
                        matTooltip="{{ 'View term' | translate }}"
                        (click)="viewTermDetail(element?.term_3, 'October')">
                        <mat-icon svgIcon="eye"></mat-icon>
                      </button>
                    </ng-container>
                  </ng-container>
                </td>
              </ng-container>

              <ng-container matColumnDef="term4">
                <th mat-header-cell *matHeaderCellDef="let element" matTooltip="{{ 'Term 4' | translate }}"
                  matTooltipPosition="above">
                  <h5 style="font-size: 11px">
                    <mat-icon svgIcon="numeric-4-box" class="mat-icon-svgIcon"> numeric-4-box </mat-icon>
                    <span class="date-term">{{ 'November' | translate }}</span>
                  </h5>
                </th>
                <td mat-cell *matCellDef="let element" class="pad-l-xs">
                  <ng-container *ngIf="element?.term_4?.length < 1 || checkNoPayment(element)">
                    <span style="color: #b7b7b7">X</span>
                  </ng-container>
                  <ng-container *ngIf="element?.term_4?.length">
                    <ng-container *ngIf="element?.term_4?.length === 1 && !checkIfTermHaveChargebackAndHaveDifferentStatus(element?.term_4)">
                      <ng-container *ngFor="let term of element?.term_4">
                        <ng-container *ngIf="checkNoPayment(element)">
                          <div *ngIf="!term || !term?.term_amount" style="color: #b7b7b7">X</div>
                        </ng-container>

                        <ng-container *ngIf="!checkNoPayment(element)" [matTooltip]="term">
                          <ng-container *ngIf="element?.student_type?.type_of_information === 'classic'">
                            <ng-container *ngIf="!term || !term?.term_amount">
                              <span style="color: #b7b7b7">X</span>
                            </ng-container>
                          </ng-container>
                          <ng-container *ngIf="element?.student_type?.type_of_information !== 'classic'">
                            <ng-container *ngIf="!term && !term?.term_amount">
                              <span style="color: #b7b7b7">X</span>
                            </ng-container>
                          </ng-container>

                          <ng-container *ngIf="term">
                            <div style="text-align: end; margin-right: 8px">
                              <span class="date-terms" *ngIf="term?.term_status === 'partially_paid' && term?.term_pay_amount - term?.term_amount_chargeback > 0"
                                >{{
                                  term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount
                                    ? term?.term_pay_amount
                                      ? formatCurrency(term?.term_pay_amount)
                                      : (term?.term_pay_amount | currency : 'EURO' : '' : '0.2')
                                    : ''
                                }}
                                <mat-icon
                                  *ngIf="term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount"
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Paid' | translate }}"
                                  class="icon-status green"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>

                              <span *ngIf="!term?.is_partial">{{
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending
                                ? formatCurrency(
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending
                                )
                                : ''
                                }}
                                <mat-icon
                                  *ngIf="
                                    term?.term_status === 'billed' &&
                                    term?.term_amount >
                                      term?.term_amount_not_authorised + term?.term_amount_chargeback + term?.term_amount_pending
                                  "
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Generated' | translate }}"
                                  class="icon-status blue"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <span *ngIf="term?.is_partial && term?.term_status !== 'partially_paid'">{{
                                term?.term_amount_chargeback ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : 
                                term?.term_pay_amount ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_pay_amount -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : ''
                                }}
                                <mat-icon
                                  *ngIf="
                                    (term?.term_amount -
                                    term?.term_amount_chargeback -
                                    term?.term_amount_not_authorised -
                                    term?.term_amount_pending >
                                    0) ||
                                    (term?.term_amount -
                                    term?.term_pay_amount -
                                    term?.term_amount_not_authorised -
                                    term?.term_amount_pending >
                                    0)
                                  "
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Generated' | translate }}"
                                  class="icon-status blue"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <span *ngIf="term?.is_partial && term?.term_status === 'partially_paid'">{{
                                term?.term_amount_chargeback ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : 
                                term?.term_pay_amount ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_pay_amount -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : ''
                                }}
                                <mat-icon
                                  *ngIf="
                                    term?.term_amount -
                                    term?.term_pay_amount -
                                    term?.term_amount_chargeback -
                                    term?.term_amount_not_authorised -
                                    term?.term_amount_pending >
                                    0
                                  "
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Generated' | translate }}"
                                  class="icon-status blue"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>

                              <mat-icon
                                *ngIf="
                                  term?.is_term_paid && !term?.is_partial && term?.term_status === 'paid' && !term?.term_amount_chargeback
                                "
                                matTooltipPosition="above"
                                matTooltip="{{ 'Paid' | translate }}"
                                class="icon-status green"
                                aria-hidden="true">lens
                              </mat-icon>
                              <mat-icon
                                *ngIf="
                                  ((!term?.is_term_paid && term?.term_amount) || checkPartiallyTerms(term)) &&
                                  term?.term_status === 'not_billed' &&
                                  term?.term_amount_not_authorised &&
                                  term?.term_amount >
                                    term?.term_amount_not_authorised + term?.term_amount_chargeback + term?.term_amount_pending
                                "
                                matTooltipPosition="above"
                                matTooltip="{{ 'Refused' | translate }}"
                                class="icon-status red"
                                aria-hidden="true"
                                [ngClass]="{
                                  none: changedPlan(term) && term?.term_payment_deferment?.date && term?.term_status === 'not_billed'
                                }">lens
                              </mat-icon>
                            </div>
                            <div style="text-align: end; margin-right: 8px">
                              <span *ngIf="term?.term_amount_pending">
                                {{
                                term?.term_amount_pending
                                ? formatCurrency(term?.term_amount_pending)
                                : (term?.term_amount_pending | currency : 'EURO' : '' : '0.2')
                                }}
                                <mat-icon
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Pending' | translate }}"
                                  class="icon-status orange"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <span *ngIf="term?.term_amount_chargeback">
                                {{
                                term?.term_amount_chargeback
                                ? formatCurrency(term?.term_amount_chargeback)
                                : (term?.term_amount_chargeback | currency : 'EURO' : '' : '0.2')
                                }}
                                <mat-icon
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'chargeback' | translate }}"
                                  class="icon-status purple"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <span *ngIf="term?.term_amount_not_authorised">
                                {{
                                term?.term_amount_not_authorised
                                ? formatCurrency(term?.term_amount_not_authorised)
                                : (term?.term_amount_not_authorised | currency : 'EURO' : '' : '0.2')
                                }}
                                <mat-icon
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Refused' | translate }}"
                                  class="icon-status red"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                            </div>
                          </ng-container>
                        </ng-container>
                      </ng-container>
                    </ng-container>
                    <ng-container *ngIf="element?.term_4?.length > 1 || checkIfTermHaveChargebackAndHaveDifferentStatus(element?.term_4)">
                      <button
                        mat-icon-button
                        class="margin-right-button view-term"
                        matTooltip="{{ 'View term' | translate }}"
                        (click)="viewTermDetail(element?.term_4, 'November')">
                        <mat-icon svgIcon="eye"></mat-icon>
                      </button>
                    </ng-container>
                  </ng-container>
                </td>
              </ng-container>

              <ng-container matColumnDef="term5">
                <th mat-header-cell *matHeaderCellDef="let element" matTooltip="{{ 'Term 5' | translate }}"
                  matTooltipPosition="above">
                  <h5 style="font-size: 11px">
                    <mat-icon svgIcon="numeric-5-box" class="mat-icon-svgIcon"> numeric-5-box </mat-icon>
                    <span class="date-term">{{ 'December' | translate }}</span>
                  </h5>
                </th>
                <td mat-cell *matCellDef="let element" class="pad-l-xs">
                  <ng-container *ngIf="element?.term_5?.length < 1 || checkNoPayment(element)">
                    <span style="color: #b7b7b7">X</span>
                  </ng-container>
                  <ng-container *ngIf="element?.term_5?.length">
                    <ng-container *ngIf="element?.term_5?.length === 1 && !checkIfTermHaveChargebackAndHaveDifferentStatus(element?.term_5)">
                      <ng-container *ngFor="let term of element?.term_5">
                        <ng-container *ngIf="checkNoPayment(element)">
                          <div *ngIf="!term || !term?.term_amount" style="color: #b7b7b7">X</div>
                        </ng-container>

                        <ng-container *ngIf="!checkNoPayment(element)" [matTooltip]="term">
                          <ng-container *ngIf="element?.student_type?.type_of_information === 'classic'">
                            <ng-container *ngIf="!term || !term?.term_amount">
                              <span style="color: #b7b7b7">X</span>
                            </ng-container>
                          </ng-container>
                          <ng-container *ngIf="element?.student_type?.type_of_information !== 'classic'">
                            <ng-container *ngIf="!term && !term?.term_amount">
                              <span style="color: #b7b7b7">X</span>
                            </ng-container>
                          </ng-container>

                          <ng-container *ngIf="term">
                            <div style="text-align: end; margin-right: 8px">
                              <span class="date-terms" *ngIf="term?.term_status === 'partially_paid' && term?.term_pay_amount - term?.term_amount_chargeback > 0"
                                >{{
                                  term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount
                                    ? term?.term_pay_amount
                                      ? formatCurrency(term?.term_pay_amount)
                                      : (term?.term_pay_amount | currency : 'EURO' : '' : '0.2')
                                    : ''
                                }}
                                <mat-icon
                                  *ngIf="term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount"
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Paid' | translate }}"
                                  class="icon-status green"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>

                              <span *ngIf="!term?.is_partial">{{
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending
                                ? formatCurrency(
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending
                                )
                                : ''
                                }}
                                <mat-icon
                                  *ngIf="
                                    term?.term_status === 'billed' &&
                                    term?.term_amount >
                                      term?.term_amount_not_authorised + term?.term_amount_chargeback + term?.term_amount_pending
                                  "
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Generated' | translate }}"
                                  class="icon-status blue"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <span *ngIf="term?.is_partial && term?.term_status !== 'partially_paid'">{{
                                term?.term_amount_chargeback ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : 
                                term?.term_pay_amount ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_pay_amount -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : ''
                                }}
                                <mat-icon
                                  *ngIf="
                                    (term?.term_amount -
                                    term?.term_amount_chargeback -
                                    term?.term_amount_not_authorised -
                                    term?.term_amount_pending >
                                    0) ||
                                    (term?.term_amount -
                                    term?.term_pay_amount -
                                    term?.term_amount_not_authorised -
                                    term?.term_amount_pending >
                                    0)
                                  "
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Generated' | translate }}"
                                  class="icon-status blue"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <span *ngIf="term?.is_partial && term?.term_status === 'partially_paid'">{{
                                term?.term_amount_chargeback ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : 
                                term?.term_pay_amount ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_pay_amount -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : ''
                                }}
                                <mat-icon
                                  *ngIf="
                                    term?.term_amount -
                                    term?.term_pay_amount -
                                    term?.term_amount_chargeback -
                                    term?.term_amount_not_authorised -
                                    term?.term_amount_pending >
                                    0
                                  "
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Generated' | translate }}"
                                  class="icon-status blue"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>

                              <mat-icon
                                *ngIf="
                                  term?.is_term_paid && !term?.is_partial && term?.term_status === 'paid' && !term?.term_amount_chargeback
                                "
                                matTooltipPosition="above"
                                matTooltip="{{ 'Paid' | translate }}"
                                class="icon-status green"
                                aria-hidden="true">lens
                              </mat-icon>
                              <mat-icon
                                *ngIf="
                                  ((!term?.is_term_paid && term?.term_amount) || checkPartiallyTerms(term)) &&
                                  term?.term_status === 'not_billed' &&
                                  term?.term_amount_not_authorised &&
                                  term?.term_amount >
                                    term?.term_amount_not_authorised + term?.term_amount_chargeback + term?.term_amount_pending
                                "
                                matTooltipPosition="above"
                                matTooltip="{{ 'Refused' | translate }}"
                                class="icon-status red"
                                aria-hidden="true"
                                [ngClass]="{
                                  none: changedPlan(term) && term?.term_payment_deferment?.date && term?.term_status === 'not_billed'
                                }">lens
                              </mat-icon>
                            </div>
                            <div style="text-align: end; margin-right: 8px">
                              <span *ngIf="term?.term_amount_pending">
                                {{
                                term?.term_amount_pending
                                ? formatCurrency(term?.term_amount_pending)
                                : (term?.term_amount_pending | currency : 'EURO' : '' : '0.2')
                                }}
                                <mat-icon
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Pending' | translate }}"
                                  class="icon-status orange"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <span *ngIf="term?.term_amount_chargeback">
                                {{
                                term?.term_amount_chargeback
                                ? formatCurrency(term?.term_amount_chargeback)
                                : (term?.term_amount_chargeback | currency : 'EURO' : '' : '0.2')
                                }}
                                <mat-icon
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'chargeback' | translate }}"
                                  class="icon-status purple"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <span *ngIf="term?.term_amount_not_authorised">
                                {{
                                term?.term_amount_not_authorised
                                ? formatCurrency(term?.term_amount_not_authorised)
                                : (term?.term_amount_not_authorised | currency : 'EURO' : '' : '0.2')
                                }}
                                <mat-icon
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Refused' | translate }}"
                                  class="icon-status red"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                            </div>
                          </ng-container>
                        </ng-container>
                      </ng-container>
                    </ng-container>
                    <ng-container *ngIf="element?.term_5?.length > 1 || checkIfTermHaveChargebackAndHaveDifferentStatus(element?.term_5)">
                      <button
                        mat-icon-button
                        class="margin-right-button view-term"
                        matTooltip="{{ 'View term' | translate }}"
                        (click)="viewTermDetail(element?.term_5, 'December')">
                        <mat-icon svgIcon="eye"></mat-icon>
                      </button>
                    </ng-container>
                  </ng-container>
                </td>
              </ng-container>

              <ng-container matColumnDef="term6">
                <th mat-header-cell *matHeaderCellDef="let element" matTooltip="{{ 'Term 6' | translate }}"
                  matTooltipPosition="above">
                  <h5 style="font-size: 11px">
                    <mat-icon svgIcon="numeric-6-box" class="mat-icon-svgIcon"> numeric-6-box </mat-icon>
                    <span class="date-term">{{ 'January' | translate }}</span>
                  </h5>
                </th>
                <td mat-cell *matCellDef="let element" class="pad-l-xs">
                  <ng-container *ngIf="element?.term_6?.length < 1 || checkNoPayment(element)">
                    <span style="color: #b7b7b7">X</span>
                  </ng-container>
                  <ng-container *ngIf="element?.term_6?.length">
                    <ng-container *ngIf="element?.term_6?.length === 1 && !checkIfTermHaveChargebackAndHaveDifferentStatus(element?.term_6)">
                      <ng-container *ngFor="let term of element?.term_6">
                        <ng-container *ngIf="checkNoPayment(element)">
                          <div *ngIf="!term || !term?.term_amount" style="color: #b7b7b7">X</div>
                        </ng-container>

                        <ng-container *ngIf="!checkNoPayment(element)" [matTooltip]="term">
                          <ng-container *ngIf="element?.student_type?.type_of_information === 'classic'">
                            <ng-container *ngIf="!term || !term?.term_amount">
                              <span style="color: #b7b7b7">X</span>
                            </ng-container>
                          </ng-container>
                          <ng-container *ngIf="element?.student_type?.type_of_information !== 'classic'">
                            <ng-container *ngIf="!term && !term?.term_amount">
                              <span style="color: #b7b7b7">X</span>
                            </ng-container>
                          </ng-container>

                          <ng-container *ngIf="term">
                            <div style="text-align: end; margin-right: 8px">
                              <span class="date-terms" *ngIf="term?.term_status === 'partially_paid' && term?.term_pay_amount - term?.term_amount_chargeback > 0"
                                >{{
                                  term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount
                                    ? term?.term_pay_amount
                                      ? formatCurrency(term?.term_pay_amount)
                                      : (term?.term_pay_amount | currency : 'EURO' : '' : '0.2')
                                    : ''
                                }}
                                <mat-icon
                                  *ngIf="term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount"
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Paid' | translate }}"
                                  class="icon-status green"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>

                              <span *ngIf="!term?.is_partial">{{
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending
                                ? formatCurrency(
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending
                                )
                                : ''
                                }}
                                <mat-icon
                                  *ngIf="
                                    term?.term_status === 'billed' &&
                                    term?.term_amount >
                                      term?.term_amount_not_authorised + term?.term_amount_chargeback + term?.term_amount_pending
                                  "
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Generated' | translate }}"
                                  class="icon-status blue"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <span *ngIf="term?.is_partial && term?.term_status !== 'partially_paid'">{{
                                term?.term_amount_chargeback ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : 
                                term?.term_pay_amount ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_pay_amount -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : ''
                                }}
                                <mat-icon
                                  *ngIf="
                                    (term?.term_amount -
                                    term?.term_amount_chargeback -
                                    term?.term_amount_not_authorised -
                                    term?.term_amount_pending >
                                    0) ||
                                    (term?.term_amount -
                                    term?.term_pay_amount -
                                    term?.term_amount_not_authorised -
                                    term?.term_amount_pending >
                                    0)
                                  "
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Generated' | translate }}"
                                  class="icon-status blue"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <span *ngIf="term?.is_partial && term?.term_status === 'partially_paid'">{{
                                term?.term_amount_chargeback ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : 
                                term?.term_pay_amount ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_pay_amount -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : ''
                                }}
                                <mat-icon
                                  *ngIf="
                                    term?.term_amount -
                                    term?.term_pay_amount -
                                    term?.term_amount_chargeback -
                                    term?.term_amount_not_authorised -
                                    term?.term_amount_pending >
                                    0
                                  "
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Generated' | translate }}"
                                  class="icon-status blue"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <mat-icon
                                *ngIf="
                                  term?.is_term_paid && !term?.is_partial && term?.term_status === 'paid' && !term?.term_amount_chargeback
                                "
                                matTooltipPosition="above"
                                matTooltip="{{ 'Paid' | translate }}"
                                class="icon-status green"
                                aria-hidden="true">lens
                              </mat-icon>
                              <mat-icon
                                *ngIf="
                                  ((!term?.is_term_paid && term?.term_amount) || checkPartiallyTerms(term)) &&
                                  term?.term_status === 'not_billed' &&
                                  term?.term_amount_not_authorised &&
                                  term?.term_amount >
                                    term?.term_amount_not_authorised + term?.term_amount_chargeback + term?.term_amount_pending
                                "
                                matTooltipPosition="above"
                                matTooltip="{{ 'Refused' | translate }}"
                                class="icon-status red"
                                aria-hidden="true"
                                [ngClass]="{
                                  none: changedPlan(term) && term?.term_payment_deferment?.date && term?.term_status === 'not_billed'
                                }">lens
                              </mat-icon>
                            </div>
                            <div style="text-align: end; margin-right: 8px">
                              <span *ngIf="term?.term_amount_pending">
                                {{
                                term?.term_amount_pending
                                ? formatCurrency(term?.term_amount_pending)
                                : (term?.term_amount_pending | currency : 'EURO' : '' : '0.2')
                                }}
                                <mat-icon
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Pending' | translate }}"
                                  class="icon-status orange"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <span *ngIf="term?.term_amount_chargeback">
                                {{
                                term?.term_amount_chargeback
                                ? formatCurrency(term?.term_amount_chargeback)
                                : (term?.term_amount_chargeback | currency : 'EURO' : '' : '0.2')
                                }}
                                <mat-icon
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'chargeback' | translate }}"
                                  class="icon-status purple"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <span *ngIf="term?.term_amount_not_authorised">
                                {{
                                term?.term_amount_not_authorised
                                ? formatCurrency(term?.term_amount_not_authorised)
                                : (term?.term_amount_not_authorised | currency : 'EURO' : '' : '0.2')
                                }}
                                <mat-icon
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Refused' | translate }}"
                                  class="icon-status red"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                            </div>
                          </ng-container>
                        </ng-container>
                      </ng-container>
                    </ng-container>
                    <ng-container *ngIf="element?.term_6?.length > 1 || checkIfTermHaveChargebackAndHaveDifferentStatus(element?.term_6)">
                      <button
                        mat-icon-button
                        class="margin-right-button view-term"
                        matTooltip="{{ 'View term' | translate }}"
                        (click)="viewTermDetail(element?.term_6, 'January')">
                        <mat-icon svgIcon="eye"></mat-icon>
                      </button>
                    </ng-container>
                  </ng-container>
                </td>
              </ng-container>

              <ng-container matColumnDef="term7">
                <th mat-header-cell *matHeaderCellDef="let element" matTooltip="{{ 'Term 7' | translate }}"
                  matTooltipPosition="above">
                  <h5 style="font-size: 11px">
                    <mat-icon svgIcon="numeric-7-box" class="mat-icon-svgIcon"> numeric-7-box </mat-icon>
                    <span class="date-term">{{ 'February' | translate }}</span>
                  </h5>
                </th>
                <td mat-cell *matCellDef="let element" class="pad-l-xs">
                  <ng-container *ngIf="element?.term_7?.length < 1 || checkNoPayment(element)">
                    <span style="color: #b7b7b7">X</span>
                  </ng-container>
                  <ng-container *ngIf="element?.term_7?.length">
                    <ng-container *ngIf="element?.term_7?.length === 1 && !checkIfTermHaveChargebackAndHaveDifferentStatus(element?.term_7)">
                      <ng-container *ngFor="let term of element?.term_7">
                        <ng-container *ngIf="checkNoPayment(element)">
                          <div *ngIf="!term || !term?.term_amount" style="color: #b7b7b7">X</div>
                        </ng-container>

                        <ng-container *ngIf="!checkNoPayment(element)" [matTooltip]="term">
                          <ng-container *ngIf="element?.student_type?.type_of_information === 'classic'">
                            <ng-container *ngIf="!term || !term?.term_amount">
                              <span style="color: #b7b7b7">X</span>
                            </ng-container>
                          </ng-container>
                          <ng-container *ngIf="element?.student_type?.type_of_information !== 'classic'">
                            <ng-container *ngIf="!term && !term?.term_amount">
                              <span style="color: #b7b7b7">X</span>
                            </ng-container>
                          </ng-container>

                          <ng-container *ngIf="term">
                            <div style="text-align: end; margin-right: 8px">
                              <span class="date-terms" *ngIf="term?.term_status === 'partially_paid' && term?.term_pay_amount - term?.term_amount_chargeback > 0"
                                >{{
                                  term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount
                                    ? term?.term_pay_amount
                                      ? formatCurrency(term?.term_pay_amount)
                                      : (term?.term_pay_amount | currency : 'EURO' : '' : '0.2')
                                    : ''
                                }}
                                <mat-icon
                                  *ngIf="term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount"
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Paid' | translate }}"
                                  class="icon-status green"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>

                              <span *ngIf="!term?.is_partial">{{
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending
                                ? formatCurrency(
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending
                                )
                                : ''
                                }}
                                <mat-icon
                                  *ngIf="
                                    term?.term_status === 'billed' &&
                                    term?.term_amount >
                                      term?.term_amount_not_authorised + term?.term_amount_chargeback + term?.term_amount_pending
                                  "
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Generated' | translate }}"
                                  class="icon-status blue"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <span *ngIf="term?.is_partial && term?.term_status !== 'partially_paid'">{{
                                term?.term_amount_chargeback ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : 
                                term?.term_pay_amount ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_pay_amount -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : ''
                                }}
                                <mat-icon
                                  *ngIf="
                                    (term?.term_amount -
                                    term?.term_amount_chargeback -
                                    term?.term_amount_not_authorised -
                                    term?.term_amount_pending >
                                    0) ||
                                    (term?.term_amount -
                                    term?.term_pay_amount -
                                    term?.term_amount_not_authorised -
                                    term?.term_amount_pending >
                                    0)
                                  "
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Generated' | translate }}"
                                  class="icon-status blue"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <span *ngIf="term?.is_partial && term?.term_status === 'partially_paid'">{{
                                term?.term_amount_chargeback ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : 
                                term?.term_pay_amount ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_pay_amount -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : ''
                                }}
                                <mat-icon
                                  *ngIf="
                                    term?.term_amount -
                                    term?.term_pay_amount -
                                    term?.term_amount_chargeback -
                                    term?.term_amount_not_authorised -
                                    term?.term_amount_pending >
                                    0
                                  "
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Generated' | translate }}"
                                  class="icon-status blue"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <mat-icon
                                *ngIf="
                                  term?.is_term_paid && !term?.is_partial && term?.term_status === 'paid' && !term?.term_amount_chargeback
                                "
                                matTooltipPosition="above"
                                matTooltip="{{ 'Paid' | translate }}"
                                class="icon-status green"
                                aria-hidden="true">lens
                              </mat-icon>
                              <mat-icon
                                *ngIf="
                                  ((!term?.is_term_paid && term?.term_amount) || checkPartiallyTerms(term)) &&
                                  term?.term_status === 'not_billed' &&
                                  term?.term_amount_not_authorised &&
                                  term?.term_amount >
                                    term?.term_amount_not_authorised + term?.term_amount_chargeback + term?.term_amount_pending
                                "
                                matTooltipPosition="above"
                                matTooltip="{{ 'Refused' | translate }}"
                                class="icon-status red"
                                aria-hidden="true"
                                [ngClass]="{
                                  none: changedPlan(term) && term?.term_payment_deferment?.date && term?.term_status === 'not_billed'
                                }">lens
                              </mat-icon>
                            </div>
                            <div style="text-align: end; margin-right: 8px">
                              <span *ngIf="term?.term_amount_pending">
                                {{
                                term?.term_amount_pending
                                ? formatCurrency(term?.term_amount_pending)
                                : (term?.term_amount_pending | currency : 'EURO' : '' : '0.2')
                                }}
                                <mat-icon
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Pending' | translate }}"
                                  class="icon-status orange"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <span *ngIf="term?.term_amount_chargeback">
                                {{
                                term?.term_amount_chargeback
                                ? formatCurrency(term?.term_amount_chargeback)
                                : (term?.term_amount_chargeback | currency : 'EURO' : '' : '0.2')
                                }}
                                <mat-icon
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'chargeback' | translate }}"
                                  class="icon-status purple"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <span *ngIf="term?.term_amount_not_authorised">
                                {{
                                term?.term_amount_not_authorised
                                ? formatCurrency(term?.term_amount_not_authorised)
                                : (term?.term_amount_not_authorised | currency : 'EURO' : '' : '0.2')
                                }}
                                <mat-icon
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Refused' | translate }}"
                                  class="icon-status red"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                            </div>
                          </ng-container>
                        </ng-container>
                      </ng-container>
                    </ng-container>
                    <ng-container *ngIf="element?.term_7?.length > 1 || checkIfTermHaveChargebackAndHaveDifferentStatus(element?.term_7)">
                      <button
                        mat-icon-button
                        class="margin-right-button view-term"
                        matTooltip="{{ 'View term' | translate }}"
                        (click)="viewTermDetail(element?.term_7, 'February')">
                        <mat-icon svgIcon="eye"></mat-icon>
                      </button>
                    </ng-container>
                  </ng-container>
                </td>
              </ng-container>

              <ng-container matColumnDef="term8">
                <th mat-header-cell *matHeaderCellDef="let element" matTooltip="{{ 'Term 8' | translate }}"
                  matTooltipPosition="above">
                  <h5 style="font-size: 11px">
                    <mat-icon svgIcon="numeric-8-box" class="mat-icon-svgIcon"> numeric-8-box </mat-icon>
                    <span class="date-term">{{ 'March' | translate }}</span>
                  </h5>
                </th>
                <td mat-cell *matCellDef="let element" class="pad-l-xs">
                  <ng-container *ngIf="element?.term_8?.length < 1 || checkNoPayment(element)">
                    <span style="color: #b7b7b7">X</span>
                  </ng-container>
                  <ng-container *ngIf="element?.term_8?.length">
                    <ng-container *ngIf="element?.term_8?.length === 1 && !checkIfTermHaveChargebackAndHaveDifferentStatus(element?.term_8)">
                      <ng-container *ngFor="let term of element?.term_8">
                        <ng-container *ngIf="checkNoPayment(element)">
                          <div *ngIf="!term || !term?.term_amount" style="color: #b7b7b7">X</div>
                        </ng-container>

                        <ng-container *ngIf="!checkNoPayment(element)" [matTooltip]="term">
                          <ng-container *ngIf="element?.student_type?.type_of_information === 'classic'">
                            <ng-container *ngIf="!term || !term?.term_amount">
                              <span style="color: #b7b7b7">X</span>
                            </ng-container>
                          </ng-container>
                          <ng-container *ngIf="element?.student_type?.type_of_information !== 'classic'">
                            <ng-container *ngIf="!term && !term?.term_amount">
                              <span style="color: #b7b7b7">X</span>
                            </ng-container>
                          </ng-container>

                          <ng-container *ngIf="term">
                            <div style="text-align: end; margin-right: 8px">
                              <span class="date-terms" *ngIf="term?.term_status === 'partially_paid' && term?.term_pay_amount - term?.term_amount_chargeback > 0"
                                >{{
                                  term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount
                                    ? term?.term_pay_amount
                                      ? formatCurrency(term?.term_pay_amount)
                                      : (term?.term_pay_amount | currency : 'EURO' : '' : '0.2')
                                    : ''
                                }}
                                <mat-icon
                                  *ngIf="term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount"
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Paid' | translate }}"
                                  class="icon-status green"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>

                              <span *ngIf="!term?.is_partial">{{
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending
                                ? formatCurrency(
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending
                                )
                                : ''
                                }}
                                <mat-icon
                                  *ngIf="
                                    term?.term_status === 'billed' &&
                                    term?.term_amount >
                                      term?.term_amount_not_authorised + term?.term_amount_chargeback + term?.term_amount_pending
                                  "
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Generated' | translate }}"
                                  class="icon-status blue"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <span *ngIf="term?.is_partial && term?.term_status !== 'partially_paid'">{{
                                term?.term_amount_chargeback ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : 
                                term?.term_pay_amount ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_pay_amount -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : ''
                                }}
                                <mat-icon
                                  *ngIf="
                                    (term?.term_amount -
                                    term?.term_amount_chargeback -
                                    term?.term_amount_not_authorised -
                                    term?.term_amount_pending >
                                    0) ||
                                    (term?.term_amount -
                                    term?.term_pay_amount -
                                    term?.term_amount_not_authorised -
                                    term?.term_amount_pending >
                                    0)
                                  "
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Generated' | translate }}"
                                  class="icon-status blue"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>

                              <span *ngIf="term?.is_partial && term?.term_status === 'partially_paid'">{{
                                term?.term_amount_chargeback ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : 
                                term?.term_pay_amount ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_pay_amount -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : ''
                                }}
                                <mat-icon
                                  *ngIf="
                                    term?.term_amount -
                                    term?.term_pay_amount -
                                    term?.term_amount_chargeback -
                                    term?.term_amount_not_authorised -
                                    term?.term_amount_pending >
                                    0
                                  "
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Generated' | translate }}"
                                  class="icon-status blue"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <mat-icon
                                *ngIf="
                                  term?.is_term_paid && !term?.is_partial && term?.term_status === 'paid' && !term?.term_amount_chargeback
                                "
                                matTooltipPosition="above"
                                matTooltip="{{ 'Paid' | translate }}"
                                class="icon-status green"
                                aria-hidden="true">lens
                              </mat-icon>
                              <mat-icon
                                *ngIf="
                                  ((!term?.is_term_paid && term?.term_amount) || checkPartiallyTerms(term)) &&
                                  term?.term_status === 'not_billed' &&
                                  term?.term_amount_not_authorised &&
                                  term?.term_amount >
                                    term?.term_amount_not_authorised + term?.term_amount_chargeback + term?.term_amount_pending
                                "
                                matTooltipPosition="above"
                                matTooltip="{{ 'Refused' | translate }}"
                                class="icon-status red"
                                aria-hidden="true"
                                [ngClass]="{
                                  none: changedPlan(term) && term?.term_payment_deferment?.date && term?.term_status === 'not_billed'
                                }">lens
                              </mat-icon>
                            </div>
                            <div style="text-align: end; margin-right: 8px">
                              <span *ngIf="term?.term_amount_pending">
                                {{
                                term?.term_amount_pending
                                ? formatCurrency(term?.term_amount_pending)
                                : (term?.term_amount_pending | currency : 'EURO' : '' : '0.2')
                                }}
                                <mat-icon
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Pending' | translate }}"
                                  class="icon-status orange"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <span *ngIf="term?.term_amount_chargeback">
                                {{
                                term?.term_amount_chargeback
                                ? formatCurrency(term?.term_amount_chargeback)
                                : (term?.term_amount_chargeback | currency : 'EURO' : '' : '0.2')
                                }}
                                <mat-icon
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'chargeback' | translate }}"
                                  class="icon-status purple"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <span *ngIf="term?.term_amount_not_authorised">
                                {{
                                term?.term_amount_not_authorised
                                ? formatCurrency(term?.term_amount_not_authorised)
                                : (term?.term_amount_not_authorised | currency : 'EURO' : '' : '0.2')
                                }}
                                <mat-icon
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Refused' | translate }}"
                                  class="icon-status red"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                            </div>
                          </ng-container>
                        </ng-container>
                      </ng-container>
                    </ng-container>
                    <ng-container *ngIf="element?.term_8?.length > 1 || checkIfTermHaveChargebackAndHaveDifferentStatus(element?.term_8)">
                      <button
                        mat-icon-button
                        class="margin-right-button view-term"
                        matTooltip="{{ 'View term' | translate }}"
                        (click)="viewTermDetail(element?.term_8, 'March')">
                        <mat-icon svgIcon="eye"></mat-icon>
                      </button>
                    </ng-container>
                  </ng-container>
                </td>
              </ng-container>

              <ng-container matColumnDef="term9">
                <th mat-header-cell *matHeaderCellDef="let element" matTooltip="{{ 'Term 9' | translate }}"
                  matTooltipPosition="above">
                  <h5 style="font-size: 11px">
                    <mat-icon svgIcon="numeric-9-box" class="mat-icon-svgIcon"> numeric-9-box </mat-icon>
                    <span class="date-term">{{ 'April' | translate }}</span>
                  </h5>
                </th>
                <td mat-cell *matCellDef="let element" class="pad-l-xs">
                  <ng-container *ngIf="element?.term_9?.length < 1 || checkNoPayment(element)">
                    <span style="color: #b7b7b7">X</span>
                  </ng-container>
                  <ng-container *ngIf="element?.term_9?.length">
                    <ng-container *ngIf="element?.term_9?.length === 1 && !checkIfTermHaveChargebackAndHaveDifferentStatus(element?.term_9)">
                      <ng-container *ngFor="let term of element?.term_9">
                        <ng-container *ngIf="checkNoPayment(element)">
                          <div *ngIf="!term || !term?.term_amount" style="color: #b7b7b7">X</div>
                        </ng-container>

                        <ng-container *ngIf="!checkNoPayment(element)" [matTooltip]="term">
                          <ng-container *ngIf="element?.student_type?.type_of_information === 'classic'">
                            <ng-container *ngIf="!term || !term?.term_amount">
                              <span style="color: #b7b7b7">X</span>
                            </ng-container>
                          </ng-container>
                          <ng-container *ngIf="element?.student_type?.type_of_information !== 'classic'">
                            <ng-container *ngIf="!term && !term?.term_amount">
                              <span style="color: #b7b7b7">X</span>
                            </ng-container>
                          </ng-container>

                          <ng-container *ngIf="term">
                            <div style="text-align: end; margin-right: 8px">
                              <span class="date-terms" *ngIf="term?.term_status === 'partially_paid' && term?.term_pay_amount - term?.term_amount_chargeback > 0"
                                >{{
                                  term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount
                                    ? term?.term_pay_amount
                                      ? formatCurrency(term?.term_pay_amount)
                                      : (term?.term_pay_amount | currency : 'EURO' : '' : '0.2')
                                    : ''
                                }}
                                <mat-icon
                                  *ngIf="term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount"
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Paid' | translate }}"
                                  class="icon-status green"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>

                              <span *ngIf="!term?.is_partial">{{
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending
                                ? formatCurrency(
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending
                                )
                                : ''
                                }}
                                <mat-icon
                                  *ngIf="
                                    term?.term_status === 'billed' &&
                                    term?.term_amount >
                                      term?.term_amount_not_authorised + term?.term_amount_chargeback + term?.term_amount_pending
                                  "
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Generated' | translate }}"
                                  class="icon-status blue"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>

                              <span *ngIf="term?.is_partial && term?.term_status !== 'partially_paid'">{{
                                term?.term_amount_chargeback ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : 
                                term?.term_pay_amount ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_pay_amount -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : ''
                                }}
                                <mat-icon
                                  *ngIf="
                                    (term?.term_amount -
                                    term?.term_amount_chargeback -
                                    term?.term_amount_not_authorised -
                                    term?.term_amount_pending >
                                    0) ||
                                    (term?.term_amount -
                                    term?.term_pay_amount -
                                    term?.term_amount_not_authorised -
                                    term?.term_amount_pending >
                                    0)
                                  "
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Generated' | translate }}"
                                  class="icon-status blue"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>

                              <span *ngIf="term?.is_partial && term?.term_status === 'partially_paid'">{{
                                term?.term_amount_chargeback ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : 
                                term?.term_pay_amount ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_pay_amount -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : ''
                                }}
                                <mat-icon
                                  *ngIf="
                                    term?.term_amount -
                                    term?.term_pay_amount -
                                    term?.term_amount_chargeback -
                                    term?.term_amount_not_authorised -
                                    term?.term_amount_pending >
                                    0
                                  "
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Generated' | translate }}"
                                  class="icon-status blue"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>

                              <mat-icon
                                *ngIf="
                                  term?.is_term_paid && !term?.is_partial && term?.term_status === 'paid' && !term?.term_amount_chargeback
                                "
                                matTooltipPosition="above"
                                matTooltip="{{ 'Paid' | translate }}"
                                class="icon-status green"
                                aria-hidden="true">lens
                              </mat-icon>
                              <mat-icon
                                *ngIf="
                                  ((!term?.is_term_paid && term?.term_amount) || checkPartiallyTerms(term)) &&
                                  term?.term_status === 'not_billed' &&
                                  term?.term_amount_not_authorised &&
                                  term?.term_amount >
                                    term?.term_amount_not_authorised + term?.term_amount_chargeback + term?.term_amount_pending
                                "
                                matTooltipPosition="above"
                                matTooltip="{{ 'Refused' | translate }}"
                                class="icon-status red"
                                aria-hidden="true"
                                [ngClass]="{
                                  none: changedPlan(term) && term?.term_payment_deferment?.date && term?.term_status === 'not_billed'
                                }">lens
                              </mat-icon>
                            </div>
                            <div style="text-align: end; margin-right: 8px">
                              <span *ngIf="term?.term_amount_pending">
                                {{
                                term?.term_amount_pending
                                ? formatCurrency(term?.term_amount_pending)
                                : (term?.term_amount_pending | currency : 'EURO' : '' : '0.2')
                                }}
                                <mat-icon
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Pending' | translate }}"
                                  class="icon-status orange"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <span *ngIf="term?.term_amount_chargeback">
                                {{
                                term?.term_amount_chargeback
                                ? formatCurrency(term?.term_amount_chargeback)
                                : (term?.term_amount_chargeback | currency : 'EURO' : '' : '0.2')
                                }}
                                <mat-icon
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'chargeback' | translate }}"
                                  class="icon-status purple"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <span *ngIf="term?.term_amount_not_authorised">
                                {{
                                term?.term_amount_not_authorised
                                ? formatCurrency(term?.term_amount_not_authorised)
                                : (term?.term_amount_not_authorised | currency : 'EURO' : '' : '0.2')
                                }}
                                <mat-icon
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Refused' | translate }}"
                                  class="icon-status red"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                            </div>
                          </ng-container>
                        </ng-container>
                      </ng-container>
                    </ng-container>
                    <ng-container *ngIf="element?.term_9?.length > 1 || checkIfTermHaveChargebackAndHaveDifferentStatus(element?.term_9)">
                      <button
                        mat-icon-button
                        class="margin-right-button view-term"
                        matTooltip="{{ 'View term' | translate }}"
                        (click)="viewTermDetail(element?.term_9, 'April')">
                        <mat-icon svgIcon="eye"></mat-icon>
                      </button>
                    </ng-container>
                  </ng-container>
                </td>
              </ng-container>

              <ng-container matColumnDef="term10">
                <th mat-header-cell *matHeaderCellDef="let element" matTooltip="{{ 'Term 10' | translate }}"
                  matTooltipPosition="above">
                  <h5 style="font-size: 11px">
                    <mat-icon class="customs-icon">
                      <svg style="width: 16px; height: 16px" viewBox="0 0 24 24">
                        <path
                          fill="currentColor"
                          d="M14,9H16V15H14V9M21,5V19C21,20.11 20.11,21 19,21H5A2,2 0 0,1 3,19V5A2,2 0 0,1 5,3H19C20.11,3 21,3.9 21,5M10,7H6V9H8V17H10V7M18,9A2,2 0 0,0 16,7H14A2,2 0 0,0 12,9V15C12,16.11 12.9,17 14,17H16C17.11,17 18,16.11 18,15V9Z" />
                      </svg>
                    </mat-icon>
                    <span class="date-term" style="margin-top: -3px; margin-bottom: 15px">{{ 'May' | translate }}</span>
                  </h5>
                </th>
                <td mat-cell *matCellDef="let element" class="pad-l-xs">
                  <ng-container *ngIf="element?.term_10?.length < 1 || checkNoPayment(element)">
                    <span style="color: #b7b7b7">X</span>
                  </ng-container>
                  <ng-container *ngIf="element?.term_10?.length">
                    <ng-container *ngIf="element?.term_10?.length === 1 && !checkIfTermHaveChargebackAndHaveDifferentStatus(element?.term_10)">
                      <ng-container *ngFor="let term of element?.term_10">
                        <ng-container *ngIf="checkNoPayment(element)">
                          <div *ngIf="!term || !term?.term_amount" style="color: #b7b7b7">X</div>
                        </ng-container>

                        <ng-container *ngIf="!checkNoPayment(element)" [matTooltip]="term">
                          <ng-container *ngIf="element?.student_type?.type_of_information === 'classic'">
                            <ng-container *ngIf="!term || !term?.term_amount">
                              <span style="color: #b7b7b7">X</span>
                            </ng-container>
                          </ng-container>
                          <ng-container *ngIf="element?.student_type?.type_of_information !== 'classic'">
                            <ng-container *ngIf="!term && !term?.term_amount">
                              <span style="color: #b7b7b7">X</span>
                            </ng-container>
                          </ng-container>

                          <ng-container *ngIf="term">
                            <div style="text-align: end; margin-right: 8px">
                              <span class="date-terms" *ngIf="term?.term_status === 'partially_paid' && term?.term_pay_amount - term?.term_amount_chargeback > 0"
                                >{{
                                  term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount
                                    ? term?.term_pay_amount
                                      ? formatCurrency(term?.term_pay_amount)
                                      : (term?.term_pay_amount | currency : 'EURO' : '' : '0.2')
                                    : ''
                                }}
                                <mat-icon
                                  *ngIf="term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount"
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Paid' | translate }}"
                                  class="icon-status green"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>

                              <span *ngIf="!term?.is_partial">{{
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending
                                ? formatCurrency(
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending
                                )
                                : ''
                                }}
                                <mat-icon
                                  *ngIf="
                                    term?.term_status === 'billed' &&
                                    term?.term_amount >
                                      term?.term_amount_not_authorised + term?.term_amount_chargeback + term?.term_amount_pending
                                  "
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Generated' | translate }}"
                                  class="icon-status blue"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>

                              <span *ngIf="term?.is_partial && term?.term_status !== 'partially_paid'">{{
                                term?.term_amount_chargeback ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : 
                                term?.term_pay_amount ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_pay_amount -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : ''
                                }}
                                <mat-icon
                                  *ngIf="
                                    (term?.term_amount -
                                    term?.term_amount_chargeback -
                                    term?.term_amount_not_authorised -
                                    term?.term_amount_pending >
                                    0) ||
                                    (term?.term_amount -
                                    term?.term_pay_amount -
                                    term?.term_amount_not_authorised -
                                    term?.term_amount_pending >
                                    0)
                                  "
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Generated' | translate }}"
                                  class="icon-status blue"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>

                              <span *ngIf="term?.is_partial && term?.term_status === 'partially_paid'">{{
                                term?.term_amount_chargeback ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : 
                                term?.term_pay_amount ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_pay_amount -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : ''
                                }}
                                <mat-icon
                                  *ngIf="
                                    term?.term_amount -
                                    term?.term_pay_amount -
                                    term?.term_amount_chargeback -
                                    term?.term_amount_not_authorised -
                                    term?.term_amount_pending >
                                    0
                                  "
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Generated' | translate }}"
                                  class="icon-status blue"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>

                              <mat-icon
                                *ngIf="
                                  term?.is_term_paid && !term?.is_partial && term?.term_status === 'paid' && !term?.term_amount_chargeback
                                "
                                matTooltipPosition="above"
                                matTooltip="{{ 'Paid' | translate }}"
                                class="icon-status green"
                                aria-hidden="true">lens
                              </mat-icon>
                              <mat-icon
                                *ngIf="
                                  ((!term?.is_term_paid && term?.term_amount) || checkPartiallyTerms(term)) &&
                                  term?.term_status === 'not_billed' &&
                                  term?.term_amount_not_authorised &&
                                  term?.term_amount >
                                    term?.term_amount_not_authorised + term?.term_amount_chargeback + term?.term_amount_pending
                                "
                                matTooltipPosition="above"
                                matTooltip="{{ 'Refused' | translate }}"
                                class="icon-status red"
                                aria-hidden="true"
                                [ngClass]="{
                                  none: changedPlan(term) && term?.term_payment_deferment?.date && term?.term_status === 'not_billed'
                                }">lens
                              </mat-icon>
                            </div>
                            <div style="text-align: end; margin-right: 8px">
                              <span *ngIf="term?.term_amount_pending">
                                {{
                                term?.term_amount_pending
                                ? formatCurrency(term?.term_amount_pending)
                                : (term?.term_amount_pending | currency : 'EURO' : '' : '0.2')
                                }}
                                <mat-icon
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Pending' | translate }}"
                                  class="icon-status orange"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <span *ngIf="term?.term_amount_chargeback">
                                {{
                                term?.term_amount_chargeback
                                ? formatCurrency(term?.term_amount_chargeback)
                                : (term?.term_amount_chargeback | currency : 'EURO' : '' : '0.2')
                                }}
                                <mat-icon
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'chargeback' | translate }}"
                                  class="icon-status purple"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <span *ngIf="term?.term_amount_not_authorised">
                                {{
                                term?.term_amount_not_authorised
                                ? formatCurrency(term?.term_amount_not_authorised)
                                : (term?.term_amount_not_authorised | currency : 'EURO' : '' : '0.2')
                                }}
                                <mat-icon
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Refused' | translate }}"
                                  class="icon-status red"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                            </div>
                          </ng-container>
                        </ng-container>
                      </ng-container>
                    </ng-container>
                    <ng-container *ngIf="element?.term_10?.length > 1 || checkIfTermHaveChargebackAndHaveDifferentStatus(element?.term_10)">
                      <button
                        mat-icon-button
                        class="margin-right-button view-term"
                        matTooltip="{{ 'View term' | translate }}"
                        (click)="viewTermDetail(element?.term_10, 'May')">
                        <mat-icon svgIcon="eye"></mat-icon>
                      </button>
                    </ng-container>
                  </ng-container>
                </td>
              </ng-container>

              <ng-container matColumnDef="term11">
                <th mat-header-cell *matHeaderCellDef="let element" matTooltip="{{ 'Term 11' | translate }}"
                  matTooltipPosition="above">
                  <h5 style="font-size: 11px">
                    <span class="box-outline">11</span>
                    <span class="date-term">{{ 'June' | translate }}</span>
                  </h5>
                </th>
                <td mat-cell *matCellDef="let element" class="pad-l-xs">
                  <ng-container *ngIf="element?.term_11?.length < 1 || checkNoPayment(element)">
                    <span style="color: #b7b7b7">X</span>
                  </ng-container>
                  <ng-container *ngIf="element?.term_11?.length">
                    <ng-container *ngIf="element?.term_11?.length === 1 && !checkIfTermHaveChargebackAndHaveDifferentStatus(element?.term_11)">
                      <ng-container *ngFor="let term of element?.term_11">
                        <ng-container *ngIf="checkNoPayment(element)">
                          <div *ngIf="!term || !term?.term_amount" style="color: #b7b7b7">X</div>
                        </ng-container>

                        <ng-container *ngIf="!checkNoPayment(element)" [matTooltip]="term">
                          <ng-container *ngIf="element?.student_type?.type_of_information === 'classic'">
                            <ng-container *ngIf="!term || !term?.term_amount">
                              <span style="color: #b7b7b7">X</span>
                            </ng-container>
                          </ng-container>
                          <ng-container *ngIf="element?.student_type?.type_of_information !== 'classic'">
                            <ng-container *ngIf="!term && !term?.term_amount">
                              <span style="color: #b7b7b7">X</span>
                            </ng-container>
                          </ng-container>

                          <ng-container *ngIf="term">
                            <div style="text-align: end; margin-right: 8px">
                              <span class="date-terms" *ngIf="term?.term_status === 'partially_paid' && term?.term_pay_amount - term?.term_amount_chargeback > 0"
                                >{{
                                  term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount
                                    ? term?.term_pay_amount
                                      ? formatCurrency(term?.term_pay_amount)
                                      : (term?.term_pay_amount | currency : 'EURO' : '' : '0.2')
                                    : ''
                                }}
                                <mat-icon
                                  *ngIf="term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount"
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Paid' | translate }}"
                                  class="icon-status green"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>

                              <span *ngIf="!term?.is_partial">{{
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending
                                ? formatCurrency(
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending
                                )
                                : ''
                                }}
                                <mat-icon
                                  *ngIf="
                                    term?.term_status === 'billed' &&
                                    term?.term_amount >
                                      term?.term_amount_not_authorised + term?.term_amount_chargeback + term?.term_amount_pending
                                  "
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Generated' | translate }}"
                                  class="icon-status blue"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <span *ngIf="term?.is_partial && term?.term_status !== 'partially_paid'">{{
                                term?.term_amount_chargeback ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : 
                                term?.term_pay_amount ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_pay_amount -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : ''
                                }}
                                <mat-icon
                                  *ngIf="
                                    (term?.term_amount -
                                    term?.term_amount_chargeback -
                                    term?.term_amount_not_authorised -
                                    term?.term_amount_pending >
                                    0) ||
                                    (term?.term_amount -
                                    term?.term_pay_amount -
                                    term?.term_amount_not_authorised -
                                    term?.term_amount_pending >
                                    0)
                                  "
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Generated' | translate }}"
                                  class="icon-status blue"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>

                              <span *ngIf="term?.is_partial && term?.term_status === 'partially_paid'">{{
                                term?.term_amount_chargeback ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : 
                                term?.term_pay_amount ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_pay_amount -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : ''
                                }}
                                <mat-icon
                                  *ngIf="
                                    term?.term_amount -
                                    term?.term_pay_amount -
                                    term?.term_amount_chargeback -
                                    term?.term_amount_not_authorised -
                                    term?.term_amount_pending >
                                    0
                                  "
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Generated' | translate }}"
                                  class="icon-status blue"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>

                              <mat-icon
                                *ngIf="
                                  term?.is_term_paid && !term?.is_partial && term?.term_status === 'paid' && !term?.term_amount_chargeback
                                "
                                matTooltipPosition="above"
                                matTooltip="{{ 'Paid' | translate }}"
                                class="icon-status green"
                                aria-hidden="true">lens
                              </mat-icon>
                              <mat-icon
                                *ngIf="
                                  ((!term?.is_term_paid && term?.term_amount) || checkPartiallyTerms(term)) &&
                                  term?.term_status === 'not_billed' &&
                                  term?.term_amount_not_authorised &&
                                  term?.term_amount >
                                    term?.term_amount_not_authorised + term?.term_amount_chargeback + term?.term_amount_pending
                                "
                                matTooltipPosition="above"
                                matTooltip="{{ 'Refused' | translate }}"
                                class="icon-status red"
                                aria-hidden="true"
                                [ngClass]="{
                                  none: changedPlan(term) && term?.term_payment_deferment?.date && term?.term_status === 'not_billed'
                                }">lens
                              </mat-icon>
                            </div>
                            <div style="text-align: end; margin-right: 8px">
                              <span *ngIf="term?.term_amount_pending">
                                {{
                                term?.term_amount_pending
                                ? formatCurrency(term?.term_amount_pending)
                                : (term?.term_amount_pending | currency : 'EURO' : '' : '0.2')
                                }}
                                <mat-icon
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Pending' | translate }}"
                                  class="icon-status orange"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <span *ngIf="term?.term_amount_chargeback">
                                {{
                                term?.term_amount_chargeback
                                ? formatCurrency(term?.term_amount_chargeback)
                                : (term?.term_amount_chargeback | currency : 'EURO' : '' : '0.2')
                                }}
                                <mat-icon
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'chargeback' | translate }}"
                                  class="icon-status purple"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <span *ngIf="term?.term_amount_not_authorised">
                                {{
                                term?.term_amount_not_authorised
                                ? formatCurrency(term?.term_amount_not_authorised)
                                : (term?.term_amount_not_authorised | currency : 'EURO' : '' : '0.2')
                                }}
                                <mat-icon
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Refused' | translate }}"
                                  class="icon-status red"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                            </div>
                          </ng-container>
                        </ng-container>
                      </ng-container>
                    </ng-container>
                    <ng-container *ngIf="element?.term_11?.length > 1 || checkIfTermHaveChargebackAndHaveDifferentStatus(element?.term_11)">
                      <button
                        mat-icon-button
                        class="margin-right-button view-term"
                        matTooltip="{{ 'View term' | translate }}"
                        (click)="viewTermDetail(element?.term_11, 'June')">
                        <mat-icon svgIcon="eye"></mat-icon>
                      </button>
                    </ng-container>
                  </ng-container>
                </td>
              </ng-container>

              <ng-container matColumnDef="term12">
                <th mat-header-cell *matHeaderCellDef="let element" matTooltip="{{ 'Term 12' | translate }}"
                  matTooltipPosition="above">
                  <h5 style="font-size: 11px">
                    <span class="box-outline">12</span>
                    <span class="date-term">{{ 'July' | translate }}</span>
                  </h5>
                </th>
                <td mat-cell *matCellDef="let element" class="pad-l-xs">
                  <ng-container *ngIf="element?.term_12?.length < 1 || checkNoPayment(element)">
                    <span style="color: #b7b7b7">X</span>
                  </ng-container>
                  <ng-container *ngIf="element?.term_12?.length">
                    <ng-container *ngIf="element?.term_12?.length === 1 && !checkIfTermHaveChargebackAndHaveDifferentStatus(element?.term_12)">
                      <ng-container *ngFor="let term of element?.term_12">
                        <ng-container *ngIf="checkNoPayment(element)">
                          <div *ngIf="!term || !term?.term_amount" style="color: #b7b7b7">X</div>
                        </ng-container>

                        <ng-container *ngIf="!checkNoPayment(element)" [matTooltip]="term">
                          <ng-container *ngIf="element?.student_type?.type_of_information === 'classic'">
                            <ng-container *ngIf="!term || !term?.term_amount">
                              <span style="color: #b7b7b7">X</span>
                            </ng-container>
                          </ng-container>
                          <ng-container *ngIf="element?.student_type?.type_of_information !== 'classic'">
                            <ng-container *ngIf="!term && !term?.term_amount">
                              <span style="color: #b7b7b7">X</span>
                            </ng-container>
                          </ng-container>

                          <ng-container *ngIf="term">
                            <div style="text-align: end; margin-right: 8px">
                              <span class="date-terms" *ngIf="term?.term_status === 'partially_paid' && term?.term_pay_amount - term?.term_amount_chargeback > 0"
                                >{{
                                  term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount
                                    ? term?.term_pay_amount
                                      ? formatCurrency(term?.term_pay_amount)
                                      : (term?.term_pay_amount | currency : 'EURO' : '' : '0.2')
                                    : ''
                                }}
                                <mat-icon
                                  *ngIf="term?.term_pay_amount && term?.term_pay_amount !== term?.term_amount"
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Paid' | translate }}"
                                  class="icon-status green"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>

                              <span *ngIf="!term?.is_partial">{{
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending
                                ? formatCurrency(
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending
                                )
                                : ''
                                }}
                                <mat-icon
                                  *ngIf="
                                    term?.term_status === 'billed' &&
                                    term?.term_amount >
                                      term?.term_amount_not_authorised + term?.term_amount_chargeback + term?.term_amount_pending
                                  "
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Generated' | translate }}"
                                  class="icon-status blue"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <span *ngIf="term?.is_partial && term?.term_status !== 'partially_paid'">{{
                                term?.term_amount_chargeback ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : 
                                term?.term_pay_amount ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_pay_amount -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : ''
                                }}
                                <mat-icon
                                  *ngIf="
                                    (term?.term_amount -
                                    term?.term_amount_chargeback -
                                    term?.term_amount_not_authorised -
                                    term?.term_amount_pending >
                                    0) ||
                                    (term?.term_amount -
                                    term?.term_pay_amount -
                                    term?.term_amount_not_authorised -
                                    term?.term_amount_pending >
                                    0)
                                  "
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Generated' | translate }}"
                                  class="icon-status blue"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <span *ngIf="term?.is_partial && term?.term_status === 'partially_paid'">{{
                                term?.term_amount_chargeback ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_amount_chargeback -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : 
                                term?.term_pay_amount ? 
                                formatCurrency(
                                term?.term_amount -
                                term?.term_pay_amount -
                                term?.term_amount_not_authorised -
                                term?.term_amount_pending) : ''
                                }}
                                <mat-icon
                                  *ngIf="
                                    term?.term_amount -
                                    term?.term_pay_amount -
                                    term?.term_amount_chargeback -
                                    term?.term_amount_not_authorised -
                                    term?.term_amount_pending >
                                    0
                                  "
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Generated' | translate }}"
                                  class="icon-status blue"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <mat-icon
                                *ngIf="
                                  term?.is_term_paid && !term?.is_partial && term?.term_status === 'paid' && !term?.term_amount_chargeback
                                "
                                matTooltipPosition="above"
                                matTooltip="{{ 'Paid' | translate }}"
                                class="icon-status green"
                                aria-hidden="true">lens
                              </mat-icon>
                              <mat-icon
                                *ngIf="
                                  ((!term?.is_term_paid && term?.term_amount) || checkPartiallyTerms(term)) &&
                                  term?.term_status === 'not_billed' &&
                                  term?.term_amount_not_authorised &&
                                  term?.term_amount >
                                    term?.term_amount_not_authorised + term?.term_amount_chargeback + term?.term_amount_pending
                                "
                                matTooltipPosition="above"
                                matTooltip="{{ 'Refused' | translate }}"
                                class="icon-status red"
                                aria-hidden="true"
                                [ngClass]="{
                                  none: changedPlan(term) && term?.term_payment_deferment?.date && term?.term_status === 'not_billed'
                                }">lens
                              </mat-icon>
                            </div>
                            <div style="text-align: end; margin-right: 8px">
                              <span *ngIf="term?.term_amount_pending">
                                {{
                                term?.term_amount_pending
                                ? formatCurrency(term?.term_amount_pending)
                                : (term?.term_amount_pending | currency : 'EURO' : '' : '0.2')
                                }}
                                <mat-icon
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Pending' | translate }}"
                                  class="icon-status orange"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <span *ngIf="term?.term_amount_chargeback">
                                {{
                                term?.term_amount_chargeback
                                ? formatCurrency(term?.term_amount_chargeback)
                                : (term?.term_amount_chargeback | currency : 'EURO' : '' : '0.2')
                                }}
                                <mat-icon
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'chargeback' | translate }}"
                                  class="icon-status purple"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                              <span *ngIf="term?.term_amount_not_authorised">
                                {{
                                term?.term_amount_not_authorised
                                ? formatCurrency(term?.term_amount_not_authorised)
                                : (term?.term_amount_not_authorised | currency : 'EURO' : '' : '0.2')
                                }}
                                <mat-icon
                                  matTooltipPosition="above"
                                  matTooltip="{{ 'Refused' | translate }}"
                                  class="icon-status red"
                                  aria-hidden="true">lens
                                </mat-icon>
                              </span>
                            </div>
                          </ng-container>
                        </ng-container>
                      </ng-container>
                    </ng-container>
                    <ng-container *ngIf="element?.term_12?.length > 1 || checkIfTermHaveChargebackAndHaveDifferentStatus(element?.term_12)">
                      <button
                        mat-icon-button
                        class="margin-right-button view-term"
                        matTooltip="{{ 'View term' | translate }}"
                        (click)="viewTermDetail(element?.term_12, 'July')">
                        <mat-icon svgIcon="eye"></mat-icon>
                      </button>
                    </ng-container>
                  </ng-container>
                </td>
              </ng-container>

              <ng-container matColumnDef="loading">
                <th mat-header-cell *matHeaderCellDef colspan="100%" style="text-align: center !important">
                  <div class="center-spinner">
                    <mat-spinner color="accent"></mat-spinner>
                  </div>
                </th>
              </ng-container>

              <tr mat-header-row *matHeaderRowDef="financeStatusDisplayedColumns"></tr>
              <tr mat-header-row *matHeaderRowDef="['loading']" [hidden]="!financeStatusLoading"></tr>
              <tr mat-row *matRowDef="let row; columns: financeStatusDisplayedColumns" [hidden]="financeStatusLoading">
              </tr>
            </table>
          </div>
          <div *ngIf="noFinancialData | async" class="no-records" [ngClass]="{ hide: financeStatusLoading }">
            {{ 'NOT RECORD FOUND' | translate }}
          </div>
        </div>

        <div class="p-grid top-space">
          <div class="p-col-12 panel-divider"></div>
          <div class="p-col-12 no-padding">
            <h4>{{ 'Student Balance' | translate }}</h4>
          </div>
        </div>

        <div class="mat-elevation-z8 balance-table" style="font-family: 'firaSans' !important">
          <div class="student-balance-action">
            <button
              *ngIf="permissionActionFinance?.includes(currentUserTypeId)"
              mat-button
              mat-raised-button
              class="relative"
              style="width: 75px; padding-left: 7px !important"
              color="accent"
              matTooltip="{{ 'Action' | translate }}"
              matTooltipPosition="above"
              [disabled]="isLoading || financeStatusLoading"
              [matMenuTriggerFor]="action"
              data-cy="button-action-menu">
              {{ 'Action' | translate }}
              <mat-icon>expand_more</mat-icon>
            </button>
            <mat-menu #action="matMenu">
              <button
                mat-menu-item
                matTooltip="{{ 'Add billing' | translate }}"
                class="border-button"
                (click)="actionTrigger('billing')"
                data-cy="button-add-billing-menu">
                {{ 'Add billing' | translate }}
              </button>
              <button
                mat-menu-item
                matTooltip="{{ 'Add payment line' | translate }}"
                class="border-button"
                (click)="actionTrigger('payment_line')"
                data-cy="button-add-payment-line-menu">
                {{ 'Add payment line' | translate }}
              </button>
              <button
                mat-menu-item
                matTooltip="{{ 'Add avoir/discount' | translate }}"
                class="border-button"
                (click)="actionTrigger('avoir/discount')"
                data-cy="button-add-avoir-menu">
                {{ 'Add avoir/discount' | translate }}
              </button>
              <button
                mat-menu-item
                matTooltip="{{ 'Add refund' | translate }}"
                class="border-button"
                (click)="actionTrigger('refund')"
                data-cy="button-add-refund-menu">
                {{ 'Add refund' | translate }}
              </button>
              <button
                mat-menu-item
                matTooltip="{{ 'Add OD' | translate }}"
                [class]="{ 'border-button': hasBilledTerm }"
                (click)="actionTrigger('od')"
                data-cy="button-add-od-menu">
                {{ 'Add OD' | translate }}
              </button>
              <button
                mat-menu-item
                *ngIf="hasBilledTerm"
                matTooltip="{{ 'Download_invoice' | translate }}"
                (click)="downloadInvoice()"
                data-cy="button-download-invoice-menu">
                {{ 'Download_invoice' | translate }}
              </button>
            </mat-menu>
            <button
              *ngIf="permissionActionFinanceForAcademic?.includes(currentUserTypeId)"
              mat-button
              mat-raised-button
              class="relative"
              style="width: 75px; padding-left: 7px !important"
              color="accent"
              matTooltip="{{ 'Action' | translate }}"
              matTooltipPosition="above"
              [disabled]="isLoading || financeStatusLoading"
              [matMenuTriggerFor]="actionAcademic"
              data-cy="button-action-menu">
              {{ 'Action' | translate }}
              <mat-icon>expand_more</mat-icon>
            </button>
            <mat-menu #actionAcademic="matMenu" [xPosition]="'before'" [yPosition]="'below'">
              <button
                mat-menu-item
                matTooltip="{{ 'Add billing' | translate }}"
                class="border-button"
                *ngIf="hasBilledTerm"
                matTooltip="{{ 'Download_invoice' | translate }}"
                (click)="downloadInvoice()"
                data-cy="button-download-invoice-menu">
                {{ 'Download_invoice' | translate }}
              </button>
            </mat-menu>
            <!-- <button
              mat-button
              mat-raised-button
              color="primary"
              style="min-width: 75px; max-width: 109px; padding-left: 7px !important"
              [matTooltip]="'RESET' | translate"
              matTooltipPosition="above"
              [disabled]="isLoading"
              (click)="resetTable()"
            >
              <mat-icon svgIcon="loop" class="mat-icon-svgIcon"></mat-icon>
              {{ 'RESET' | translate }}
            </button> -->
          </div>
          <table mat-table [dataSource]="studentBalanceDataSource" class="mat-elevation-z8"
            style="font-family: 'firaSans'">
            <!-- Row one -->
            <ng-container matColumnDef="date-balance" sticky>
              <th mat-header-cell *matHeaderCellDef class="action-header-column non-col"
                data-cy="table-col-date-balance"></th>
            </ng-container>
            <ng-container matColumnDef="operation-name-balance" sticky>
              <th mat-header-cell *matHeaderCellDef class="action-header-column non-col"
                data-cy="table-col-operation-name-balance"></th>
            </ng-container>
            <ng-container matColumnDef="payer-balance" sticky>
              <th mat-header-cell *matHeaderCellDef class="action-header-column non-col"
                data-cy="table-col-payer-balance"></th>
            </ng-container>
            <ng-container matColumnDef="flux-balance">
              <th mat-header-cell *matHeaderCellDef class="action-header-column non-col"
                data-cy="table-col-flux-balance"></th>
            </ng-container>
            <ng-container matColumnDef="nature-balance">
              <th
                mat-header-cell
                *matHeaderCellDef
                class="action-header-column non-col"
                style="text-align: right !important"
                data-cy="table-col-nature-balance">
                <span style="padding-right: 6px">{{ 'student_balance.Balance' | translate }}:</span>
              </th>
            </ng-container>
            <ng-container matColumnDef="debit-balance">
              <th mat-header-cell *matHeaderCellDef class="action-header-column non-col"
                data-cy="table-col-debit-balance"></th>
            </ng-container>
            <ng-container matColumnDef="credit-balance">
              <th
                mat-header-cell
                *matHeaderCellDef
                class="action-header-column"
                [style.background-color]="totalBalance ? 'red' : 'green'"
                style="text-align: right !important"
                data-cy="table-col-credit-balance">
                {{ totalBalance ? totalBalance : '0' }} €
              </th>
            </ng-container>
            <ng-container matColumnDef="solde-balance">
              <th mat-header-cell *matHeaderCellDef class="action-header-column non-col"
                data-cy="table-col-solde-balance"></th>
            </ng-container>
            <ng-container matColumnDef="status-term-balance">
              <th mat-header-cell *matHeaderCellDef class="action-header-column non-col"
                data-cy="table-col-status-term-balance"></th>
            </ng-container>
            <ng-container matColumnDef="payment-date-balance">
              <th mat-header-cell *matHeaderCellDef class="action-header-column non-col"
                data-cy="table-col-payment-date-balance"></th>
            </ng-container>
            <ng-container matColumnDef="accounting-document-balance">
              <th
                mat-header-cell
                *matHeaderCellDef
                class="action-header-column non-col"
                data-cy="table-col-accounting-document-balance"></th>
            </ng-container>
            <ng-container matColumnDef="balance-date-balance">
              <th mat-header-cell *matHeaderCellDef class="action-header-column non-col"
                data-cy="table-col-balance-date-balance"></th>
            </ng-container>
            <ng-container matColumnDef="legal-entity-balance">
              <th mat-header-cell *matHeaderCellDef class="action-header-column non-col" data-cy="table-col-legal-entity-balance"></th>
            </ng-container>
            <ng-container matColumnDef="user-balance">
              <th mat-header-cell *matHeaderCellDef class="action-header-column non-col" data-cy="table-col-user-balance"></th>
            </ng-container>
            <ng-container matColumnDef="action-balance" stickyEnd>
              <th
                mat-header-cell
                *matHeaderCellDef
                class="action-header-column non-col"
                style="text-align: right !important"
                data-cy="table-col-action-balance"></th>
            </ng-container>

            <!-- Row two -->
            <ng-container matColumnDef="date-total" sticky>
              <th mat-header-cell *matHeaderCellDef class="action-header-column non-col" data-cy="table-col-date-total">
              </th>
            </ng-container>
            <ng-container matColumnDef="operation-name-total" sticky>
              <th mat-header-cell *matHeaderCellDef class="action-header-column non-col"
                data-cy="table-col-operation-name-total"></th>
            </ng-container>
            <ng-container matColumnDef="payer-total" sticky>
              <th mat-header-cell *matHeaderCellDef class="action-header-column non-col"
                data-cy="table-col-payer-total"></th>
            </ng-container>
            <ng-container matColumnDef="flux-total">
              <th mat-header-cell *matHeaderCellDef class="action-header-column non-col" data-cy="table-col-flux-total">
              </th>
            </ng-container>
            <ng-container matColumnDef="nature-total">
              <th
                mat-header-cell
                *matHeaderCellDef
                class="action-header-column non-col"
                style="text-align: right !important"
                data-cy="table-col-nature-total">
                <span style="padding-right: 6px">{{ 'Total' | translate }}:</span>
              </th>
            </ng-container>
            <ng-container matColumnDef="debit-total">
              <th
                mat-header-cell
                *matHeaderCellDef
                class="action-header-column"
                style="text-align: right !important"
                data-cy="table-col-debit-total">
                {{ formatCurrencyHistory(totalDebit) ? formatCurrencyHistory(totalDebit) : '0' }} €
              </th>
            </ng-container>
            <ng-container matColumnDef="credit-total">
              <th
                mat-header-cell
                *matHeaderCellDef
                class="action-header-column"
                style="text-align: right !important"
                data-cy="table-col-credit-total">
                {{ formatCurrencyHistory(totalCredit) ? formatCurrencyHistory(totalCredit) : '0' }} €
              </th>
            </ng-container>
            <ng-container matColumnDef="solde-total">
              <th mat-header-cell *matHeaderCellDef class="action-header-column non-col"
                data-cy="table-col-solde-total"></th>
            </ng-container>
            <ng-container matColumnDef="status-term-total">
              <th mat-header-cell *matHeaderCellDef class="action-header-column non-col"
                data-cy="table-col-status-term-total"></th>
            </ng-container>
            <ng-container matColumnDef="payment-date-total">
              <th mat-header-cell *matHeaderCellDef class="action-header-column non-col"
                data-cy="table-col-payment-date-total"></th>
            </ng-container>
            <ng-container matColumnDef="accounting-document-total">
              <th mat-header-cell *matHeaderCellDef class="action-header-column non-col"
                data-cy="table-col-accounting-document-total"></th>
            </ng-container>
            <ng-container matColumnDef="balance-date-total">
              <th mat-header-cell *matHeaderCellDef class="action-header-column non-col"
                data-cy="table-col-balance-date-total"></th>
            </ng-container>
            <ng-container matColumnDef="legal-entity-total">
              <th mat-header-cell *matHeaderCellDef class="action-header-column non-col" data-cy="table-col-legal-entity-total"></th>
            </ng-container>
            <ng-container matColumnDef="user-total">
              <th mat-header-cell *matHeaderCellDef class="action-header-column non-col" data-cy="table-col-user-total"></th>
            </ng-container>
            <ng-container matColumnDef="action-total" stickyEnd>
              <th mat-header-cell *matHeaderCellDef class="action-header-column non-col"
                data-cy="table-col-action-total"></th>
            </ng-container>

            <!-- Row three -->
            <ng-container matColumnDef="date" sticky>
              <th
                mat-header-cell
                *matHeaderCellDef
                matTooltip="{{ 'Date' | translate }}"
                matTooltipPosition="above"
                data-cy="table-col-date">
                <h5 style="font-size: 11px; padding: 0px 2px; font-weight: 500">
                  {{ 'Date' | translate }}
                </h5>
              </th>
              <td
                mat-cell
                *matCellDef="let element"
                style="text-align: center !important"
                matTooltip="{{ translateDate(element?.date_action?.date, element?.date_action?.time) }}"
                data-cy="table-col-date">
                <span>{{ translateDate(element?.date_action?.date, element?.date_action?.time) }}</span>
              </td>
            </ng-container>

            <ng-container matColumnDef="operation-name" sticky>
              <th
                data-cy="table-col-operation-name"
                mat-header-cell
                *matHeaderCellDef
                matTooltip="{{ 'Operation name' | translate }}"
                matTooltipPosition="above">
                <h5 style="font-size: 11px; padding: 0px 2px; font-weight: 500">
                  {{ 'Operation name' | translate }}
                </h5>
              </th>
              <td
                data-cy="table-col-operation-name"
                mat-cell
                *matCellDef="let element"
                class="pad-l-xs"
                style="text-align: left !important">
                <span
                  *ngIf="element?.operation_name === 'payment_of_term' && element?.nature !== 'cancel'"
                  matTooltip="{{ 'OPERATION_NAME.' + element?.operation_name | translate }} {{
                    parseTermIndexToNumber(element?.term_index)
                  }}">
                  {{ 'OPERATION_NAME.' + element?.operation_name | translate }} {{
                  parseTermIndexToNumber(element?.term_index) }}
                </span>
                <span
                  *ngIf="
                    (element?.nature === 'Avoir' || element?.nature === 'avoir') &&
                    element?.operation_name === 'avoir_of_term' &&
                    !element?.is_manual_action
                  "
                >
                  {{ 'OPERATION_NAME.' + element?.operation_name | translate }} {{ parseTermIndexToNumber(element?.term_index) }}
                </span>
                <span
                  *ngIf="
                    (element?.operation_name === 'chargeback_of_term' || element?.operation_name === 'billing_of_term') &&
                    element?.nature !== 'cancel'
                  "
                  matTooltip="{{ 'OPERATION_NAME.' + element?.operation_name | translate }} {{
                    parseTermIndexToNumber(element?.term_index)
                  }}">
                  {{ 'OPERATION_NAME.' + element?.operation_name | translate }} {{
                  parseTermIndexToNumber(element?.term_index) }}
                </span>
                <span
                  *ngIf="element?.operation_name !== 'chargeback_of_term' && element?.nature === 'cancel'"
                  matTooltip="{{ 'OPERATION_NAME.Cancel payment of term' | translate }} {{ parseTermIndexToNumber(element?.term_index) }}">
                  {{ 'OPERATION_NAME.Cancel payment of term' | translate }} {{
                  parseTermIndexToNumber(element?.term_index) }}
                </span>
                <span
                  *ngIf="element?.operation_name === 'regulation_payment' && element?.nature !== 'cancel'"
                  matTooltip="{{ 'OPERATION_NAME.payment_of_term' | translate }} {{ parseTermIndexToNumber(element?.term_index) }} - {{
                    'Regulation' | translate
                  }}"
                >
                  {{ 'OPERATION_NAME.payment_of_term' | translate }} {{ parseTermIndexToNumber(element?.term_index) }} -
                  {{ 'Regulation' | translate }}
                </span>
                <span
                  *ngIf="
                    element?.operation_name !== 'payment_of_term' &&
                    element?.operation_name !== 'chargeback_of_term' &&
                    element?.operation_name !== 'billing_of_term' &&
                    element?.operation_name !== 'avoir_of_term' &&
                    element?.operation_name !== 'regulation_payment' &&
                    element?.nature !== 'cancel'
                  "
                  [matTooltip]="displayOperationName(element?.operation_name)">
                  {{ displayOperationName(element?.operation_name) }}
                </span>
              </td>
            </ng-container>

            <ng-container matColumnDef="payer" sticky>
              <th
                data-cy="table-col-payer"
                mat-header-cell
                *matHeaderCellDef
                matTooltip="{{ 'Payer' | translate }}"
                matTooltipPosition="above">
                <h5 style="font-size: 11px; padding: 0px 2px; font-weight: 500">
                  {{ 'Payer' | translate }}
                </h5>
              </th>
              <td data-cy="table-col-payer" mat-cell *matCellDef="let element" class="pad-l-xs"
                style="text-align: left !important">
                <!-- try to disable avoir condition-->
                <!-- <ng-container *ngIf="element?.nature?.toLowerCase() === 'avoir' && element?.operation_name !== 'avoir_of_dp'">
                  <span style="padding-left: 5px" matTooltip="{{ element?.from }}" *ngIf="element?.is_manual_action">
                    {{ element?.from }}
                  </span>
                  <span style="padding-left: 5px" matTooltip="{{ element?.from }}"
                    *ngIf="!element?.is_manual_action
                          && element?.operation_name === 'avoir_of_term'">
                    {{ element?.from }}
                  </span>
                  <div style="text-align: center"
                  *ngIf="
                    !element?.is_manual_action
                    && element?.operation_name !== 'avoir_of_term'"
                  >-</div>
                </ng-container> -->

                <ng-container>
                  <ng-container
                    *ngIf="
                      element?.operation_name === 'scholarship_fee' ||
                      element?.operation_name === 'additional_cost' ||
                      element?.operation_name === 'modality_fee' ||
                      element?.operation_name === 'cash_transfer' ||
                      element?.operation_name === 'avoir_scholarship_fee' ||
                      element?.operation_name === 'avoir_additional_cost' ||
                      element?.operation_name === 'avoir_modality_fee' ||
                      element?.transaction_type === 'billing_manual' ||
                      element?.flux === 'billing'
                    "
                  >
                    <div style="text-align: center">-</div>
                  </ng-container>
                  <ng-container
                    *ngIf="
                      (element?.flux !== 'billing' &&
                        element?.transaction_type !== 'billing_manual' &&
                        element?.operation_name !== 'scholarship_fee' &&
                        element?.operation_name !== 'additional_cost' &&
                        element?.operation_name !== 'modality_fee' &&
                        element?.operation_name !== 'avoir_scholarship_fee' &&
                        element?.operation_name !== 'avoir_additional_cost' &&
                        element?.operation_name !== 'avoir_modality_fee' &&
                        element?.operation_name !== 'cash_transfer') ||
                      (element?.nature?.toLowerCase() === 'avoir' &&
                        element?.is_manual_action &&
                        element?.operation_name === 'avoir_of_term')
                    ">
                    <span
                      *ngIf="!element?.billing_id?.is_financial_support && !element?.finance_organization_id"
                      style="padding-left: 5px"
                      matTooltip="{{ element?.candidate_id?.first_name + ' ' + (element?.candidate_id?.last_name | uppercase) }}">
                      {{ element?.candidate_id?.first_name + ' ' + (element?.candidate_id?.last_name | uppercase) }}
                    </span>
                    <span
                      *ngIf="element?.billing_id?.is_financial_support && !element?.finance_organization_id"
                      style="padding-left: 5px"
                      matTooltip="{{
                        element?.billing_id?.financial_support_info?.name +
                          ' ' +
                          (element?.billing_id?.financial_support_info?.family_name | uppercase)
                      }}">
                      {{
                      element?.billing_id?.financial_support_info?.name +
                      ' ' +
                      (element?.billing_id?.financial_support_info?.family_name | uppercase)
                      }}
                    </span>
                    <span
                      *ngIf="
                        (element?.billing_id?.is_financial_support || !element?.billing_id?.is_financial_support) &&
                        element?.finance_organization_id?.company_branch_id
                      "
                      style="padding-left: 5px"
                      matTooltip="{{ element?.finance_organization_id?.company_branch_id?.company_name }}">
                      {{ element?.finance_organization_id?.company_branch_id?.company_name }}
                    </span>
                    <span
                      *ngIf="element?.finance_organization_id?.organization_id"
                      style="padding-left: 5px"
                      [matTooltip]="element?.finance_organization_id?.organization_id?.name">
                      {{ element?.finance_organization_id?.organization_id?.name }}
                    </span>
                  </ng-container>
                </ng-container>
              </td>
            </ng-container>

            <ng-container matColumnDef="flux">
              <th
                data-cy="table-col-flux"
                mat-header-cell
                *matHeaderCellDef
                matTooltip="{{ 'Flux' | translate }}"
                matTooltipPosition="above">
                <h5 style="font-size: 11px; padding: 0px 2px; font-weight: 500">
                  {{ 'Flux' | translate }}
                </h5>
              </th>
              <td data-cy="table-col-flux" mat-cell *matCellDef="let element" class="pad-l-xs"
                matTooltip="{{ element?.flux | translate }}">
                <span> {{ element?.flux | translate }} </span>
              </td>
            </ng-container>

            <ng-container matColumnDef="nature">
              <th
                data-cy="table-col-nature"
                mat-header-cell
                *matHeaderCellDef
                matTooltip="{{ 'Nature' | translate }}"
                matTooltipPosition="above">
                <h5 style="font-size: 11px; padding: 0px 2px; font-weight: 500">
                  {{ 'Nature' | translate }}
                </h5>
              </th>
              <td
                data-cy="table-col-nature"
                mat-cell
                *matCellDef="let element"
                class="pad-l-xs"
                matTooltip="{{ 'nature_type.' + element?.nature | translate }}">
                <span> {{ 'nature_type.' + element?.nature | translate }} </span>
              </td>
            </ng-container>

            <ng-container matColumnDef="debit">
              <th
                data-cy="table-col-debit"
                mat-header-cell
                *matHeaderCellDef
                matTooltip="{{ 'Debit' | translate }}"
                matTooltipPosition="above">
                <h5 style="font-size: 11px; padding: 0px 2px; font-weight: 500">
                  {{ 'Debit' | translate }}
                </h5>
              </th>
              <td data-cy="table-col-debit" mat-cell *matCellDef="let element" class="pad-l-xs"
                style="text-align: right !important">
                <span *ngIf="element.debit">{{ formatCurrencyHistory(element?.debit) }}€</span>
                <!-- <span *ngIf="!element.debit">-</span> -->
              </td>
            </ng-container>

            <ng-container matColumnDef="credit">
              <th
                data-cy="table-col-credit"
                mat-header-cell
                *matHeaderCellDef
                matTooltip="{{ 'Credit' | translate }}"
                matTooltipPosition="above">
                <h5 style="font-size: 11px; padding: 0px 2px; font-weight: 500">
                  {{ 'Credit' | translate }}
                </h5>
              </th>
              <td data-cy="table-col-credit" mat-cell *matCellDef="let element" class="pad-l-xs"
                style="text-align: right !important">
                <span *ngIf="element.credit">{{ formatCurrencyHistory(element?.credit) }}€</span>
                <!-- <span *ngIf="!element.credit">-</span> -->
              </td>
            </ng-container>

            <ng-container matColumnDef="solde">
              <th
                data-cy="table-col-solde"
                mat-header-cell
                *matHeaderCellDef
                matTooltip="{{ 'student_balance.Solde' | translate }}"
                matTooltipPosition="above">
                <h5 style="font-size: 11px; padding: 0px 2px; font-weight: 500">
                  {{ 'student_balance.Solde' | translate }}
                </h5>
              </th>
              <td data-cy="table-col-solde" mat-cell *matCellDef="let element" class="pad-l-xs"
                style="text-align: right !important">
                <span>{{ formatCurrencyHistory(element?.balance) ? formatCurrencyHistory(element?.balance) : '0'
                  }}€</span>
              </td>
            </ng-container>

            <ng-container matColumnDef="status-term">
              <th
                data-cy="table-col-status-term"
                mat-header-cell
                *matHeaderCellDef
                matTooltip="{{ 'Status term' | translate }}"
                matTooltipPosition="above">
                <h5 style="font-size: 11px; padding: 0px 2px; font-weight: 500">
                  {{ 'Status term' | translate }}
                </h5>
              </th>
              <td data-cy="table-col-status-term" mat-cell *matCellDef="let element" class="pad-l-xs">
                <span *ngIf="displayStatusTermColor(element)">
                  <mat-icon
                    [ngClass]="displayStatusTermColor(element)"
                    class="mat-icon-status"
                    aria-hidden="true"
                    [matTooltip]="displayStatusTermTooltip(element)"
                    >lens</mat-icon
                  >
                </span>
                <span *ngIf="!displayStatusTermColor(element)"> - </span>
              </td>
            </ng-container>

            <ng-container matColumnDef="payment-date">
              <th
                data-cy="table-col-payment-date"
                mat-header-cell
                *matHeaderCellDef
                matTooltip="{{ 'Payment date' | translate }}"
                matTooltipPosition="above">
                <h5 style="font-size: 11px; padding: 0px 2px; font-weight: 500">
                  {{ 'Payment date' | translate }}
                </h5>
              </th>
              <td
                mat-cell
                *matCellDef="let element"
                class="pad-l-xs"
                style="text-align: center !important"
                data-cy="table-col-payment-date">
                <span
                  *ngIf="
                    !element?.payment_date ||
                    element?.nature === 'cancel' ||
                    element?.status_line_dp_term === 'cancelled' ||
                    element?.operation_name === 'chargeback_of_term' ||
                    element?.operation_name === 'chargeback_of_dp' ||
                    element?.nature === 'billing' || element?.flux === 'OD'
                  "
                  >-</span
                >
                <span
                  *ngIf="
                    element?.payment_date &&
                    element?.nature !== 'cancel' &&
                    element?.status_line_dp_term !== 'cancelled' &&
                    element?.operation_name !== 'chargeback_of_term' &&
                    element?.operation_name !== 'chargeback_of_dp' &&
                    element?.nature !== 'billing' &&
                    element?.nature !== 'Avoir' &&
                    element?.nature !== 'avoir' && element?.flux !== 'OD'
                  "
                  matTooltip="{{ translateDate(element?.payment_date, element?.payment_time) }}">{{
                  translateDate(element?.payment_date, element?.payment_time) }}</span>
              </td>
            </ng-container>

            <ng-container matColumnDef="accounting-document">
              <th
                data-cy="table-col-accounting-document"
                mat-header-cell
                *matHeaderCellDef
                matTooltip="{{ 'student_balance.Accounting document' | translate }}"
                matTooltipPosition="above">
                <h5 style="font-size: 11px; padding: 0px 2px; font-weight: 500">
                  {{ 'student_balance.Accounting document' | translate }}
                </h5>
              </th>
              <td data-cy="table-col-accounting-document" mat-cell *matCellDef="let element" class="pad-l-xs">
                <div
                  *ngIf="element?.nature === 'cancel' || element?.status_line_dp_term === 'cancelled'"
                  style="text-align: center !important"
                >
                  -
                </div>
                <div
                  *ngIf="element?.accounting_document && element?.balance_date && element?.nature !== 'cancel' && element?.status_line_dp_term !== 'cancelled'"
                  style="text-align: left !important"
                  matTooltip="{{ element?.accounting_document }}"
                >
                  {{ element?.accounting_document }}
                </div>
              </td>
            </ng-container>

            <ng-container matColumnDef="balance-date">
              <th
                data-cy="table-col-balance-date"
                mat-header-cell
                *matHeaderCellDef
                matTooltip="{{ 'Balance date' | translate }}"
                matTooltipPosition="above">
                <h5 style="font-size: 11px; padding: 0px 2px; font-weight: 500">
                  {{ 'Balance date' | translate }}
                </h5>
              </th>
              <td
                data-cy="table-col-balance-date"
                mat-cell
                *matCellDef="let element"
                class="pad-l-xs"
                style="text-align: center !important"
              >
                <!-- date display when not OD and balance date not-->
                <span *ngIf="element?.nature === 'cancel' || element?.status_line_dp_term === 'cancelled'">-</span>
                <span *ngIf="
                  element?.flux === 'OD' ||
                  ( !element?.balance_date &&
                  element?.nature !== 'cancel' &&
                  element?.status_line_dp_term !== 'cancelled')">
                  <mat-icon aria-hidden="true" class="mat-icon-status red">lens</mat-icon>
                </span>
                <span
                  *ngIf="
                    element?.balance_date
                    && element?.nature !== 'cancel'
                    && element?.flux !== 'OD'
                    && element?.status_line_dp_term !== 'cancelled'

                    "
                  matTooltip="{{ translateDate(element?.balance_date, element?.balance_time) }}"
                  >{{ translateDate(element?.balance_date, element?.balance_time) }}</span
                >
              </td>
            </ng-container>

            <ng-container matColumnDef="legal-entity">
              <th
                data-cy="table-col-legal-entity"
                mat-header-cell
                *matHeaderCellDef
                matTooltip="{{ 'Legal Entity' | translate }}"
                matTooltipPosition="above"
              >
                <h5 style="font-size: 11px; padding: 0px 2px; font-weight: 500">{{ 'Legal Entity' | translate }}</h5>
              </th>
              <td
                data-cy="table-col-legal-entity"
                mat-cell
                *matCellDef="let element"
                class="pad-l-xs"
                style="text-align: center !important"
              >
                {{ element?.legal_entity_id?.legal_entity_name }}
            </td>
            </ng-container>

            <ng-container matColumnDef="user">
              <th
                mat-header-cell
                *matHeaderCellDef
                matTooltip="{{ 'User' | translate }}"
                matTooltipPosition="above"
              >
                <h5 class="header-styling">
                  {{ 'User' | translate }}
                </h5>
              </th> 
              <td
                data-cy="table-col-payer" 
                mat-cell *matCellDef="let element" 
                class="pad-l-xs"
                style="text-align: left !important"
              >
              <span
                matTooltipPosition="above"
                matTooltip="{{ element?.updated_by?.last_name | uppercase }} {{ element?.updated_by?.first_name }} {{
                  element?.updated_by?.civility && element?.updated_by?.civility === 'neutral' ? '' : (element?.updated_by?.civility | translate)
                }}"
                >{{ element?.updated_by?.last_name | uppercase }} {{ element?.updated_by?.first_name }}
                {{
                  element?.updated_by?.civility && element?.updated_by?.civility === 'neutral' ? '' : (element?.updated_by?.civility | translate)
                }}
              </span>
              </td> 
            </ng-container>

            <ng-container matColumnDef="action" stickyEnd>
              <th
                data-cy="table-col-action"
                mat-header-cell
                *matHeaderCellDef
                matTooltip="{{ 'Action' | translate }}"
                matTooltipPosition="above"
                style="border-left: 1px solid #545454">
                <h5 style="font-size: 11px; padding: 0px 2px; font-weight: 500">
                  {{ 'Action' | translate }}
                </h5>
              </th>
              <td data-cy="table-col-action" mat-cell *matCellDef="let element" class="pad-l-xs"
                style="border-left: 1px solid #545454">
                <!-- eye icon button old implementation -->
                <!-- <button
                  mat-icon-button
                  *ngIf="
                    (!element?.term_status && element?.payment_date && element?.billing_id?.deposit_status === 'paid') ||
                    ((element?.term_status === 'paid' ||
                      element?.term_status === 'not_authorized' ||
                      element?.term_status === 'chargeback') &&
                      (element?.nature === 'sepa' || element?.nature === 'credit_card') &&
                      !element?.is_cancelled &&
                      element?.operation_name !== 'chargeback_of_term' &&
                      element?.transaction_id &&
                      element?.nature !== 'Avoir')
                  "
                  class="margin-right-button"
                  matTooltip="{{ 'View tansaction' | translate }}"
                  (click)="onOpenTransaction(element)"
                  data-cy="button-view-transaction"
                >
                  <mat-icon svgIcon="eye"></mat-icon>
                </button> -->

                <!-- eye icon button new implementation (down payment) -->
                <button
                  mat-icon-button
                  *ngIf="
                    (element?.status_line_dp_term === 'paid' || element?.status_line_dp_term === 'chargeback') &&
                    element?.operation_name === 'down_payment' &&
                    element?.payment_date &&
                    element?.billing_id?.deposit_status === 'paid' &&
                    (element?.nature === 'sepa' || element?.nature === 'credit_card') &&
                    element?.transaction_id
                  "
                  class="margin-right-button"
                  matTooltip="{{ 'View tansaction' | translate }}"
                  (click)="onOpenTransaction(element?.candidate_id?.candidate_unique_number)"
                  data-cy="button-view-transaction"
                >
                  <mat-icon svgIcon="eye"></mat-icon>
                </button>

                <!-- eye icon button new implementation (payment of term) -->
                <button
                  mat-icon-button
                  *ngIf="
                    (element?.status_line_dp_term === 'paid' ||
                      element?.status_line_dp_term === 'not_authorized' ||
                      element?.status_line_dp_term === 'chargeback') &&
                    (element?.nature === 'sepa' || element?.nature === 'credit_card') &&
                    element?.operation_name !== 'chargeback_of_term' &&
                    element?.transaction_id &&
                    element?.nature !== 'Avoir' &&
                    element?.nature !== 'avoir' &&
                    element?.operation_name !== 'down_payment'
                  "
                  class="margin-right-button"
                  matTooltip="{{ 'View tansaction' | translate }}"
                  (click)="onOpenTransaction(element?.candidate_id?.candidate_unique_number)"
                  data-cy="button-view-transaction"
                >
                  <mat-icon svgIcon="eye"></mat-icon>
                </button>

                <!-- pencil icon button old implementation -->
                <!-- <button
                  mat-icon-button
                  class="margin-right-button"
                  (click)="updateManualOperation(element)"
                  *ngIf="
                    element?.is_manual_action &&
                    checkManualEditAvoid(element?.operation_name) &&
                    element?.export_status === 'not_exported' &&
                    !element?.is_cancelled &&
                    element?.nature !== 'Avoir' &&
                    element?.term_status !== 'paid'
                  "
                  matTooltip="{{ 'Edit' | translate }}"
                  data-cy="button-edit"
                >
                  <mat-icon svgIcon="pencil"></mat-icon>
                </button> -->

                <!-- pencil icon button new implementation (billing (manual action)) -->
                <button
                  mat-icon-button
                  class="margin-right-button"
                  (click)="updateManualOperation(element)"
                  *ngIf="
                    element?.is_manual_action &&
                    checkManualEditAvoid(element?.operation_name) &&
                    element?.export_status === 'not_exported' &&
                    element?.flux === 'billing' &&
                    element?.status_line_dp_term !== 'cancelled' &&
                    element?.status_line_dp_term !== 'paid' &&
                    element?.status_line_dp_term !== 'pending' &&
                    element?.status_line_dp_term !== 'chargeback' &&
                    element?.nature !== 'Avoir' &&
                    element?.nature !== 'avoir'
                  "
                  matTooltip="{{ 'Edit' | translate }}"
                  data-cy="button-edit">
                  <mat-icon svgIcon="pencil"></mat-icon>
                </button>

                <!-- pencil icon button new implementation (payment line (manual action)) -->
                <button
                  mat-icon-button
                  class="margin-right-button"
                  (click)="updateManualOperation(element)"
                  *ngIf="
                    element?.is_manual_action &&
                    checkManualEditAvoid(element?.operation_name) &&
                    element?.export_status === 'not_exported' &&
                    element?.flux === 'payment' &&
                    element?.status_line_dp_term !== 'cancelled' &&
                    element?.status_line_dp_term !== 'paid' &&
                    element?.status_line_dp_term !== 'pending' &&
                    element?.status_line_dp_term !== 'chargeback' &&
                    element?.nature !== 'Avoir' &&
                    element?.nature !== 'avoir'
                  "
                  matTooltip="{{ 'Edit' | translate }}"
                  data-cy="button-edit">
                  <mat-icon svgIcon="pencil"></mat-icon>
                </button>

                <!-- pencil icon button new implementation (refund (manual action)) -->
                <button
                  mat-icon-button
                  class="margin-right-button"
                  (click)="updateManualOperation(element)"
                  *ngIf="
                    element?.is_manual_action &&
                    element?.operation_name === 'refund' &&
                    checkManualEditAvoid(element?.operation_name) &&
                    element?.export_status === 'not_exported' &&
                    (element?.nature !== 'Avoir' && element?.nature !== 'avoir')
                  "
                  matTooltip="{{ 'Edit' | translate }}"
                  data-cy="button-edit">
                  <mat-icon svgIcon="pencil"></mat-icon>
                </button>

                <!-- pencil icon button new implementation (OD (manual action)) -->
                <button
                  mat-icon-button
                  class="margin-right-button"
                  (click)="updateManualOperation(element)"
                  *ngIf="
                    element?.is_manual_action &&
                    (element?.operation_name === 'cash_transfer' || element?.operation_name === 'student_balance_adjustment') &&
                    checkManualEditAvoid(element?.operation_name) &&
                    element?.export_status === 'not_exported' &&
                    element?.flux === 'OD' &&
                    element?.status_line_dp_term !== 'cancelled' &&
                    element?.status_line_dp_term !== 'paid' &&
                    element?.status_line_dp_term !== 'pending' &&
                    element?.status_line_dp_term !== 'chargeback' &&
                    element?.nature !== 'Avoir' &&
                    element?.nature !== 'avoir'
                  "
                  matTooltip="{{ 'Edit' | translate }}"
                  data-cy="button-edit">
                  <mat-icon svgIcon="pencil"></mat-icon>
                </button>

                <!-- <button
                  mat-icon-button
                  class="margin-right-button"
                  (click)="deleteManualOperation(element)"
                  *ngIf="
                    element?.term_status !== 'paid' &&
                    (element?.is_manual_action || element?.nature === 'transfer') &&
                    element?.export_status === 'not_exported' &&
                    !element?.is_cancelled &&
                    element?.nature !== 'Avoir'
                  "
                  matTooltip="{{ 'Remove' | translate }}"
                  data-cy="button-remove"
                >
                  <mat-icon svgIcon="trash-can"></mat-icon>
                </button>  -->

                <!-- Start: Button Trash validation for Operation Name Billing (manual action) -->
                <button
                  mat-icon-button
                  *ngIf="
                    element?.status_line_dp_term !== 'paid' &&
                    element?.is_manual_action &&
                    element?.export_status === 'not_exported' &&
                    element?.flux === 'billing' &&
                    element?.status_line_dp_term !== 'cancelled' &&
                    element?.nature !== 'Avoir' &&
                    element?.nature !== 'avoir' &&
                    element?.nature !== 'discount'
                  "
                  class="margin-right-button"
                  (click)="deleteManualOperation(element)"
                  matTooltip="{{ 'Remove' | translate }}"
                  data-cy="button-remove">
                  <mat-icon svgIcon="trash-can"></mat-icon>
                </button>
                <!-- End: Button Trash  validation for Operation Name Billing (manual action)-->

                <!-- Start: Button Trash validation for Operation Name Payment_line (manual action) -->
                <button
                  mat-icon-button
                  *ngIf="
                    (element?.status_line_dp_term === 'billed' || element?.term_status === 'billed') &&
                    element?.is_manual_action &&
                    element?.export_status === 'not_exported' &&
                    element?.flux === 'payment'
                  "
                  class="margin-right-button"
                  (click)="deleteManualOperation(element)"
                  matTooltip="{{ 'Remove' | translate }}"
                  data-cy="button-remove">
                  <mat-icon svgIcon="trash-can"></mat-icon>
                </button>
                <!-- End: Button Trash validation for Operation Name Payment_line (manual action) -->

                <!-- Start: Button Trash validation for Operation Name Avoir/discount (manual_action) -->
                <button
                  mat-icon-button
                  *ngIf="
                    (element?.status_line_dp_term !== 'paid' &&
                      element?.is_manual_action &&
                      element?.export_status === 'not_exported' &&
                      (element?.nature === 'Avoir' || element?.nature === 'avoir' ||
                    element?.nature === 'discount'))
                  "
                  class="margin-right-button"
                  (click)="deleteManualOperation(element)"
                  matTooltip="{{ 'Remove' | translate }}"
                  data-cy="button-remove">
                  <mat-icon svgIcon="trash-can"></mat-icon>
                </button>
                <!-- End: Button Trash validation for Operation Name Avoir/discount (manual_action) -->

                <!-- Start: Button Trash validation for Operation Name Refund (manual action) -->
                <button
                  mat-icon-button
                  *ngIf="
                    element?.is_manual_action &&
                    element?.export_status === 'not_exported' &&
                    element?.operation_name === 'refund' &&
                    (element?.flux === 'transfer' || element?.flux === 'payment')
                  "
                  class="margin-right-button"
                  (click)="deleteManualOperation(element)"
                  matTooltip="{{ 'Remove' | translate }}"
                  data-cy="button-remove">
                  <mat-icon svgIcon="trash-can"></mat-icon>
                </button>
                <!-- End: Button Trash validation for Operation Name Refund (manual action) -->

                <!-- Start: Button Trash validation for Operation Name OD (manual action) -->
                <button
                  mat-icon-button
                  *ngIf="
                    element?.status_line_dp_term !== 'paid' &&
                    element?.is_manual_action &&
                    element?.export_status === 'not_exported' &&
                    (element?.operation_name === 'cash_transfer' ||
                      (element?.operation_name === 'student_balance_adjustment' && element?.flux === 'OD'))
                  "
                  class="margin-right-button"
                  (click)="deleteManualOperation(element)"
                  matTooltip="{{ 'Remove' | translate }}"
                  data-cy="button-remove">
                  <mat-icon svgIcon="trash-can"></mat-icon>
                </button>
                <!-- End: Button Trash validation for Operation Name OD (manual action) -->
                <!-- <button
                  mat-icon-button
                  *ngIf="
                    ((!element?.term_status && element?.payment_date && element?.billing_id?.deposit_status === 'paid') ||
                      element?.term_status === 'paid' ||
                      element?.term_status === 'not_authorized' ||
                      element?.term_status === 'not_authorised' ||
                      element?.is_chargeback ||
                      element?.flux === 'OD') &&
                    !element?.is_cancelled &&
                    element?.operation_name !== 'billing_of_term' &&
                    element?.nature !== 'Avoir'
                  "
                  class="margin-right-button"
                  matTooltip="{{ 'Operation details' | translate }}"
                  (click)="openOperationNoteDialog(element)"
                  data-cy="button-operation-details"
                >
                  <mat-icon svgIcon="note-outline"></mat-icon>
                </button> -->
                <!--action when term status is paid  -->

                <!--Start:Button Note validation for Operation Name Down payment -->
                <button
                  mat-icon-button
                  *ngIf="
                    element?.payment_date &&
                    element?.status_line_dp_term === 'paid' &&
                    element?.operation_name === 'down_payment'
                  "
                  class="margin-right-button"
                  matTooltip="{{ 'Operation details' | translate }}"
                  (click)="openOperationNoteDialog(element)"
                  data-cy="button-operation-details">
                  <mat-icon svgIcon="note-outline"></mat-icon>
                </button>
                <!-- End:Button Note validation for Operation Name Down payment-->

                <!-- Start:Button Note validation for Operation Name OD (manual_action) -->
                <button
                  mat-icon-button
                  *ngIf="
                    (element?.flux === 'OD' &&
                      element?.status_line_dp_term !== 'cancelled' &&
                      element?.operation_name !== 'billing_of_term' &&
                      element?.nature !== 'Avoir' &&
                      element?.nature !== 'avoir' &&
                      element?.operation_name === 'cash_transfer') ||
                    element?.operation_name === 'student_balance_adjustment'
                  "
                  class="margin-right-button"
                  matTooltip="{{ 'Operation details' | translate }}"
                  (click)="openOperationNoteDialog(element)"
                  data-cy="button-operation-details">
                  <mat-icon svgIcon="note-outline"></mat-icon>
                </button>
                <!-- End:Button Note validation for Operation Name OD (manual_action) -->

                <!-- Start:Button Note validation for Operation Name Chargeback -->
                <button
                  mat-icon-button
                  *ngIf="
                    element?.status_line_dp_term === 'chargeback' &&
                    element?.status_line_dp_term !== 'cancelled' &&
                    element?.operation_name !== 'billing_of_term' &&
                    element?.nature !== 'Avoir' &&
                    element?.nature !== 'avoir'
                  "
                  class="margin-right-button"
                  matTooltip="{{ 'Operation details' | translate }}"
                  (click)="openOperationNoteDialog(element)"
                  data-cy="button-operation-details">
                  <mat-icon svgIcon="note-outline"></mat-icon>
                </button>
                <!-- End:Button Note validation for Operation Name Chargeback -->

                <!-- Start:Button Note validation for Operation Name Payment of term (automatic) -->
                <button
                  mat-icon-button
                  *ngIf="
                    (element?.status_line_dp_term === 'paid' || element?.status_line_dp_term === 'not_authorised') &&
                    element?.status_line_dp_term !== 'cancelled' &&
                    element?.operation_name !== 'billing_of_term' &&
                    element?.operation_name !== 'down_payment' &&
                    element?.operation_name !== 'refund' &&
                    element?.nature !== 'Avoir' &&
                    element?.nature !== 'avoir'
                  "
                  class="margin-right-button"
                  matTooltip="{{ 'Operation details' | translate }}"
                  (click)="openOperationNoteDialog(element)"
                  data-cy="button-operation-details">
                  <mat-icon svgIcon="note-outline"></mat-icon>
                </button>
                <!-- End:Button Note validation for Operation Name Payment of term (automatic) -->
                <!-- <button
                  mat-icon-button
                  class="margin-right-button"
                  (click)="deleteManualOperation(element)"
                  *ngIf="
                    element?.term_status === 'paid' &&
                    !element?.is_cancelled &&
                    element?.export_status === 'not_exported' &&
                    !element?.transaction_id &&
                    (element?.nature === 'transfer' || element?.nature === '') &&
                    element?.operation_name !== 'billing_of_term' &&
                    element?.nature !== 'Avoir'
                  "
                  matTooltip="{{ 'Remove' | translate }}"
                  data-cy="button-remove"
                >
                  <mat-icon svgIcon="cash-remove"></mat-icon>
                </button> -->

                <!-- Start:Button Cash Remove validation for Operation Name Payment of term (automatic)  -->
                <button
                  mat-icon-button
                  *ngIf="
                    element?.status_line_dp_term === 'paid' &&
                    element?.export_status === 'not_exported' &&
                    element?.operation_name !== 'overpaid' &&
                    element?.operation_name !== 'down_payment' &&
                    !element?.transaction_id &&
                    element?.flux !== 'billing' &&
                    !element?.is_manual_action &&
                    element?.nature !== 'Avoir' &&
                    element?.nature !== 'avoir'
                  "
                  class="margin-right-button"
                  matTooltip="{{ 'Remove' | translate }}"
                  (click)="deleteManualOperation(element)"
                  data-cy="button-operation-details">
                  <mat-icon svgIcon="cash-remove"></mat-icon>
                </button>
                <!-- End:Button Cash Remove validation for Operation Name Payment of term (automatic) -->
                <button
                  mat-icon-button
                  *ngIf="
                    element?.status_line_dp_term === 'paid' &&
                    element?.export_status === 'not_exported' &&
                    element?.operation_name !== 'overpaid' &&
                    !element?.transaction_id &&
                    element?.flux !== 'billing' &&
                    element?.is_manual_action &&
                    checkManualPayment(element)
                  "
                  class="margin-right-button"
                  matTooltip="{{ 'removePayment' | translate }}"
                  (click)="removePayment(element)"
                >
                  <mat-icon svgIcon="cash-remove"></mat-icon>
                </button>

                <!-- *************** Action Button for Remove Payment when there is overpaid and source from manual payment -->
                <button
                mat-icon-button
                *ngIf="
                  element?.status_line_dp_term === 'paid' &&
                  element?.export_status === 'not_exported' &&
                  !element?.transaction_id &&
                  element?.operation_name === 'overpaid' &&
                  (element?.transaction_type === 'manual_payment' ||
                  element?.transaction_type === 'overpaid')
                "
                class="margin-right-button"
                matTooltip="{{ 'removePayment' | translate }}"
                (click)="removeOverpaid(element)"
              >
                <mat-icon svgIcon="cash-remove"></mat-icon>
              </button>
              </td>
            </ng-container>

            <ng-container matColumnDef="loading">
              <th data-cy="spinner-table" mat-header-cell *matHeaderCellDef colspan="100%"
                style="text-align: center !important">
                <div class="center-spinner">
                  <mat-spinner color="accent"></mat-spinner>
                </div>
              </th>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="balanceCols; sticky: true"></tr>
            <tr mat-header-row *matHeaderRowDef="totalCols; sticky: true"></tr>
            <tr mat-header-row *matHeaderRowDef="studentBalanceDisplayedColumn; sticky: true"></tr>
            <tr mat-header-row *matHeaderRowDef="['loading']" [hidden]="!isLoading"></tr>
            <tr mat-row *matRowDef="let row; columns: studentBalanceDisplayedColumn" [hidden]="isLoading"></tr>
          </table>
        </div>
        <div data-cy="no-data-found" *ngIf="noData | async" class="no-records" [ngClass]="{ hide: isLoading }">
          {{ 'NOT RECORD FOUND' | translate }}
        </div>
      </mat-expansion-panel>
    </mat-accordion>
  </div>
</div>