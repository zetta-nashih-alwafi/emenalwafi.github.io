"use strict";(self.webpackChunkGene=self.webpackChunkGene||[]).push([[3539],{75223:(N,x,_)=>{_.d(x,{r:()=>o});var t=_(94650),y=_(89383),d=_(36895),S=_(97392);function a(e,l){1&e&&(t.\u0275\u0275elementStart(0,"span",12),t.\u0275\u0275text(1," , "),t.\u0275\u0275elementEnd())}function n(e,l){if(1&e&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275template(3,a,2,0,"span",11),t.\u0275\u0275elementContainerEnd()),2&e){const i=l.$implicit,c=l.last;t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(2,2,i)," "),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",!c)}}function p(e,l){if(1&e){const i=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"mat-icon",13),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(i);const u=t.\u0275\u0275nextContext(3),h=u.$implicit,g=u.index,C=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(C.removeFilter(h,g))}),t.\u0275\u0275text(1,"close"),t.\u0275\u0275elementEnd()}}function s(e,l){if(1&e&&(t.\u0275\u0275elementStart(0,"span",9),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275template(3,n,4,4,"ng-container",7),t.\u0275\u0275template(4,p,2,0,"mat-icon",10),t.\u0275\u0275elementEnd()),2&e){const i=t.\u0275\u0275nextContext(2).$implicit,c=t.\u0275\u0275nextContext(3);t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1("",t.\u0275\u0275pipeBind1(2,3,null==i?null:i.column)," : "),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngForOf",null==i?null:i.key),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",!(c.isReadmission&&"scholar_season"===(null==i?null:i.name)))}}function r(e,l){if(1&e){const i=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"mat-icon",13),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(i);const u=t.\u0275\u0275nextContext(3),h=u.$implicit,g=u.index,C=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(C.removeFilter(h,g))}),t.\u0275\u0275text(1,"close"),t.\u0275\u0275elementEnd()}}function m(e,l){if(1&e&&(t.\u0275\u0275elementStart(0,"span",9),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275pipe(3,"translate"),t.\u0275\u0275template(4,r,2,0,"mat-icon",10),t.\u0275\u0275elementEnd()),2&e){const i=t.\u0275\u0275nextContext(2).$implicit,c=t.\u0275\u0275nextContext(3);t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate2("",t.\u0275\u0275pipeBind1(2,3,null==i?null:i.column)," : ",t.\u0275\u0275pipeBind1(3,5,null==i?null:i.key)," "),t.\u0275\u0275advance(3),t.\u0275\u0275property("ngIf",!(c.isReadmission&&"scholar_season"===(null==i?null:i.name)))}}function E(e,l){if(1&e&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275template(1,s,5,5,"span",8),t.\u0275\u0275template(2,m,5,7,"span",8),t.\u0275\u0275elementContainerEnd()),2&e){const i=t.\u0275\u0275nextContext().$implicit;t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",null==i?null:i.isMultiple),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",!(null!=i&&i.isMultiple))}}function O(e,l){if(1&e&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275template(1,E,3,2,"ng-container",1),t.\u0275\u0275elementContainerEnd()),2&e){const i=l.$implicit;t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf","super_filter"===(null==i?null:i.type))}}function T(e,l){if(1&e&&(t.\u0275\u0275elementStart(0,"div",4)(1,"span",5),t.\u0275\u0275text(2),t.\u0275\u0275pipe(3,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(4,"span"),t.\u0275\u0275text(5,":"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(6,"span",6),t.\u0275\u0275template(7,O,2,1,"ng-container",7),t.\u0275\u0275elementEnd()()),2&e){const i=t.\u0275\u0275nextContext(2);t.\u0275\u0275advance(1),t.\u0275\u0275property("ngClass","en"===i.translate.currentLang?"filter-type":"filter-type-fr"),t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1("",t.\u0275\u0275pipeBind1(3,3,"Super Filter")," "),t.\u0275\u0275advance(5),t.\u0275\u0275property("ngForOf",i.filterBreadcrumbData)}}function b(e,l){1&e&&(t.\u0275\u0275elementStart(0,"span",12),t.\u0275\u0275text(1," , "),t.\u0275\u0275elementEnd())}function P(e,l){if(1&e&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275template(3,b,2,0,"span",11),t.\u0275\u0275elementContainerEnd()),2&e){const i=l.$implicit,c=l.last,u=t.\u0275\u0275nextContext(3).$implicit;t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1(" ",null!=u&&u.noTranslate?i:t.\u0275\u0275pipeBind1(2,2,i)," "),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",!c)}}function B(e,l){if(1&e){const i=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"span",9),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275pipe(3,"translate"),t.\u0275\u0275template(4,P,4,4,"ng-container",7),t.\u0275\u0275elementStart(5,"mat-icon",13),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(i);const u=t.\u0275\u0275nextContext(2),h=u.$implicit,g=u.index,C=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(C.removeFilter(h,g))}),t.\u0275\u0275text(6,"close"),t.\u0275\u0275elementEnd()()}if(2&e){const i=t.\u0275\u0275nextContext(2).$implicit;t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1("",null!=i&&i.stepColumnName?t.\u0275\u0275pipeBind1(2,2,null==i?null:i.stepColumnName)+" "+(null==i?null:i.column):t.\u0275\u0275pipeBind1(3,4,null==i?null:i.column)," : "),t.\u0275\u0275advance(3),t.\u0275\u0275property("ngForOf",null==i?null:i.key)}}function R(e,l){if(1&e){const i=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"span",9),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275pipe(3,"translate"),t.\u0275\u0275pipe(4,"translate"),t.\u0275\u0275elementStart(5,"mat-icon",13),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(i);const u=t.\u0275\u0275nextContext(2),h=u.$implicit,g=u.index,C=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(C.removeFilter(h,g))}),t.\u0275\u0275text(6,"close"),t.\u0275\u0275elementEnd()()}if(2&e){const i=t.\u0275\u0275nextContext(2).$implicit;t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate2("",null!=i&&i.stepColumnName?t.\u0275\u0275pipeBind1(2,2,null==i?null:i.stepColumnName)+" "+(null==i?null:i.column):t.\u0275\u0275pipeBind1(3,4,null==i?null:i.column)," : ",!0===(null==i?null:i.noTranslate)?null==i?null:i.key:t.\u0275\u0275pipeBind1(4,6,null==i?null:i.key)," ")}}function I(e,l){if(1&e&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275template(1,B,7,6,"span",8),t.\u0275\u0275template(2,R,7,8,"span",8),t.\u0275\u0275elementContainerEnd()),2&e){const i=t.\u0275\u0275nextContext().$implicit;t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",null==i?null:i.isMultiple),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",!(null!=i&&i.isMultiple))}}function M(e,l){if(1&e&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275template(1,I,3,2,"ng-container",1),t.\u0275\u0275elementContainerEnd()),2&e){const i=l.$implicit;t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf","table_filter"===(null==i?null:i.type))}}function w(e,l){if(1&e&&(t.\u0275\u0275elementStart(0,"div",14)(1,"span",5),t.\u0275\u0275text(2),t.\u0275\u0275pipe(3,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(4,"span"),t.\u0275\u0275text(5,":"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(6,"span",6),t.\u0275\u0275template(7,M,2,1,"ng-container",7),t.\u0275\u0275elementEnd()()),2&e){const i=t.\u0275\u0275nextContext(2);t.\u0275\u0275advance(1),t.\u0275\u0275property("ngClass","en"===i.translate.currentLang?"filter-type":"filter-type-fr"),t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1("",t.\u0275\u0275pipeBind1(3,3,"Table Filter")," "),t.\u0275\u0275advance(5),t.\u0275\u0275property("ngForOf",i.filterBreadcrumbData)}}function F(e,l){if(1&e){const i=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275elementStart(1,"span",9),t.\u0275\u0275text(2),t.\u0275\u0275pipe(3,"translate"),t.\u0275\u0275elementStart(4,"mat-icon",13),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(i);const u=t.\u0275\u0275nextContext(),h=u.$implicit,g=u.index,C=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(C.removeFilter(h,g))}),t.\u0275\u0275text(5,"close"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementContainerEnd()}if(2&e){const i=t.\u0275\u0275nextContext().$implicit;t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate1("",t.\u0275\u0275pipeBind1(3,1,null==i?null:i.key)," ")}}function D(e,l){if(1&e&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275template(1,F,6,3,"ng-container",1),t.\u0275\u0275elementContainerEnd()),2&e){const i=l.$implicit;t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf","action_filter"===(null==i?null:i.type))}}function f(e,l){if(1&e&&(t.\u0275\u0275elementStart(0,"div",14)(1,"span",5),t.\u0275\u0275text(2),t.\u0275\u0275pipe(3,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(4,"span"),t.\u0275\u0275text(5,":"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(6,"span",6),t.\u0275\u0275template(7,D,2,1,"ng-container",7),t.\u0275\u0275elementEnd()()),2&e){const i=t.\u0275\u0275nextContext(2);t.\u0275\u0275advance(1),t.\u0275\u0275property("ngClass","en"===i.translate.currentLang?"filter-type":"filter-type-fr"),t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1("",t.\u0275\u0275pipeBind1(3,3,"Action Filter")," "),t.\u0275\u0275advance(5),t.\u0275\u0275property("ngForOf",i.filterBreadcrumbData)}}function v(e,l){if(1&e&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275template(1,T,8,5,"div",2),t.\u0275\u0275template(2,w,8,5,"div",3),t.\u0275\u0275template(3,f,8,5,"div",3),t.\u0275\u0275elementContainerEnd()),2&e){const i=t.\u0275\u0275nextContext();t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",i.filterDataExist("super_filter")),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",i.filterDataExist("table_filter")),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",i.filterDataExist("action_filter"))}}let o=(()=>{class e{constructor(i){this.translate=i,this.removeFilterTrigger=new t.EventEmitter}ngOnInit(){}filterDataExist(i){return!!this.filterBreadcrumbData.find(u=>u?.type===i)}removeFilter(i,c){this.filterBreadcrumbData.splice(c,1),this.removeFilterTrigger.emit(i)}}return e.\u0275fac=function(i){return new(i||e)(t.\u0275\u0275directiveInject(y.sK))},e.\u0275cmp=t.\u0275\u0275defineComponent({type:e,selectors:[["ms-filter-breadcrumb"]],inputs:{filterBreadcrumbData:"filterBreadcrumbData",isReadmission:"isReadmission"},outputs:{removeFilterTrigger:"removeFilterTrigger"},decls:2,vars:1,consts:[[1,"filter-breadcrumb"],[4,"ngIf"],["class","filter-breadcrumb-container mt-10",4,"ngIf"],["class","filter-breadcrumb-container",4,"ngIf"],[1,"filter-breadcrumb-container","mt-10"],[3,"ngClass"],[1,"breadcrumb-value"],[4,"ngFor","ngForOf"],["class","breadcrumb-filter",4,"ngIf"],[1,"breadcrumb-filter"],["class","icon-remove",3,"click",4,"ngIf"],["class","comma",4,"ngIf"],[1,"comma"],[1,"icon-remove",3,"click"],[1,"filter-breadcrumb-container"]],template:function(i,c){1&i&&(t.\u0275\u0275elementStart(0,"div",0),t.\u0275\u0275template(1,v,4,3,"ng-container",1),t.\u0275\u0275elementEnd()),2&i&&(t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",null==c.filterBreadcrumbData?null:c.filterBreadcrumbData.length))},dependencies:[d.mk,d.sg,d.O5,S.Hw,y.X$],styles:[".filter-breadcrumb[_ngcontent-%COMP%]{padding:1rem}.filter-breadcrumb-container[_ngcontent-%COMP%]{display:flex;align-items:baseline}.filter-breadcrumb-container[_ngcontent-%COMP%] ~ .filter-breadcrumb-container[_ngcontent-%COMP%]{margin-top:1rem}.breadcrumb-value[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;padding:0 1rem;gap:4px}.filter-type[_ngcontent-%COMP%]{width:100px}.filter-type-fr[_ngcontent-%COMP%]{width:150px}.breadcrumb-filter[_ngcontent-%COMP%]{background-color:#ffd740;color:#000;padding:.25rem .5rem;border-radius:.375rem;font-size:.75rem;display:flex;flex-wrap:wrap;align-items:center}.comma[_ngcontent-%COMP%]{margin-right:4px}.icon-remove[_ngcontent-%COMP%]{vertical-align:middle;margin-left:.25rem;font-size:inherit;cursor:pointer}"]}),e})()},22437:(N,x,_)=>{_.d(x,{q:()=>y});var t=_(94650);let y=(()=>{class d{constructor(){this.filterSingle=(a,n,p,s,r="")=>null==n?"":r+a?.find(m=>m[p]===n)?.[s],this.filterSingleBoolean=(a,n,p,s,r="")=>null==n?"":r+a?.find(m=>"boolean"==typeof m[p]?JSON.stringify(m[p])===n:"string"==typeof m[p]?m[p]===n:void 0)?.[s],this.filterMultiple=(a,n,p,s,r="")=>n?.length?null===p&&null===s?a.filter(m=>n?.includes(m)).map(m=>r+m):a.filter(m=>n?.includes(m[p]))?.map(m=>r+m[s]):[],this.isValueObject=a=>"object"==typeof a&&!Array.isArray(a)&&null!==a,this.getNestedObjectValue=(a,n)=>{for(const p in a){if(p===n)return a[n];if(this.isValueObject(a[n]))return this.getNestedObjectValue(a[p],n)}},this.getKey=a=>{if(null===a?.filterValue)return null;const n=null===a?.name?a?.filterValue:"boolean"==typeof a?.filterValue?.[a?.name]?String(a?.filterValue?.[a.name]):a.filterValue?.[a.name],p=a.isMultiple,s=a.isSelectionInput,r=a?.fixedValues,m=a?.translationPrefix??"";if(null==n)return null;if(!s&&this.isValueObject(n)&&a?.nestedKey)return m+this.getNestedObjectValue(n,a.nestedKey);if(!s)return m+n;let E;if(r)if(Array.isArray(n))E=r?.filter(T=>n?.includes(T));else if("string"==typeof n||"boolean"==typeof n)return E=r?.find(T=>n===T),E;const O=p?this.filterMultiple(a.filterList,n,a.savedValue,a.displayKey,a.translationPrefix):"boolean"==typeof a?.filterValue?.[a?.name]||"false"===a?.filterValue?.[a?.name]||"true"===a?.filterValue?.[a?.name]?this.filterSingleBoolean(a.filterList,n,a.savedValue,a.displayKey,a.translationPrefix):this.filterSingle(a.filterList,n,a.savedValue,a.displayKey,a.translationPrefix);return p&&E?O.concat(...r):O}}filterBreadcrumb(a,n){const{type:p,column:s}=a,r=n.findIndex(m=>m?.type===p&&m?.column===s);-1!==r?(n[r]=a,!(Array.isArray(n[r]?.value)?n[r]?.value?.length:n[r]?.value)&&!(Array.isArray(n[r]?.key)?n[r]?.key?.length:n[r]?.key)&&n.splice(r,1)):(-1===r&&Array.isArray(a?.value)?a?.value?.length:a?.value)&&n.push(a)}removeFilterBreadcrumb(a,n,p,s,r=!1){"super_filter"===a.type&&n?n[a.name]=null:"table_filter"===a.type&&p?p[a.name]=null:"action_filter"===a.type&&s&&(s[a.name]=null),a?.filterRef?.patchValue(a?.resetValue??null,{emitEvent:r})}filterBreadcrumbFormat(a,n){const p=[...n];for(const s of a){const r=null===s.name?s?.filterValue:"boolean"==typeof s?.filterValue?.[s.name]?String(s?.filterValue?.[s.name]):s?.filterValue?.[s.name],m={type:s.type,name:s.name,column:s.column,filterList:s?.filterList,value:r||null,isMultiple:s.isMultiple,filterRef:s.filterRef,resetValue:s.resetValue,noTranslate:s?.noTranslate,stepColumnName:s?.stepColumnName,key:this.getKey(s)};this.filterBreadcrumb(m,p)}return p}}return d.\u0275fac=function(a){return new(a||d)},d.\u0275prov=t.\u0275\u0275defineInjectable({token:d,factory:d.\u0275fac,providedIn:"root"}),d})()},92741:(N,x,_)=>{_.d(x,{q:()=>D});var t=_(24006),y=_(65938),d=_(68745),S=_(35226),a=_.n(S),n=_(94650),p=_(84075),s=_(71122),r=_(89383),m=_(65884),E=_(52688),O=_(73555),T=_(4859),b=_(97392),P=_(51572),B=_(30277),R=_(24784),I=_(36895);const M=["importFile"];function w(f,v){1&f&&(n.\u0275\u0275elementStart(0,"div",20),n.\u0275\u0275element(1,"mat-progress-spinner",21),n.\u0275\u0275elementEnd())}const F=function(f){return{color:f}};let D=(()=>{class f{constructor(o,e,l,i,c,u,h,g){this.data=o,this.fb=e,this.dialogRef=l,this.utilService=i,this.contractService=c,this.translate=u,this.companyService=h,this.authService=g,this.isWaitingForResponse=!1,this.isFileUploaded=!0,this.subs=new d.Y}ngOnInit(){const o=this.authService.getLocalStorageUser(),e=this.authService.getPermission(),l=o?.entities?.find(i=>i?.type?.name===e[0]);this.currentUserTypeId=l?.type?._id,this.initForm()}initForm(){this.importForm=this.fb.group({file_delimeter:[this.data&&this.data.delimeter?this.data.delimeter:null,[t.Validators.required]]})}handleInputChange(o){this.isWaitingForResponse=!0;const i=this.utilService.getFileExtension(o.target.files[0].name).toLocaleLowerCase();["csv","tsv"].includes(i)?(this.file=o.target.files[0],this.isWaitingForResponse=!1,this.isFileUploaded=!0):(this.isFileUploaded=!1,this.file=null,this.isWaitingForResponse=!1,a().fire({type:"info",title:this.translate.instant("UPLOAD_ERROR.WRONG_TYPE_TITLE"),text:this.translate.instant("UPLOAD_ERROR.WRONG_TYPE_TEXT",{file_exts:".csv, .tsv"}),allowEscapeKey:!1,allowOutsideClick:!1,allowEnterKey:!1}))}submit(){this.importForm.invalid||!this.file?(a().fire({type:"info",title:this.translate.instant("Please fill all the required fields !"),html:this.translate.instant("To be able to submit the form please fill in all the required fields."),confirmButtonText:this.translate.instant("I understand"),allowEnterKey:!1,allowEscapeKey:!1,allowOutsideClick:!1}),this.isFileUploaded=!!this.file):a().fire({type:"warning",title:this.translate.instant("Import"),html:this.translate.instant("Are you sure to import this file?"),confirmButtonText:this.translate.instant("Yes, Im Sure"),cancelButtonText:this.translate.instant("No, Cancel It"),allowEnterKey:!1,allowEscapeKey:!1,allowOutsideClick:!1,showCancelButton:!0,confirmButtonClass:"btn-danger"}).then(o=>{o.value&&this.callImportAPI()})}callImportAPI(){this.isWaitingForResponse=!0,this.subs.sink=this.data&&"contract"===this.data.type?this.contractService.importContractProcess({file_delimeter:this.importForm.value.file_delimeter},this.translate.currentLang,this.file).subscribe(e=>{this.isWaitingForResponse=!1,e&&0===e.not_imported?a().fire({allowOutsideClick:!1,type:"success",title:this.translate.instant("ImportProcess_S2.TITLE"),html:this.translate.instant("ImportProcess_S2.TEXT"),confirmButtonText:this.translate.instant("ImportProcess_S2.BUTTON")}).then(()=>{this.dialogRef.close(this.importForm.value)}):a().fire({allowOutsideClick:!1,type:"warning",title:this.translate.instant("ImportProcess_S1.TITLE"),html:this.translate.instant("ImportProcess_S1.TEXT",{imported:e.imported,not_imported:e.not_imported}),confirmButtonText:this.translate.instant("ImportProcess_S1.BUTTON")}).then(()=>{this.dialogRef.close(this.importForm.value)})},e=>{this.authService.postErrorLog(e),this.isWaitingForResponse=!1,e&&e.message&&e.message.includes("Network error: Http failure response for")?a().fire({type:"warning",title:this.translate.instant("BAD_CONNECTION.Title"),html:this.translate.instant("BAD_CONNECTION.Text"),confirmButtonText:this.translate.instant("BAD_CONNECTION.Button"),allowOutsideClick:!1,allowEnterKey:!1,allowEscapeKey:!1}):this.swalError(e)}):this.data&&"module"===this.data.type?this.contractService.importModule(this.importForm.get("file_delimeter").value,this.file,this.translate.currentLang).subscribe(e=>{if(this.isWaitingForResponse=!1,e&&e.module_added&&e.module_added.length>0&&0===e.module_not_added.length){const l=e.module_added.filter(i=>"Success"===i.message);l&&l.length>0&&a().fire({type:"success",title:this.translate.instant("Bravo!"),confirmButtonText:this.translate.instant("OK"),allowEnterKey:!1,allowEscapeKey:!1,allowOutsideClick:!1}).then(()=>{this.dialogRef.close(this.importForm.value)})}else if(e&&e.module_not_added&&e.module_not_added.length>0){const l=[],i=[];e.module_not_added.filter(c=>{"Module name already exist"===c.message?l.push(c.name):"Required field is empty"===c.message&&i.push(c.name)}),l&&l.length>0?a().fire({type:"info",title:this.translate.instant("IMPORT_MS2.TITLE"),html:this.translate.instant("IMPORT_MS2.TEXT",{moduleName:l.join(", ")}),confirmButtonText:this.translate.instant("IMPORT_MS2.BUTTON"),allowEnterKey:!1,allowEscapeKey:!1,allowOutsideClick:!1}).then(()=>{this.dialogRef.close(this.importForm.value)}):i&&i.length>0&&a().fire({type:"info",title:this.translate.instant("IMPORT_MS3.TITLE"),html:this.translate.instant("IMPORT_MS3.TEXT"),confirmButtonText:this.translate.instant("IMPORT_MS3.BUTTON"),allowEnterKey:!1,allowEscapeKey:!1,allowOutsideClick:!1}).then(()=>{this.dialogRef.close(this.importForm.value)})}},e=>{this.authService.postErrorLog(e),this.isWaitingForResponse=!1,"GraphQL error: No module found."===e.message?a().fire({type:"info",title:this.translate.instant("IMPORT_MS1.TITLE"),text:this.translate.instant("IMPORT_MS1.TEXT"),confirmButtonText:this.translate.instant("IMPORT_MS1.BUTTON"),allowEnterKey:!1,allowEscapeKey:!1,allowOutsideClick:!1}):this.swalError(e)}):this.data&&"subject"===this.data.type?this.contractService.importSubject(this.importForm.get("file_delimeter").value,this.file,this.translate.currentLang).subscribe(e=>{if(this.isWaitingForResponse=!1,e&&e.course_subject_added&&e.course_subject_added.length>0&&0===e.course_subject_not_added.length){const l=e.course_subject_added.filter(i=>"Success"===i.message);l&&l.length>0&&a().fire({type:"success",title:this.translate.instant("Bravo!"),confirmButtonText:this.translate.instant("OK"),allowEnterKey:!1,allowEscapeKey:!1,allowOutsideClick:!1}).then(()=>{this.dialogRef.close(this.importForm.value)})}else if(e&&e.course_subject_not_added&&e.course_subject_not_added.length>0){const l=[],i=[];e.course_subject_not_added.filter(c=>{"Subject name already exist"===c.message?l.push(c.name):"Required field is empty"===c.message&&i.push(c.name)}),l&&l.length>0?a().fire({type:"info",title:this.translate.instant("IMPORT_SS2.TITLE"),html:this.translate.instant("IMPORT_SS2.TEXT",{subjectName:l.join(", ")}),confirmButtonText:this.translate.instant("IMPORT_SS2.BUTTON"),allowEnterKey:!1,allowEscapeKey:!1,allowOutsideClick:!1}).then(()=>{this.dialogRef.close(this.importForm.value)}):i&&i.length>0&&a().fire({type:"info",title:this.translate.instant("IMPORT_SS3.TITLE"),html:this.translate.instant("IMPORT_SS3.TEXT"),confirmButtonText:this.translate.instant("IMPORT_SS3.BUTTON"),allowEnterKey:!1,allowEscapeKey:!1,allowOutsideClick:!1}).then(()=>{this.dialogRef.close(this.importForm.value)})}},e=>{this.authService.postErrorLog(e),this.isWaitingForResponse=!1,"GraphQL error: No course subject found."===e.message?a().fire({type:"info",title:this.translate.instant("IMPORT_SS1.TITLE"),text:this.translate.instant("IMPORT_SS1.TEXT"),confirmButtonText:this.translate.instant("IMPORT_SS1.BUTTON"),allowEnterKey:!1,allowEscapeKey:!1,allowOutsideClick:!1}):this.swalError(e)}):this.data&&"companies"===this.data.type?this.companyService.ImportCompanyData(this.importForm.value,this.file,this.currentUserTypeId).subscribe(e=>{e&&(this.isWaitingForResponse=!1,a().fire({type:"success",title:this.translate.instant("IMPORT_COM_S1.TITLE"),html:this.translate.instant("IMPORT_COM_S1.TEXT"),confirmButtonText:this.translate.instant("IMPORT_COM_S1.BUTTON"),allowEnterKey:!1,allowEscapeKey:!1,allowOutsideClick:!1}).then(()=>{this.dialogRef.close(!0)}))},e=>{this.authService.postErrorLog(e),this.isWaitingForResponse=!1,e&&e.message&&e.message.includes("adding company is limited to 30 entity in 1 minute")?a().fire({type:"info",title:this.translate.instant("ComLim_s1.TITLE"),html:this.translate.instant("ComLim_s1.TEXT"),confirmButtonText:this.translate.instant("ComLim_s1.BUTTON"),allowOutsideClick:!1,allowEnterKey:!1,allowEscapeKey:!1}):e&&e.message&&(e.message.includes("the siret you entered is not found on the government api. please double check the siret and try again")||e.message.includes("the combination of siret/siren code and zipcode is not detected."))?a().fire({type:"info",title:this.translate.instant("COMP_S1.TITLE"),html:this.translate.instant("COMP_S1.TEXT"),confirmButtonText:this.translate.instant("COMP_S1.BUTTON"),allowOutsideClick:!1,allowEnterKey:!1,allowEscapeKey:!1}):e&&e.message&&e.message.includes("Sorry This Company is closed")?a().fire({type:"info",title:this.translate.instant("COMPANY_S20.TITLE"),html:this.translate.instant("COMPANY_S20.TEXT",{siret:""}),confirmButtonText:this.translate.instant("COMPANY_S20.BUTTON"),allowOutsideClick:!1,allowEnterKey:!1,allowEscapeKey:!1}):e&&e.message&&e.message.includes("Network error: Http failure response for")?a().fire({type:"info",title:this.translate.instant("BAD_CONNECTION.Title"),html:this.translate.instant("BAD_CONNECTION.Text"),confirmButtonText:this.translate.instant("BAD_CONNECTION.Button"),allowOutsideClick:!1,allowEnterKey:!1,allowEscapeKey:!1}):a().fire({type:"info",title:this.translate.instant("SORRY"),text:e&&e.message?this.translate.instant(e.message.replaceAll("GraphQL error: ","")):e,confirmButtonText:this.translate.instant("DISCONNECT_SCHOOL.BUTTON3")})}):this.data&&"country"===this.data?.type?this.companyService.importCountryAndNationality(this.importForm.value,this.file).subscribe(e=>{e&&(this.isWaitingForResponse=!1,a().fire({type:"success",title:this.translate.instant("Bravo!"),confirmButtonText:this.translate.instant("OK"),allowEnterKey:!1,allowEscapeKey:!1,allowOutsideClick:!1}).then(()=>{this.dialogRef.close(!0)}))},e=>{this.authService.postErrorLog(e),this.isWaitingForResponse=!1,a().fire({type:"info",title:this.translate.instant("SORRY"),text:e&&e.message?this.translate.instant(e.message.replaceAll("GraphQL error: ","")):e,confirmButtonText:this.translate.instant("DISCONNECT_SCHOOL.BUTTON3")})}):this.contractService.importAssignmentTableData(this.importForm.get("file_delimeter").value,this.file,this.translate.currentLang,this.currentUserTypeId).subscribe(e=>{this.isWaitingForResponse=!1,"import in progress"===e?a().fire({type:"success",title:this.translate.instant("ReAdmission_S10.TITLE"),text:this.translate.instant("ReAdmission_S10.TEXT"),confirmButtonText:this.translate.instant("ReAdmission_S10.BUTTON"),allowEnterKey:!1,allowEscapeKey:!1,allowOutsideClick:!1}).then(()=>{this.dialogRef.close(this.importForm.value)}):e&&!e.is_error?a().fire({type:"success",title:this.translate.instant("Bravo!"),confirmButtonText:this.translate.instant("OK"),allowEnterKey:!1,allowEscapeKey:!1,allowOutsideClick:!1}).then(()=>{this.dialogRef.close(this.importForm.value)}):e.message&&"delimeter from file and from input is different"===e.message?a().fire({type:"info",title:this.translate.instant("IMPORT_ASSIGN_S2.Title"),confirmButtonText:this.translate.instant("OK"),allowEnterKey:!1,allowEscapeKey:!1,allowOutsideClick:!1}):e.message&&"Column CSV error."===e.message?a().fire({type:"info",html:this.translate.instant("IMPORT_ASSIGN_S4.Title"),confirmButtonText:this.translate.instant("OK"),allowEnterKey:!1,allowEscapeKey:!1,allowOutsideClick:!1}):e.message&&"some data is incorrect"===e.message?a().fire({type:"info",title:this.translate.instant("IMPORT_ASSIGN_S3.Title"),html:this.translate.instant("IMPORT_ASSIGN_S3.Text"),confirmButtonText:this.translate.instant("IMPORT_ASSIGN_S3.Button"),allowEnterKey:!1,allowEscapeKey:!1,allowOutsideClick:!1}):a().fire({type:"info",title:this.translate.instant("IMPORT_ASSIGN_S1.Title"),html:this.translate.instant("IMPORT_ASSIGN_S1.Text"),confirmButtonText:this.translate.instant("OK"),allowEnterKey:!1,allowEscapeKey:!1,allowOutsideClick:!1})},e=>{this.authService.postErrorLog(e),this.isWaitingForResponse=!1,e&&e.message&&e.message.includes("Network error: Http failure response for")?a().fire({type:"warning",title:this.translate.instant("BAD_CONNECTION.Title"),html:this.translate.instant("BAD_CONNECTION.Text"),confirmButtonText:this.translate.instant("BAD_CONNECTION.Button"),allowOutsideClick:!1,allowEnterKey:!1,allowEscapeKey:!1}):this.swalError(e)})}swalError(o){this.isWaitingForResponse=!1,"GraphQL error: Column CSV error."===o.message?a().fire({allowOutsideClick:!1,type:"info",title:this.translate.instant("RGO_S8.TITLE"),confirmButtonText:this.translate.instant("RGO_S8.BUTTON")}).then(e=>{this.closeDialog()}):"GraphQL error: schedule already published."===o.message?a().fire({allowOutsideClick:!1,type:"info",title:this.translate.instant("RGO_S8.TITLE"),html:this.translate.instant("RGO_S8.TEXT"),confirmButtonText:this.translate.instant("RGO_S8.BUTTON")}).then(e=>{this.closeDialog()}):"GraphQL error: delimeter from file and from input is different"===o.message?a().fire({allowOutsideClick:!1,type:"info",title:this.translate.instant("STUDENT_IMPORT.DELIMITER_UNSUCCESSFULL_IMPORT.TITLE"),confirmButtonText:this.translate.instant("STUDENT_IMPORT.DELIMITER_UNSUCCESSFULL_IMPORT.BUTTON")}).then(e=>{this.closeDialog()}):o&&o.message&&o.message.includes("Network error: Http failure response for")?a().fire({type:"warning",title:this.translate.instant("BAD_CONNECTION.Title"),html:this.translate.instant("BAD_CONNECTION.Text"),confirmButtonText:this.translate.instant("BAD_CONNECTION.Button"),allowOutsideClick:!1,allowEnterKey:!1,allowEscapeKey:!1}):a().fire({type:"info",title:this.translate.instant("SORRY"),text:o&&o.message?this.translate.instant(o.message.replaceAll("GraphQL error: ","")):o,confirmButtonText:"OK"}).then(e=>{this.closeDialog()})}openUploadWindow(){this.importFile.nativeElement.click()}closeDialog(){this.dialogRef.close()}ngOnDestroy(){this.subs.unsubscribe()}}return f.\u0275fac=function(o){return new(o||f)(n.\u0275\u0275directiveInject(y.WI),n.\u0275\u0275directiveInject(t.UntypedFormBuilder),n.\u0275\u0275directiveInject(y.so),n.\u0275\u0275directiveInject(p.t),n.\u0275\u0275directiveInject(s.I),n.\u0275\u0275directiveInject(r.sK),n.\u0275\u0275directiveInject(m.J),n.\u0275\u0275directiveInject(E.e))},f.\u0275cmp=n.\u0275\u0275defineComponent({type:f,selectors:[["ms-import-contract-process-dialog"]],viewQuery:function(o,e){if(1&o&&n.\u0275\u0275viewQuery(M,5),2&o){let l;n.\u0275\u0275queryRefresh(l=n.\u0275\u0275loadQuery())&&(e.importFile=l.first)}},decls:39,vars:22,consts:[["cdkDrag","","cdkDragRootElement",".cdk-overlay-pane","cdkDragHandle","",1,"header-div"],[1,"header-wrap"],["svgIcon","file-upload"],[1,"header-text"],["mat-icon-button","","type","button",1,"header-icon",3,"click"],[1,"pad-x-md","pad-t-md",3,"formGroup"],[1,"p-grid"],[1,"p-col-12",2,"float","left"],[1,"p-col-9",2,"padding","0.5em 0px","float","left"],[3,"ngStyle"],[1,"p-col-3",2,"padding","0px","float","left","text-align","right"],["type","file","accept",".csv, .tsv","disableMultipart","true",2,"display","none",3,"change"],["importFile",""],["mat-raised-button","","color","accent",1,"margin-right-0",3,"disabled","click"],[1,"mat-icon-default"],[1,"p-col-12",2,"padding","0.5em 0px","float","left"],["fxLayout","row","fxLayoutAlign","end center",1,"footer-form"],["mat-raised-button","","color","warn","type","button",3,"click"],["mat-raised-button","","color","primary","type","button",3,"click"],["class","loading-indicator",4,"ngIf"],[1,"loading-indicator"],["mode","indeterminate","color","accent"]],template:function(o,e){1&o&&(n.\u0275\u0275elementStart(0,"div",0)(1,"div",1),n.\u0275\u0275element(2,"mat-icon",2),n.\u0275\u0275elementStart(3,"h2",3),n.\u0275\u0275text(4),n.\u0275\u0275pipe(5,"translate"),n.\u0275\u0275elementEnd()(),n.\u0275\u0275elementStart(6,"button",4),n.\u0275\u0275listener("click",function(){return e.closeDialog()}),n.\u0275\u0275elementStart(7,"mat-icon"),n.\u0275\u0275text(8,"close"),n.\u0275\u0275elementEnd()()(),n.\u0275\u0275element(9,"hr"),n.\u0275\u0275elementStart(10,"div",5)(11,"div",6)(12,"div",7)(13,"div",6)(14,"div",8)(15,"label",9),n.\u0275\u0275text(16),n.\u0275\u0275pipe(17,"translate"),n.\u0275\u0275elementEnd()(),n.\u0275\u0275elementStart(18,"div",10)(19,"input",11,12),n.\u0275\u0275listener("change",function(i){return e.handleInputChange(i)}),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(21,"button",13),n.\u0275\u0275listener("click",function(){return e.openUploadWindow()}),n.\u0275\u0275elementStart(22,"mat-icon",14),n.\u0275\u0275text(23,"add"),n.\u0275\u0275elementEnd(),n.\u0275\u0275text(24),n.\u0275\u0275pipe(25,"translate"),n.\u0275\u0275elementEnd()(),n.\u0275\u0275elementStart(26,"div",15)(27,"span"),n.\u0275\u0275text(28),n.\u0275\u0275elementEnd()()()()()(),n.\u0275\u0275elementStart(29,"div",16)(30,"div")(31,"button",17),n.\u0275\u0275listener("click",function(){return e.closeDialog()}),n.\u0275\u0275text(32),n.\u0275\u0275pipe(33,"translate"),n.\u0275\u0275elementEnd()(),n.\u0275\u0275elementStart(34,"div")(35,"button",18),n.\u0275\u0275listener("click",function(){return e.submit()}),n.\u0275\u0275text(36),n.\u0275\u0275pipe(37,"translate"),n.\u0275\u0275elementEnd()()(),n.\u0275\u0275template(38,w,2,0,"div",19)),2&o&&(n.\u0275\u0275advance(4),n.\u0275\u0275textInterpolate1(" ",n.\u0275\u0275pipeBind1(5,10,"IMPORT_TEMPLATE.IMPORT")," "),n.\u0275\u0275advance(6),n.\u0275\u0275property("formGroup",e.importForm),n.\u0275\u0275advance(5),n.\u0275\u0275property("ngStyle",n.\u0275\u0275pureFunction1(20,F,e.isFileUploaded?"":"red")),n.\u0275\u0275advance(1),n.\u0275\u0275textInterpolate1("",n.\u0275\u0275pipeBind1(17,12,"TRANSCRIPT_PROCESS.DATA_FILE"),"*"),n.\u0275\u0275advance(5),n.\u0275\u0275property("disabled",e.isWaitingForResponse),n.\u0275\u0275advance(3),n.\u0275\u0275textInterpolate1(" ",n.\u0275\u0275pipeBind1(25,14,"TRANSCRIPT_PROCESS.FILE")," "),n.\u0275\u0275advance(4),n.\u0275\u0275textInterpolate(null==e.file?null:e.file.name),n.\u0275\u0275advance(4),n.\u0275\u0275textInterpolate1(" ",n.\u0275\u0275pipeBind1(33,16,"Cancel")," "),n.\u0275\u0275advance(4),n.\u0275\u0275textInterpolate1(" ",n.\u0275\u0275pipeBind1(37,18,"Save")," "),n.\u0275\u0275advance(2),n.\u0275\u0275property("ngIf",e.isWaitingForResponse))},dependencies:[O.Zt,O.Bh,T.lW,b.Hw,P.Ou,t.NgControlStatusGroup,t.FormGroupDirective,B.xw,B.Wh,R.Zl,I.O5,I.PC,r.X$],styles:[".header-wrap[_ngcontent-%COMP%]{display:flex;align-items:center}.header-form[_ngcontent-%COMP%]{padding:18px}.footer-form[_ngcontent-%COMP%]{padding:0 18px 18px}.no-padding[_ngcontent-%COMP%]{padding:0}"]}),f})()}}]);