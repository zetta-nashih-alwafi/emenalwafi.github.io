"use strict";(self.webpackChunkGene=self.webpackChunkGene||[]).push([[1259],{81259:(U,C,o)=>{o.d(C,{O:()=>L});var r=o(24006),v=o(68745),g=o(17489),O=o(35226),c=o.n(O),p=o(65938),_=o(62395),t=o(94650),E=o(25046),u=o(89383),x=o(52688),P=o(96334),M=o(4859),b=o(97392),s=o(59549),I=o(284),h=o(71948),f=o(36895),m=o(88796);function y(a,l){1&a&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275elementStart(1,"mat-radio-button",31),t.\u0275\u0275text(2),t.\u0275\u0275pipe(3,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementContainerEnd()),2&a&&(t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(3,1,"Neutral")))}function D(a,l){1&a&&(t.\u0275\u0275elementStart(0,"mat-error"),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275elementEnd()),2&a&&(t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(2,1,"This field is required")))}function T(a,l){1&a&&(t.\u0275\u0275elementStart(0,"mat-error"),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275elementEnd()),2&a&&(t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(2,1,"This field is required")))}function S(a,l){1&a&&(t.\u0275\u0275elementStart(0,"mat-error"),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275elementEnd()),2&a&&(t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(2,1,"Email is not valid")))}function A(a,l){if(1&a&&(t.\u0275\u0275elementStart(0,"span",34),t.\u0275\u0275text(1),t.\u0275\u0275elementEnd()),2&a){const e=t.\u0275\u0275nextContext().item;t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1("+",null==e?null:e.dialCode,"")}}function z(a,l){if(1&a&&(t.\u0275\u0275element(0,"img",32),t.\u0275\u0275template(1,A,2,1,"span",33)),2&a){const e=l.item,n=t.\u0275\u0275nextContext();t.\u0275\u0275property("src",n.flagsIconPath+(null==e?null:e.flagIcon)+".svg",t.\u0275\u0275sanitizeUrl),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",null==e?null:e.flagIcon)}}function B(a,l){if(1&a&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275element(1,"img",36),t.\u0275\u0275text(2),t.\u0275\u0275pipe(3,"translate"),t.\u0275\u0275elementContainerEnd()),2&a){const e=t.\u0275\u0275nextContext().$implicit,n=t.\u0275\u0275nextContext();t.\u0275\u0275advance(1),t.\u0275\u0275property("src",n.flagsIconPath+(null==e?null:e.flagIcon)+".svg",t.\u0275\u0275sanitizeUrl),t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate2(" ",t.\u0275\u0275pipeBind1(3,3,null==e?null:e.name)," +",null==e?null:e.dialCode," ")}}function F(a,l){if(1&a&&(t.\u0275\u0275elementStart(0,"ng-option",35),t.\u0275\u0275template(1,B,4,5,"ng-container",14),t.\u0275\u0275elementEnd()),2&a){const e=l.$implicit;t.\u0275\u0275property("value",e),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",null==e?null:e.name)}}function R(a,l){1&a&&(t.\u0275\u0275elementStart(0,"mat-error"),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275elementEnd()),2&a&&(t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(2,1,"Phone number is not valid")))}let L=(()=>{class a{constructor(e,n,i,d,w,W,K){this.parentData=e,this.fb=n,this.dialogRef=i,this.formFillingService=d,this.translate=w,this.authService=W,this.coreService=K,this.subs=new v.Y,this.flagsIconPath="../../../../../assets/icons/flags-nationality/",this.countryCodeList=[],this.dialCodeControl=new r.UntypedFormControl(null),this.isWaitingForResponse=!1,this.isOperatorSelected=!1}ngOnInit(){if(this.checkIsOperator(),this.initForm(),console.log("is operator?",this.isOperator),this.parentData?.countryCodeList?.length&&(this.countryCodeList=this.parentData?.countryCodeList),this.parentData&&this.parentData.data&&(this.addOrganizationContactForm.patchValue(this.parentData.data),this.parentData?.data?.phone_number_indicative)){const e=this.countryCodeList?.findIndex(n=>n?.dialCode===this.parentData?.data?.phone_number_indicative);e>=0&&this.dialCodeControl?.patchValue(this.countryCodeList[e])}}initForm(){this.addOrganizationContactForm=this.fb.group({civility:["",[r.Validators.required]],email:["",[_.dN.email]],first_name:["",[r.Validators.required]],last_name:["",[r.Validators.required]],telephone:["",[r.Validators.maxLength(11),_.dN.number]],status:["active"],organization_id:[this.parentData.orgId],phone_number_indicative:[null]})}selectionDialCode(e){this.addOrganizationContactForm?.get("phone_number_indicative")?.reset(),this.addOrganizationContactForm?.get("phone_number_indicative")?.patchValue(e?.dialCode)}checkIsOperator(){this.isOperator=this.authService.getCurrentUser().entities.some(e=>e.entity_name&&"operator"===e.entity_name)}flattenArray(e){return e.reduce((n,i)=>n.concat(i),[])}sortNameAlphabetically(e,n){return e.sort((i,d)=>i[n]>d[n]?1:d[n]>i[n]?-1:0)}cleanObject(e){for(const[n,i]of Object.entries(e))null===i&&delete e[n];return e}checkValidation(){const e=this.addOrganizationContactForm.get("civility").value,n=this.addOrganizationContactForm.get("first_name").value,i=this.addOrganizationContactForm.get("last_name").value;return!!(e&&n&&i)}checkFormValidity(){return!(!this.addOrganizationContactForm.invalid&&this.checkValidation()||(c().fire({type:"warning",title:this.translate.instant("FormSave_S1.TITLE"),html:this.translate.instant("FormSave_S1.TEXT"),confirmButtonText:this.translate.instant("FormSave_S1.BUTTON")}),this.addOrganizationContactForm.markAllAsTouched(),0))}submit(){if(this.checkFormValidity())return;const e=g.cloneDeep(this.addOrganizationContactForm.value);this.isWaitingForResponse=!0,this.subs.sink=this.parentData&&this.parentData.data?this.formFillingService.updateContact(this.parentData.data._id,e).subscribe(n=>{this.isWaitingForResponse=!1,n&&c().fire({type:"success",title:"Bravo!",confirmButtonText:"OK",allowEnterKey:!1,allowEscapeKey:!1,allowOutsideClick:!1}).then(()=>{this.dialogRef.close(n)})},n=>{this.showSwalError(n)}):this.formFillingService.createContact(e).subscribe(n=>{this.isWaitingForResponse=!1,n&&c().fire({type:"success",title:"Bravo!",confirmButtonText:"OK",allowEnterKey:!1,allowEscapeKey:!1,allowOutsideClick:!1}).then(()=>{this.dialogRef.close(n)})},n=>{this.showSwalError(n)})}showSwalError(e){this.isWaitingForResponse=!1,c().fire({type:"info",title:this.translate.instant("SORRY"),text:e&&e.message?this.translate.instant(e.message.replaceAll("GraphQL error: ","")):e,confirmButtonText:this.translate.instant("DISCONNECT_SCHOOL.BUTTON3")})}closeDialog(){this.dialogRef.close()}ngOnDestroy(){this.subs.unsubscribe()}}return a.\u0275fac=function(e){return new(e||a)(t.\u0275\u0275directiveInject(p.WI),t.\u0275\u0275directiveInject(r.UntypedFormBuilder),t.\u0275\u0275directiveInject(p.so),t.\u0275\u0275directiveInject(E.d),t.\u0275\u0275directiveInject(u.sK),t.\u0275\u0275directiveInject(x.e),t.\u0275\u0275directiveInject(P.p))},a.\u0275cmp=t.\u0275\u0275defineComponent({type:a,selectors:[["ms-add-organization-contact"]],decls:66,vars:40,consts:[[1,"dialog-border"],[1,"dialogTitleWrapper","header-dialog","no-padding"],[1,"p-grid"],[1,"p-col-1","no-padding"],[1,"mat-icon-default"],[1,"p-col-10","no-padding"],[1,"dialogTitle"],[1,"p-col-1",2,"padding-right","0px"],["mat-icon-button","","tabindex","-1",1,"close-icon","float-right",3,"click"],["mat-dialog-content","",1,"mat-dialog-content","dialog-body",2,"overflow","hidden !important",3,"formGroup"],[1,"p-col-12","pad-y-none"],["formControlName","civility","required","",2,"color","black"],["value","MR",2,"margin-left","8px"],["value","MRS",2,"margin-left","8px"],[4,"ngIf"],[1,"p-col-6","pad-y-none"],["color","accent",1,"full-wid"],["matInput","","formControlName","first_name","type","text","required","",3,"placeholder"],["matInput","","formControlName","last_name","type","text","required","",3,"placeholder"],["matInput","","formControlName","email","type","email",3,"placeholder"],[1,"no-padding-y","p-grid",2,"position","relative"],[1,"label-for-phone"],[1,"phone-number","p-col-5"],["bindLabel","name",1,"custom-dropdownpanel-dialcode",3,"formControl","clearable","appendTo","change"],["ng-label-tmp",""],[3,"value",4,"ngFor","ngForOf"],[1,"phone-number","p-col-7"],["matInput","","formControlName","telephone","type","text"],["mat-dialog-actions","",1,"justify-content-end","mr-10"],["mat-button","","mat-raised-button","","color","warn",3,"click"],["mat-button","","mat-raised-button","","color","primary",1,"mr-0",3,"click"],["value","neutral",2,"margin-left","8px"],[1,"flag-icon-trigger",3,"src"],["class","ml-4",4,"ngIf"],[1,"ml-4"],[3,"value"],[1,"flag-icon",3,"src"]],template:function(e,n){1&e&&(t.\u0275\u0275elementStart(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"mat-icon",4),t.\u0275\u0275text(5,"add"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(6,"div",5)(7,"h3",6),t.\u0275\u0275text(8),t.\u0275\u0275pipe(9,"translate"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(10,"div",7)(11,"button",8),t.\u0275\u0275listener("click",function(){return n.closeDialog()}),t.\u0275\u0275elementStart(12,"mat-icon"),t.\u0275\u0275text(13,"close"),t.\u0275\u0275elementEnd()()()()()(),t.\u0275\u0275elementStart(14,"div",9)(15,"div",2)(16,"div",10)(17,"mat-radio-group",11)(18,"span"),t.\u0275\u0275text(19),t.\u0275\u0275pipe(20,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(21,"mat-radio-button",12),t.\u0275\u0275text(22),t.\u0275\u0275pipe(23,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(24,"mat-radio-button",13),t.\u0275\u0275text(25),t.\u0275\u0275pipe(26,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(27,y,4,3,"ng-container",14),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementStart(28,"div",2)(29,"div",15)(30,"mat-form-field",16),t.\u0275\u0275element(31,"input",17),t.\u0275\u0275pipe(32,"translate"),t.\u0275\u0275template(33,D,3,3,"mat-error",14),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(34,"div",15)(35,"mat-form-field",16),t.\u0275\u0275element(36,"input",18),t.\u0275\u0275pipe(37,"translate"),t.\u0275\u0275template(38,T,3,3,"mat-error",14),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementStart(39,"div",2)(40,"div",15)(41,"mat-form-field",16),t.\u0275\u0275element(42,"input",19),t.\u0275\u0275pipe(43,"translate"),t.\u0275\u0275template(44,S,3,3,"mat-error",14),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(45,"div",15)(46,"div",2)(47,"div",20)(48,"mat-label",21),t.\u0275\u0275text(49),t.\u0275\u0275pipe(50,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(51,"div",22)(52,"ng-select",23),t.\u0275\u0275listener("change",function(d){return n.selectionDialCode(d)}),t.\u0275\u0275template(53,z,2,2,"ng-template",24),t.\u0275\u0275template(54,F,2,2,"ng-option",25),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(55,"div",26)(56,"mat-form-field"),t.\u0275\u0275element(57,"input",27),t.\u0275\u0275template(58,R,3,3,"mat-error",14),t.\u0275\u0275elementEnd()()()()()()(),t.\u0275\u0275elementStart(59,"div",28)(60,"button",29),t.\u0275\u0275listener("click",function(){return n.closeDialog()}),t.\u0275\u0275text(61),t.\u0275\u0275pipe(62,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(63,"button",30),t.\u0275\u0275listener("click",function(){return n.submit()}),t.\u0275\u0275text(64),t.\u0275\u0275pipe(65,"translate"),t.\u0275\u0275elementEnd()()),2&e&&(t.\u0275\u0275advance(8),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(9,20,"Add Contact")),t.\u0275\u0275advance(6),t.\u0275\u0275property("formGroup",n.addOrganizationContactForm),t.\u0275\u0275advance(5),t.\u0275\u0275textInterpolate1("",t.\u0275\u0275pipeBind1(20,22,"Civility")," *"),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(23,24,"MR")),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(26,26,"MRS")),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",null==n.coreService?null:n.coreService.neutralCivility),t.\u0275\u0275advance(4),t.\u0275\u0275propertyInterpolate("placeholder",t.\u0275\u0275pipeBind1(32,28,"First Name")),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",n.addOrganizationContactForm.get("first_name").hasError("required")),t.\u0275\u0275advance(3),t.\u0275\u0275propertyInterpolate("placeholder",t.\u0275\u0275pipeBind1(37,30,"Last Name")),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",n.addOrganizationContactForm.get("last_name").hasError("required")),t.\u0275\u0275advance(4),t.\u0275\u0275propertyInterpolate("placeholder",t.\u0275\u0275pipeBind1(43,32,"email")),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",n.addOrganizationContactForm.get("email").hasError("email")),t.\u0275\u0275advance(5),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(50,34,"CARDDETAIL.Phone")),t.\u0275\u0275advance(3),t.\u0275\u0275property("formControl",n.dialCodeControl)("clearable",!1)("appendTo","body"),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngForOf",n.countryCodeList),t.\u0275\u0275advance(4),t.\u0275\u0275property("ngIf",n.addOrganizationContactForm.get("telephone").hasError("number")),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(62,36,"CANCEL")),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(65,38,"Submit")," "))},dependencies:[M.lW,p.xY,p.H8,b.Hw,s.TO,s.KE,s.hX,I.Nt,h.VQ,h.U0,r.DefaultValueAccessor,r.NgControlStatus,r.NgControlStatusGroup,r.RequiredValidator,r.FormControlDirective,r.FormGroupDirective,r.FormControlName,f.sg,f.O5,m.w9,m.jq,m.mR,u.X$],styles:[".dialogTitle[_ngcontent-%COMP%]{display:inline-block}.dialogTitleWrapper[_ngcontent-%COMP%]{color:#000}.dialog-border[_ngcontent-%COMP%]{border-bottom:1px solid black}.no-padding[_ngcontent-%COMP%]{padding:0}.float-right[_ngcontent-%COMP%]{float:right}.mt-15[_ngcontent-%COMP%]{margin-top:15px}[_nghost-%COMP%]  .mat-radio-outer-circle{border-color:#0000008a!important}[_nghost-%COMP%]  .mat-form-field-underline{background-color:#0000001f!important}.mr-0[_ngcontent-%COMP%]{margin-right:0}.mr-10[_ngcontent-%COMP%]{margin-right:10px}.header-dialog[_ngcontent-%COMP%]{margin-top:15px;padding:0 5px 0 15px}.mat-dialog-content[_ngcontent-%COMP%]{margin-right:0;margin-left:0;margin-top:15px;padding:0}.w-30[_ngcontent-%COMP%]{width:30px}.w-65[_ngcontent-%COMP%]{width:65px}.mt-5px[_ngcontent-%COMP%]{margin-top:5px}[_nghost-%COMP%]  .ng-select .ng-select-container{background-color:#fff0;color:#000;border:none;border-radius:0!important;border-bottom:1px solid #8c8c8c!important;min-height:36px;align-items:center}[_nghost-%COMP%]  .ng-select .ng-select-container .ng-value-container .ng-input>input{color:#000;box-sizing:content-box;background:none;border:0;box-shadow:none;outline:0;cursor:default;width:100%}  .ng-dropdown-panel.ng-select-bottom{width:auto!important}.mat-icon-default[_ngcontent-%COMP%]{font-size:30px!important;margin-top:0!important;width:auto!important;padding-right:5px}.flag-icon[_ngcontent-%COMP%]{vertical-align:text-top;margin-right:12px;height:14px;width:20px;display:inline-block}.flag-icon-trigger[_ngcontent-%COMP%]{vertical-align:text-top;margin-right:2px;height:16px;width:16px;display:inline-block}.border-button[_ngcontent-%COMP%]{border-bottom:1px solid #dadada}.phone-number.p-col-5[_ngcontent-%COMP%], .phone-number.p-col-7[_ngcontent-%COMP%]{padding:0!important}.phone-number.p-col-5[_ngcontent-%COMP%]{padding-right:0!important}.phone-number.p-col-7[_ngcontent-%COMP%]{padding-left:12px!important}.label-for-phone[_ngcontent-%COMP%]{position:absolute;font-size:11px;color:#aaa;opacity:.8;bottom:42px}.ml-4[_ngcontent-%COMP%]{margin-left:4px}[_nghost-%COMP%]  .ng-select .ng-select-container{background-color:#fff0;color:#000;border:none;border-radius:0!important;border-bottom:1px solid rgb(220,220,220)!important;box-shadow:unset;min-height:36px;align-items:center}[_nghost-%COMP%]  .ng-select .ng-dropdown-panel{min-width:-moz-fit-content!important;min-width:fit-content!important;width:-moz-fit-content!important;width:fit-content!important}[_nghost-%COMP%]  .ng-select.ng-invalid.ng-touched .ng-select-container{border-bottom:1px solid #f44336!important}[_nghost-%COMP%]  .ng-select.ng-invalid.ng-touched .ng-placeholder{color:#f44336!important}[_nghost-%COMP%]  .ng-select{margin-bottom:16px;padding-top:3px}[_nghost-%COMP%]  .ng-select .ng-select-container .ng-value-container .ng-input>input{color:#000;box-sizing:content-box;background:none;border:0;box-shadow:none;outline:0;cursor:default;padding-left:0!important;width:100%}[_nghost-%COMP%]  .ng-select.ng-select-single .ng-select-container .ng-value-container .ng-input{padding-left:0!important;margin-top:6px!important}[_nghost-%COMP%]  .ng-select .ng-select-container .ng-value-container{padding-left:0!important;margin-top:8px!important}[_nghost-%COMP%]  .ng-select.ng-select-single .ng-select-container .ng-value-container, .ng-select.ng-select-single[_ngcontent-%COMP%]   .ng-select-container[_ngcontent-%COMP%]   .ng-value-container[_ngcontent-%COMP%]   .ng-value[_ngcontent-%COMP%]{font-size:14px!important}[_nghost-%COMP%]  .ng-select .ng-dropdown-panel{text-align:left!important;font-size:15px!important}[_nghost-%COMP%]  .ng-select.ng-select-single .ng-select-container .ng-value-container .ng-placeholder{font-size:16px}  .ng-dropdown-panel.custom-dropdownpanel-dialcode{width:-moz-fit-content!important;width:fit-content!important}"]}),a})()}}]);